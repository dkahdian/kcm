import{a as gt,r as Lt,b as It,P as Ct,T as jt,Q as Mt,e as le,i as de,c as lt,s as Ve,d as Ot,f as tt,g as Nt,h as ht,j as Ft,k as wt,l as _t,m as zt}from"../chunks/d-wzXGpM.js";import"../chunks/DsnmJJEf.js";import{d as We,s as R,o as Bt,e as Pt}from"../chunks/Cx79O9jG.js";import{b0 as qt,aY as Ut,u as Qt,r as Kt,h as Vt,o as ut,b1 as Xt,T as Ze,a2 as O,C as Ne,aa as Xe,z as e,D as a,a4 as at,a5 as He,Y as _,Z as $e,V as p,a0 as i,a3 as r,ar as ft,_ as o,b2 as ct,X as F,a_ as q,b3 as Et,W as Jt,$ as Yt}from"../chunks/pwzhV1cr.js";import{p as je,i as K}from"../chunks/-bFWoB2C.js";import{r as Ge,s as Qe}from"../chunks/BdkZzXO5.js";function Be(d,t,u=t){var v=new WeakSet;qt(d,"input",async g=>{var s=g?d.defaultValue:d.value;if(s=xt(d)?mt(s):s,u(s),ut!==null&&v.add(ut),await Ut(),s!==(s=t())){var b=d.selectionStart,k=d.selectionEnd;d.value=s??"",k!==null&&(d.selectionStart=b,d.selectionEnd=Math.min(k,d.value.length))}}),(Vt&&d.defaultValue!==d.value||Qt(t)==null&&d.value)&&(u(xt(d)?mt(d.value):d.value),ut!==null&&v.add(ut)),Kt(()=>{var g=t();if(d===document.activeElement){var s=Xt??ut;if(v.has(s))return}xt(d)&&g===mt(d.value)||d.type==="date"&&!g&&!d.value||g!==d.value&&(d.value=g??"")})}function xt(d){var t=d.type;return t==="number"||t==="range"}function mt(d){return d===""?null:+d}const Gt=()=>{const d=gt.map(s=>s.id),t=new Map;for(const s of gt)if(s.references)for(const b of s.references)t.has(b.id)||t.set(b.id,b.title);const u=Array.from(t.entries()).map(([s,b])=>({id:s,title:b})),v=new Map;for(const s of gt)if(s.tags)for(const b of s.tags)v.has(b.id)||v.set(b.id,{id:b.id,label:b.label,color:b.color});const g=Array.from(v.values());return{existingLanguageIds:d,existingReferences:u,existingTags:g,languages:gt,queries:Mt,transformations:jt,polytimeOptions:Ct,adjacencyMatrix:It,relationTypes:Lt}},Ht=!1,Ir=Object.freeze(Object.defineProperty({__proto__:null,load:Gt,prerender:Ht},Symbol.toStringTag,{value:"Module"}));async function Wt(d,t,u,v,g,s,b,k,P,N,A,x,S){if(!e(t).trim()||!e(u).trim()||!e(v).trim()||!e(g).trim()){a(s,"Please fill out all required fields.");return}try{const j=await b.onAdd({id:e(t).trim(),name:e(u).trim(),fullName:e(v).trim(),description:e(g).trim(),descriptionRefs:e(k),queries:e(P),transformations:e(N),tags:e(A),existingReferences:e(x)}),M=j&&typeof j=="object"&&"success"in j?j:void 0;if(M&&!M.success){a(s,M.error??"Unable to add language. Please review your input.",!0);return}a(s,null),S(),b.onClose?.()}catch(j){a(s,j instanceof Error?j.message:"Unexpected error while adding the language.",!0)}}function kt(d,t,u){t(),u.onClose()}var Zt=d=>d.stopPropagation(),$t=p('<div class="p-3 bg-red-50 border border-red-200 rounded-lg text-sm text-red-700"> </div>'),ea=p('<p class="text-xs text-gray-500 mt-1">ID will be: <code class="bg-gray-100 px-1 rounded"> </code></p>'),ta=(d,t,u)=>t(e(u)),aa=p('<button type="button"> </button>'),ra=p('<fieldset><legend class="block text-sm font-medium text-gray-700 mb-2">Description References</legend> <div class="flex flex-wrap gap-2"></div></fieldset>'),ia=p("<option> </option>"),na=(d,t,u,v)=>t(e(u).code,e(v)),oa=p('<button type="button"> </button>'),la=p('<div class="mt-2 flex flex-wrap gap-1"></div>'),da=p('<div class="p-3 bg-gray-50 rounded-lg border border-gray-200"><div class="grid grid-cols-1 md:grid-cols-2 gap-3"><div><label class="block text-xs font-medium text-gray-700 mb-1"> </label> <select class="w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-green-500"></select></div> <div><label class="block text-xs font-medium text-gray-700 mb-1">Note</label> <input type="text" placeholder="Optional note..." class="w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-green-500"/></div></div> <!></div>'),sa=p("<option> </option>"),ua=(d,t,u,v)=>t(e(u).code,e(v)),ca=p('<button type="button"> </button>'),va=p('<div class="mt-2 flex flex-wrap gap-1"></div>'),ga=p('<div class="p-3 bg-gray-50 rounded-lg border border-gray-200"><div class="grid grid-cols-1 md:grid-cols-2 gap-3"><div><label class="block text-xs font-medium text-gray-700 mb-1"> </label> <select class="w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-green-500"></select></div> <div><label class="block text-xs font-medium text-gray-700 mb-1">Note</label> <input type="text" placeholder="Optional note..." class="w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-green-500"/></div></div> <!></div>'),fa=(d,t,u)=>t(e(u)),ba=p('<button type="button"> </button>'),_a=p('<div class="space-y-4 border-t pt-6"><h3 class="text-lg font-bold text-gray-900">Tags</h3> <div class="flex flex-wrap gap-2"></div></div>'),xa=p(`<div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"><div class="bg-white rounded-xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto"><div class="bg-gradient-to-r from-green-600 to-green-700 px-6 py-4 sticky top-0 z-10"><h2 class="text-2xl font-bold text-white"> </h2> <p class="text-green-100 mt-1">Define a knowledge compilation language</p></div> <div class="p-6 space-y-6"><!> <div class="space-y-4"><h3 class="text-lg font-bold text-gray-900">Basic Information</h3> <div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div><label for="lang-name" class="block text-sm font-medium text-gray-700 mb-1">Short Name <span class="text-red-500">*</span></label> <input type="text" id="lang-name" placeholder="e.g., 'OBDD', 'd-DNNF'" class="w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"/> <!></div> <div><label for="lang-fullname" class="block text-sm font-medium text-gray-700 mb-1">Full Name <span class="text-red-500">*</span></label> <input type="text" id="lang-fullname" placeholder="e.g., 'Ordered Binary Decision Diagrams'" class="w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"/></div></div> <div><label for="lang-description" class="block text-sm font-medium text-gray-700 mb-1">Description <span class="text-red-500">*</span></label> <textarea id="lang-description" placeholder="Brief description of this language..." rows="3" class="w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"></textarea></div> <!></div> <div class="space-y-4 border-t pt-6"><h3 class="text-lg font-bold text-gray-900">Query Support</h3> <div class="space-y-3"></div></div> <div class="space-y-4 border-t pt-6"><h3 class="text-lg font-bold text-gray-900">Transformation Support</h3> <div class="space-y-3"></div></div> <!> <div class="flex gap-3 justify-end pt-6 border-t sticky bottom-0 bg-white"><button type="button" class="px-4 py-2 border-2 border-gray-300 text-gray-700 font-medium rounded-lg hover:bg-gray-50 transition-colors">Cancel</button> <button type="button" class="px-4 py-2 bg-green-600 text-white font-medium rounded-lg hover:bg-green-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors"> </button></div></div></div></div>`);function Rt(d,t){Ze(t,!0);let u=je(t,"isOpen",11,!1),v=je(t,"availableRefs",19,()=>[]),g=je(t,"isEdit",3,!1),s=O(""),b=O(""),k=O(""),P=O(""),N=O(Ne([])),A=O(Ne({})),x=O(Ne({})),S=O(Ne([])),j=O(Ne([])),M=O(null);Xe(()=>{!g()&&e(b)&&a(s,e(b).toLowerCase().replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,""),!0)}),Xe(()=>{g()&&t.initialData&&(a(s,t.initialData.id,!0),a(b,t.initialData.name,!0),a(k,t.initialData.fullName,!0),a(P,t.initialData.description,!0),a(N,[...t.initialData.descriptionRefs],!0),a(A,{...t.initialData.queries},!0),a(x,{...t.initialData.transformations},!0),a(S,[...t.initialData.tags],!0),a(j,[...t.initialData.existingReferences],!0),a(M,null))});function $(){a(s,""),a(b,""),a(k,""),a(P,""),a(N,[],!0),a(A,{},!0),a(x,{},!0),a(S,[],!0),a(j,[],!0),a(he,!1),a(se,!1),a(M,null)}function Ae(E){e(N).includes(E)?a(N,e(N).filter(h=>h!==E),!0):a(N,[...e(N),E],!0)}function T(E){e(S).some(h=>h.id===E.id)?a(S,e(S).filter(h=>h.id!==E.id),!0):a(S,[...e(S),E],!0)}function y(E,h){if(!e(A)[E])return;const I=e(A)[E].refs;I.includes(h)?e(A)[E].refs=I.filter(G=>G!==h):e(A)[E].refs=[...I,h],a(A,{...e(A)},!0)}function w(E,h){if(!e(x)[E])return;const I=e(x)[E].refs;I.includes(h)?e(x)[E].refs=I.filter(G=>G!==h):e(x)[E].refs=[...I,h],a(x,{...e(x)},!0)}let he=O(!1),se=O(!1);Xe(()=>{if(t.queries.length>0&&!e(he)){const E={};t.queries.forEach(h=>{if(g()&&t.initialData&&t.initialData.queries[h.code]){const I=t.initialData.queries[h.code];E[h.code]={polytime:I.polytime,note:I.note||"",refs:[...I.refs]}}else E[h.code]={polytime:"unknown",note:"",refs:[]}}),a(A,E,!0),a(he,!0)}}),Xe(()=>{if(t.transformations.length>0&&!e(se)){const E={};t.transformations.forEach(h=>{if(g()&&t.initialData){let I=t.initialData.transformations[h.code];if(!I){const G=Object.keys(t.initialData.transformations).find(ie=>t.initialData.transformations[ie]!==void 0&&(ie===h.code||h.code==="âˆ§C"&&ie==="AND_C"||h.code==="âˆ§BC"&&ie==="AND_BC"||h.code==="âˆ¨C"&&ie==="OR_C"||h.code==="âˆ¨BC"&&ie==="OR_BC"||h.code==="Â¬C"&&ie==="NOT_C"));G&&(I=t.initialData.transformations[G])}E[h.code]=I?{polytime:I.polytime,note:I.note||"",refs:[...I.refs]}:{polytime:"unknown",note:"",refs:[]}}else E[h.code]={polytime:"unknown",note:"",refs:[]}}),a(x,E,!0),a(se,!0)}});var _e=at(),ge=He(_e);{var we=E=>{var h=xa();h.__click=[kt,$,t];var I=i(h);I.__click=[Zt];var G=i(I),ie=i(G),ue=i(ie);r(ie),ft(2),r(G);var V=o(G,2),H=i(V);{var ne=D=>{var m=$t(),X=i(m,!0);r(m),F(()=>R(X,e(M))),_(D,m)};K(H,D=>{e(M)&&D(ne)})}var xe=o(H,2),Te=o(i(xe),2),z=i(Te),U=o(i(z),2);Ge(U);var Pe=o(U,2);{var oe=D=>{var m=ea(),X=o(i(m)),Ie=i(X,!0);r(X),r(m),F(()=>R(Ie,e(s))),_(D,m)};K(Pe,D=>{e(s)&&!g()&&D(oe)})}r(z);var ee=o(z,2),te=o(i(ee),2);Ge(te),r(ee),r(Te);var Se=o(Te,2),me=o(i(Se),2);ct(me),r(Se);var fe=o(Se,2);{var ce=D=>{var m=ra(),X=o(i(m),2);le(X,21,v,de,(Ie,ae)=>{var re=aa();re.__click=[ta,Ae,ae];var Ce=i(re,!0);r(re),F(pe=>{Ve(re,1,pe),R(Ce,e(ae))},[()=>`px-3 py-1 text-sm rounded-lg border-2 transition-colors ${e(N).includes(e(ae))?"bg-green-600 text-white border-green-600":"bg-white text-gray-700 border-gray-300 hover:border-green-300"}`]),_(Ie,re)}),r(X),r(m),_(D,m)};K(fe,D=>{v().length>0&&D(ce)})}r(xe);var Oe=o(xe,2),Le=o(i(Oe),2);le(Le,21,()=>t.queries,de,(D,m)=>{var X=at(),Ie=He(X);{var ae=re=>{var Ce=da(),pe=i(Ce),Fe=i(pe),ze=i(Fe),rt=i(ze,!0);r(ze);var qe=o(ze,2);le(qe,21,()=>t.polytimeOptions,de,(ve,Ee)=>{var ke=ia(),Me=i(ke,!0);r(ke);var ye={};F(()=>{R(Me,e(Ee).label),ye!==(ye=e(Ee).value)&&(ke.value=(ke.__value=e(Ee).value)??"")}),_(ve,ke)}),r(qe),r(Fe);var Je=o(Fe,2),Ye=i(Je),Ke=o(Ye,2);Ge(Ke),r(Je),r(pe);var it=o(pe,2);{var nt=ve=>{var Ee=la();le(Ee,21,v,de,(ke,Me)=>{var ye=oa();ye.__click=[na,y,m,Me];var ot=i(ye,!0);r(ye),F(dt=>{Ve(ye,1,dt),R(ot,e(Me))},[()=>`px-2 py-0.5 text-xs rounded ${e(A)[e(m).code].refs.includes(e(Me))?"bg-green-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`]),_(ke,ye)}),r(Ee),_(ve,Ee)};K(it,ve=>{v().length>0&&ve(nt)})}r(Ce),F(()=>{Qe(ze,"for",`query-${e(m).code??""}-polytime`),R(rt,e(m).name),Qe(qe,"id",`query-${e(m).code??""}-polytime`),Qe(Ye,"for",`query-${e(m).code??""}-note`),Qe(Ke,"id",`query-${e(m).code??""}-note`)}),lt(qe,()=>e(A)[e(m).code].polytime,ve=>e(A)[e(m).code].polytime=ve),Be(Ke,()=>e(A)[e(m).code].note,ve=>e(A)[e(m).code].note=ve),_(re,Ce)};K(Ie,re=>{e(A)[e(m).code]&&re(ae)})}_(D,X)}),r(Le),r(Oe);var be=o(Oe,2),L=o(i(be),2);le(L,21,()=>t.transformations,de,(D,m)=>{var X=at(),Ie=He(X);{var ae=re=>{var Ce=ga(),pe=i(Ce),Fe=i(pe),ze=i(Fe),rt=i(ze,!0);r(ze);var qe=o(ze,2);le(qe,21,()=>t.polytimeOptions,de,(ve,Ee)=>{var ke=sa(),Me=i(ke,!0);r(ke);var ye={};F(()=>{R(Me,e(Ee).label),ye!==(ye=e(Ee).value)&&(ke.value=(ke.__value=e(Ee).value)??"")}),_(ve,ke)}),r(qe),r(Fe);var Je=o(Fe,2),Ye=i(Je),Ke=o(Ye,2);Ge(Ke),r(Je),r(pe);var it=o(pe,2);{var nt=ve=>{var Ee=va();le(Ee,21,v,de,(ke,Me)=>{var ye=ca();ye.__click=[ua,w,m,Me];var ot=i(ye,!0);r(ye),F(dt=>{Ve(ye,1,dt),R(ot,e(Me))},[()=>`px-2 py-0.5 text-xs rounded ${e(x)[e(m).code].refs.includes(e(Me))?"bg-green-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`]),_(ke,ye)}),r(Ee),_(ve,Ee)};K(it,ve=>{v().length>0&&ve(nt)})}r(Ce),F(()=>{Qe(ze,"for",`transform-${e(m).code??""}-polytime`),R(rt,e(m).name),Qe(qe,"id",`transform-${e(m).code??""}-polytime`),Qe(Ye,"for",`transform-${e(m).code??""}-note`),Qe(Ke,"id",`transform-${e(m).code??""}-note`)}),lt(qe,()=>e(x)[e(m).code].polytime,ve=>e(x)[e(m).code].polytime=ve),Be(Ke,()=>e(x)[e(m).code].note,ve=>e(x)[e(m).code].note=ve),_(re,Ce)};K(Ie,re=>{e(x)[e(m).code]&&re(ae)})}_(D,X)}),r(L),r(be);var C=o(be,2);{var B=D=>{var m=_a(),X=o(i(m),2);le(X,21,()=>t.existingTags,de,(Ie,ae)=>{var re=ba();re.__click=[fa,T,ae];var Ce=i(re,!0);r(re),F((pe,Fe)=>{Ve(re,1,pe),Ot(re,`background-color: ${e(ae).color??""}; color: white; ${Fe??""}`),R(Ce,e(ae).label)},[()=>`px-3 py-1 rounded-full text-sm font-medium transition-all ${e(S).some(pe=>pe.id===e(ae).id)?"ring-2 ring-offset-2":"opacity-60 hover:opacity-100"}`,()=>e(S).some(pe=>pe.id===e(ae).id)?`ring-color: ${e(ae).color};`:""]),_(Ie,re)}),r(X),r(m),_(D,m)};K(C,D=>{t.existingTags.length>0&&D(B)})}var Q=o(C,2),W=i(Q);W.__click=[kt,$,t];var Y=o(W,2);Y.__click=[Wt,s,b,k,P,M,t,N,A,x,S,j,$];var De=i(Y);r(Y),r(Q),r(V),r(I),r(h),F(D=>{R(ue,`${g()?"Edit":"Add New"} Language`),Y.disabled=D,R(De,`${g()?"Update":"Add"} Language`)},[()=>!e(s).trim()||!e(b).trim()||!e(k).trim()||!e(P).trim()]),Be(U,()=>e(b),D=>a(b,D)),Be(te,()=>e(k),D=>a(k,D)),Be(me,()=>e(P),D=>a(P,D)),_(E,h)};K(ge,E=>{u()&&E(we)})}_(d,_e),$e()}We(["click"]);function ma(d,t,u,v){e(t).trim()&&(u.onAdd(e(t).trim()),a(t,""),v(!1))}function Tt(d,t,u,v){t()||a(u,""),v.onClose()}var pa=d=>d.stopPropagation(),ya=p('<div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"><div class="bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto"><div class="bg-gradient-to-r from-purple-600 to-purple-700 px-6 py-4"><h2 class="text-2xl font-bold text-white"> </h2> <p class="text-purple-100 mt-1"> </p></div> <div class="p-6 space-y-4"><div><label for="bibtex-input" class="block text-sm font-medium text-gray-700 mb-2">BibTeX Entry <span class="text-red-500">*</span></label> <textarea id="bibtex-input" rows="8" class="w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 font-mono text-sm"></textarea> <p class="text-xs text-gray-500 mt-1">Paste a complete BibTeX entry.</p></div> <div class="flex gap-3 justify-end pt-4"><button type="button" class="px-4 py-2 border-2 border-gray-300 text-gray-700 font-medium rounded-lg hover:bg-gray-50 transition-colors">Cancel</button> <button type="button" class="px-4 py-2 bg-purple-600 text-white font-medium rounded-lg hover:bg-purple-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors"> </button></div></div></div></div>');function ha(d,t){Ze(t,!0);let u=je(t,"isOpen",15,!1),v=je(t,"initialValue",3,""),g=je(t,"isEditMode",3,!1),s=O(Ne(v()));Xe(()=>{u()&&v()&&a(s,v())});const b=`@article{Darwiche_2002,
  title={A Knowledge Compilation Map},
  author={Darwiche, Adnan and Marquis, Pierre},
  journal={Journal of AI Research},
  year={2002}
}`;var k=at(),P=He(k);{var N=A=>{var x=ya();x.__click=[Tt,g,s,t];var S=i(x);S.__click=[pa];var j=i(S),M=i(j),$=i(M,!0);r(M);var Ae=o(M,2),T=i(Ae,!0);r(Ae),r(j);var y=o(j,2),w=i(y),he=o(i(w),2);ct(he),Qe(he,"placeholder",b),ft(2),r(w);var se=o(w,2),_e=i(se);_e.__click=[Tt,g,s,t];var ge=o(_e,2);ge.__click=[ma,s,t,u];var we=i(ge,!0);r(ge),r(se),r(y),r(S),r(x),F(E=>{R($,g()?"Edit Reference":"Add New Reference"),R(T,g()?"Update BibTeX citation":"Paste BibTeX citation"),ge.disabled=E,R(we,g()?"Update Reference":"Add Reference")},[()=>!e(s).trim()]),Be(he,()=>e(s),E=>a(s,E)),_(A,x)};K(P,A=>{u()&&A(N)})}_(d,k),$e()}We(["click"]);function wa(d,t,u,v,g,s,b,k,P,N){!e(t)||!e(u)||!e(v)||e(t)===e(u)||(g.onSave({sourceId:e(t),targetId:e(u),status:e(v),description:e(s)||void 0,refs:e(b),separatingFunctions:e(k).length>0?e(k):void 0}),P(),N(!1))}function Dt(d,t,u){t(),u.onClose()}function Ea(d,t){a(t,[...e(t),{shortName:"",name:"",description:"",refs:[]}],!0)}var ka=d=>d.stopPropagation(),Ra=p("<option> </option>"),Ta=p("<option> </option>"),Da=p("<option> </option>"),Aa=p('<p class="text-xs text-gray-500 mt-1"> </p>'),Oa=(d,t,u)=>t(e(u)),Sa=p('<button type="button"> </button>'),La=p('<fieldset><legend class="block text-sm font-medium text-gray-700 mb-2">References</legend> <div class="flex flex-wrap gap-2"></div></fieldset>'),Ia=p(`<div class="p-3 bg-gray-50 rounded-lg border border-gray-200 space-y-2"><div class="flex items-start justify-between gap-2"><input type="text" placeholder="Short name (e.g., 'Clique')" class="flex-1 px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"/> <button type="button" class="text-red-600 hover:text-red-800 font-bold">Ã—</button></div> <input type="text" placeholder="Full name (e.g., 'Clique Detection Instances')" class="w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"/> <textarea placeholder="Description..." rows="2" class="w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></textarea></div>`),Ca=p('<div class="space-y-3"></div>'),ja=p('<p class="text-sm text-gray-500 italic">No separating functions added yet.</p>'),Ma=p('<div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"><div class="bg-white rounded-xl shadow-2xl max-w-3xl w-full max-h-[90vh] overflow-y-auto"><div class="bg-gradient-to-r from-blue-600 to-blue-700 px-6 py-4 sticky top-0 z-10"><h2 class="text-2xl font-bold text-white">Manage Relationship</h2> <p class="text-blue-100 mt-1">Add or update transformation relationships</p></div> <div class="p-6 space-y-4"><div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div><label for="rel-source" class="block text-sm font-medium text-gray-700 mb-1">Source Language <span class="text-red-500">*</span></label> <select id="rel-source" class="w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"><option>Select source...</option><!></select></div> <div><label for="rel-target" class="block text-sm font-medium text-gray-700 mb-1">Target Language <span class="text-red-500">*</span></label> <select id="rel-target" class="w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"><option>Select target...</option><!></select></div></div> <div><label for="rel-status" class="block text-sm font-medium text-gray-700 mb-1">Classification <span class="text-red-500">*</span></label> <select id="rel-status" class="w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"><option>Select classification...</option><!></select> <!></div> <div><label for="rel-description" class="block text-sm font-medium text-gray-700 mb-1">Description</label> <textarea id="rel-description" rows="3" class="w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-y" placeholder="Describe this transformation relationship (optional)..."></textarea></div> <!> <fieldset class="border-t pt-4"><div class="flex items-center justify-between mb-3"><legend class="block text-sm font-medium text-gray-700">Separating Functions (optional)</legend> <button type="button" class="text-sm text-blue-600 hover:text-blue-700 font-medium">+ Add Function</button></div> <!></fieldset> <div class="flex gap-3 justify-end pt-4 border-t"><button type="button" class="px-4 py-2 border-2 border-gray-300 text-gray-700 font-medium rounded-lg hover:bg-gray-50 transition-colors">Cancel</button> <button type="button" class="px-4 py-2 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors">Save Relationship</button></div></div></div></div>');function Na(d,t){Ze(t,!0);let u=je(t,"isOpen",15,!1),v=je(t,"availableRefs",19,()=>[]),g=je(t,"baselineRelations",19,()=>new Map),s=O(""),b=O(""),k=O(""),P=O(""),N=O(Ne([])),A=O(Ne([]));Xe(()=>{u()&&t.initialData&&(a(s,t.initialData.sourceId,!0),a(b,t.initialData.targetId,!0),a(k,t.initialData.status,!0),a(P,t.initialData.description||"",!0),a(N,[...t.initialData.refs],!0),a(A,t.initialData.separatingFunctions?t.initialData.separatingFunctions.map(T=>({...T})):[],!0))}),Xe(()=>{if(e(s)&&e(b)&&e(s)!==e(b)){const T=`${e(s)}->${e(b)}`,y=g().get(T);y&&(a(k,y.status,!0),a(N,[...y.refs],!0),a(A,y.separatingFunctions.map(w=>({...w})),!0))}});function x(){a(s,""),a(b,""),a(k,""),a(P,""),a(N,[],!0),a(A,[],!0)}function S(T){e(N).includes(T)?a(N,e(N).filter(y=>y!==T),!0):a(N,[...e(N),T],!0)}function j(T){a(A,e(A).filter((y,w)=>w!==T),!0)}var M=at(),$=He(M);{var Ae=T=>{var y=Ma();y.__click=[Dt,x,t];var w=i(y);w.__click=[ka];var he=o(i(w),2),se=i(he),_e=i(se),ge=o(i(_e),2),we=i(ge);we.value=we.__value="";var E=o(we);le(E,17,()=>t.languages,de,(L,C)=>{var B=Ra(),Q=i(B);r(B);var W={};F(()=>{R(Q,`${e(C).name??""} (${e(C).id??""})`),W!==(W=e(C).id)&&(B.value=(B.__value=e(C).id)??"")}),_(L,B)}),r(ge),r(_e);var h=o(_e,2),I=o(i(h),2),G=i(I);G.value=G.__value="";var ie=o(G);le(ie,17,()=>t.languages,de,(L,C)=>{var B=Ta(),Q=i(B);r(B);var W={};F(()=>{B.disabled=e(C).id===e(s),R(Q,`${e(C).name??""} (${e(C).id??""})`),W!==(W=e(C).id)&&(B.value=(B.__value=e(C).id)??"")}),_(L,B)}),r(I),r(h),r(se);var ue=o(se,2),V=o(i(ue),2),H=i(V);H.value=H.__value="";var ne=o(H);le(ne,17,()=>t.statusOptions,de,(L,C)=>{var B=Da(),Q=i(B,!0);r(B);var W={};F(()=>{R(Q,e(C).label),W!==(W=e(C).value)&&(B.value=(B.__value=e(C).value)??"")}),_(L,B)}),r(V);var xe=o(V,2);{var Te=L=>{const C=q(()=>t.statusOptions.find(Y=>Y.value===e(k)));var B=at(),Q=He(B);{var W=Y=>{var De=Aa(),D=i(De,!0);r(De),F(()=>R(D,e(C).description)),_(Y,De)};K(Q,Y=>{e(C)&&Y(W)})}_(L,B)};K(xe,L=>{e(k)&&L(Te)})}r(ue);var z=o(ue,2),U=o(i(z),2);ct(U),r(z);var Pe=o(z,2);{var oe=L=>{var C=La(),B=o(i(C),2);le(B,21,v,de,(Q,W)=>{var Y=Sa();Y.__click=[Oa,S,W];var De=i(Y,!0);r(Y),F(D=>{Ve(Y,1,D),R(De,e(W))},[()=>`px-3 py-1 text-sm rounded-lg border-2 transition-colors ${e(N).includes(e(W))?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-300 hover:border-blue-300"}`]),_(Q,Y)}),r(B),r(C),_(L,C)};K(Pe,L=>{v().length>0&&L(oe)})}var ee=o(Pe,2),te=i(ee),Se=o(i(te),2);Se.__click=[Ea,A],r(te);var me=o(te,2);{var fe=L=>{var C=Ca();le(C,21,()=>e(A),de,(B,Q,W)=>{var Y=Ia(),De=i(Y),D=i(De);Ge(D);var m=o(D,2);m.__click=()=>j(W),r(De);var X=o(De,2);Ge(X);var Ie=o(X,2);ct(Ie),r(Y),Be(D,()=>e(Q).shortName,ae=>e(Q).shortName=ae),Be(X,()=>e(Q).name,ae=>e(Q).name=ae),Be(Ie,()=>e(Q).description,ae=>e(Q).description=ae),_(B,Y)}),r(C),_(L,C)},ce=L=>{var C=ja();_(L,C)};K(me,L=>{e(A).length>0?L(fe):L(ce,!1)})}r(ee);var Oe=o(ee,2),Le=i(Oe);Le.__click=[Dt,x,t];var be=o(Le,2);be.__click=[wa,s,b,k,t,P,N,A,x,u],r(Oe),r(he),r(w),r(y),F(()=>be.disabled=!e(s)||!e(b)||!e(k)||e(s)===e(b)),lt(ge,()=>e(s),L=>a(s,L)),lt(I,()=>e(b),L=>a(b,L)),lt(V,()=>e(k),L=>a(k,L)),Be(U,()=>e(P),L=>a(P,L)),_(T,y)};K($,T=>{u()&&T(Ae)})}_(d,M),$e()}We(["click"]);var Fa=(d,t)=>t.onToggleExpand(t.index),za=(d,t)=>t.onEdit(t.index),Ba=(d,t)=>t.onDelete(t.index),Pa=p('<div class="text-gray-500 italic"> </div>'),qa=p('<div class="bg-white p-2 rounded border"><div class="font-medium"> </div> <div class="text-gray-600"> </div> <!></div>'),Ua=p('<div><div class="font-semibold text-gray-700 mb-1"> </div> <div class="grid grid-cols-2 gap-2"></div></div>'),Qa=p('<div class="text-gray-500 italic"> </div>'),Ka=p('<div class="bg-white p-2 rounded border"><div class="font-medium"> </div> <div class="text-gray-600"> </div> <!></div>'),Va=p('<div><div class="font-semibold text-gray-700 mb-1"> </div> <div class="grid grid-cols-2 gap-2"></div></div>'),Xa=p('<span class="px-2 py-1 rounded text-white text-xs"> </span>'),Ja=p('<div><div class="font-semibold text-gray-700 mb-1">Tags:</div> <div class="flex flex-wrap gap-1"></div></div>'),Ya=p('<div><div><div class="font-semibold text-gray-700 mb-1">Full Name:</div> <div class="text-gray-900"> </div></div> <div><div class="font-semibold text-gray-700 mb-1">Description:</div> <div class="text-gray-900"> </div></div> <!> <!> <!></div>'),Ga=p('<div><div class="flex items-center justify-between"><div class="flex items-center gap-2"><span> </span> <span class="text-sm text-gray-900"> </span></div> <div class="flex items-center gap-2"><button type="button"> </button> <button type="button" class="px-2 py-1 text-xs bg-blue-100 hover:bg-blue-200 text-blue-800 rounded border border-blue-300" aria-label="Edit">Edit</button> <button type="button" class="px-2 py-1 text-xs bg-red-100 hover:bg-red-200 text-red-800 rounded border border-red-300" aria-label="Delete">Delete</button></div></div> <!></div>');function At(d,t){Ze(t,!0);let u=je(t,"isExpanded",3,!1),v=je(t,"isEdit",3,!1);const g=v()?"border-yellow-300":"border-green-300",s=v()?"bg-yellow-50":"bg-green-50",b=v()?"text-yellow-800":"text-green-800",k=v()?"bg-yellow-100 hover:bg-yellow-200":"bg-green-100 hover:bg-green-200",P=v()?"text-yellow-800":"text-green-800",N=v()?"border-yellow-300":"border-green-300",A=v()?"border-yellow-200":"border-green-200";var x=Ga(),S=i(x),j=i(S),M=i(j),$=i(M,!0);r(M);var Ae=o(M,2),T=i(Ae,!0);r(Ae),r(j);var y=o(j,2),w=i(y);w.__click=[Fa,t];var he=i(w,!0);r(w);var se=o(w,2);se.__click=[za,t];var _e=o(se,2);_e.__click=[Ba,t],r(y),r(S);var ge=o(S,2);{var we=E=>{var h=Ya(),I=i(h),G=o(i(I),2),ie=i(G,!0);r(G),r(I);var ue=o(I,2),V=o(i(ue),2),H=i(V,!0);r(V),r(ue);var ne=o(ue,2);{var xe=oe=>{var ee=Ua(),te=i(ee),Se=i(te);r(te);var me=o(te,2);le(me,21,()=>Object.entries(t.language.queries),de,(fe,ce)=>{var Oe=q(()=>Et(e(ce),2));let Le=()=>e(Oe)[0],be=()=>e(Oe)[1];var L=qa(),C=i(L),B=i(C,!0);r(C);var Q=o(C,2),W=i(Q,!0);r(Q);var Y=o(Q,2);{var De=D=>{var m=Pa(),X=i(m,!0);r(m),F(()=>R(X,be().note)),_(D,m)};K(Y,D=>{be().note&&D(De)})}r(L),F(()=>{R(B,Le()),R(W,be().polytime)}),_(fe,L)}),r(me),r(ee),F(fe=>R(Se,`Query Support (${fe??""}):`),[()=>Object.keys(t.language.queries).length]),_(oe,ee)};K(ne,oe=>{t.language.queries&&Object.keys(t.language.queries).length>0&&oe(xe)})}var Te=o(ne,2);{var z=oe=>{var ee=Va(),te=i(ee),Se=i(te);r(te);var me=o(te,2);le(me,21,()=>Object.entries(t.language.transformations),de,(fe,ce)=>{var Oe=q(()=>Et(e(ce),2));let Le=()=>e(Oe)[0],be=()=>e(Oe)[1];var L=Ka(),C=i(L),B=i(C,!0);r(C);var Q=o(C,2),W=i(Q,!0);r(Q);var Y=o(Q,2);{var De=D=>{var m=Qa(),X=i(m,!0);r(m),F(()=>R(X,be().note)),_(D,m)};K(Y,D=>{be().note&&D(De)})}r(L),F(()=>{R(B,Le()),R(W,be().polytime)}),_(fe,L)}),r(me),r(ee),F(fe=>R(Se,`Transformation Support (${fe??""}):`),[()=>Object.keys(t.language.transformations).length]),_(oe,ee)};K(Te,oe=>{t.language.transformations&&Object.keys(t.language.transformations).length>0&&oe(z)})}var U=o(Te,2);{var Pe=oe=>{var ee=Ja(),te=o(i(ee),2);le(te,21,()=>t.language.tags,de,(Se,me)=>{var fe=Xa(),ce=i(fe,!0);r(fe),F(()=>{Ot(fe,`background-color: ${e(me).color??""}`),R(ce,e(me).label)}),_(Se,fe)}),r(te),r(ee),_(oe,ee)};K(U,oe=>{t.language.tags&&t.language.tags.length>0&&oe(Pe)})}r(h),F(()=>{Ve(h,1,`mt-4 pt-4 border-t ${A} space-y-3 text-xs`),R(ie,t.language.fullName),R(H,t.language.description)}),_(E,h)};K(ge,E=>{u()&&E(we)})}r(x),F(()=>{Ve(x,1,`border-2 ${g} ${s} rounded-lg p-3`),Ve(M,1,`text-sm font-semibold ${b}`),R($,v()?"Edit Language:":"New Language:"),R(T,t.language.name),Ve(w,1,`px-2 py-1 text-xs ${k} ${P} rounded border ${N}`),Qe(w,"aria-label",u()?"Collapse":"Expand"),R(he,u()?"Collapse":"Expand")}),_(d,x),$e()}We(["click"]);var Ha=(d,t)=>t.onToggleExpand(t.index),Wa=(d,t)=>t.onEdit(t.index),Za=(d,t)=>t.onDelete(t.index),$a=p('<div class="mt-4 pt-4 border-t border-purple-200"><pre class="text-xs bg-white p-2 rounded border border-purple-200 overflow-x-auto"> </pre></div>'),er=p('<div class="border-2 border-purple-300 bg-purple-50 rounded-lg p-3"><div class="flex items-center justify-between"><div class="flex items-center gap-2"><span class="text-sm font-semibold text-purple-800">Reference</span></div> <div class="flex items-center gap-2"><button type="button" class="px-2 py-1 text-xs bg-purple-100 hover:bg-purple-200 text-purple-800 rounded border border-purple-300"> </button> <button type="button" class="px-2 py-1 text-xs bg-blue-100 hover:bg-blue-200 text-blue-800 rounded border border-blue-300" aria-label="Edit">Edit</button> <button type="button" class="px-2 py-1 text-xs bg-red-100 hover:bg-red-200 text-red-800 rounded border border-red-300" aria-label="Delete">Delete</button></div></div> <!></div>');function tr(d,t){Ze(t,!0);let u=je(t,"isExpanded",3,!1);var v=er(),g=i(v),s=o(i(g),2),b=i(s);b.__click=[Ha,t];var k=i(b,!0);r(b);var P=o(b,2);P.__click=[Wa,t];var N=o(P,2);N.__click=[Za,t],r(s),r(g);var A=o(g,2);{var x=S=>{var j=$a(),M=i(j),$=i(M,!0);r(M),r(j),F(()=>R($,t.reference)),_(S,j)};K(A,S=>{u()&&S(x)})}r(v),F(()=>{Qe(b,"aria-label",u()?"Collapse":"Expand"),R(k,u()?"Collapse":"Expand")}),_(d,v),$e()}We(["click"]);var ar=(d,t)=>t.onToggleExpand(t.index),rr=(d,t)=>t.onEdit(t.index),ir=(d,t,u)=>t.onDelete(t.index,u),nr=p('<div class="text-gray-500 text-xs mt-1"> </div>'),or=p('<div class="bg-white p-2 rounded border"><div class="font-medium"> </div> <div class="text-gray-600 text-xs"> </div> <div class="text-gray-500 italic text-xs"> </div> <!></div>'),lr=p('<div><div class="font-semibold text-gray-700 mb-1"> </div> <div class="space-y-2"></div></div>'),dr=p('<div><div class="font-semibold text-gray-700 mb-1">References:</div> <div class="text-gray-600"> </div></div>'),sr=p('<div class="mt-4 pt-4 border-t border-blue-200 space-y-3 text-xs"><div><div class="font-semibold text-gray-700 mb-1">Transformation Status:</div> <div class="bg-white p-2 rounded border"><span class="font-mono text-gray-900"> </span></div></div> <!> <!></div>'),ur=p('<div class="border-2 border-blue-300 bg-blue-50 rounded-lg p-3"><div class="flex items-center justify-between"><div class="flex items-center gap-2"><span class="text-sm font-semibold text-blue-800">Relationship:</span> <span class="text-sm text-gray-900"> </span></div> <div class="flex items-center gap-2"><button type="button" class="px-2 py-1 text-xs bg-blue-100 hover:bg-blue-200 text-blue-800 rounded border border-blue-300"> </button> <button type="button" class="px-2 py-1 text-xs bg-purple-100 hover:bg-purple-200 text-purple-800 rounded border border-purple-300" aria-label="Edit">Edit</button> <button type="button" class="px-2 py-1 text-xs bg-red-100 hover:bg-red-200 text-red-800 rounded border border-red-300" aria-label="Delete">Delete</button></div></div> <!></div>');function cr(d,t){Ze(t,!0);let u=je(t,"isExpanded",3,!1),v=je(t,"isModified",3,!1);const g=tt(t.relationship.sourceId,t.relationship.targetId);var s=at(),b=He(s);{var k=P=>{var N=ur(),A=i(N),x=i(A),S=o(i(x),2),j=i(S);r(S),r(x);var M=o(x,2),$=i(M);$.__click=[ar,t];var Ae=i($,!0);r($);var T=o($,2);T.__click=[rr,t];var y=o(T,2);y.__click=[ir,t,g],r(M),r(A);var w=o(A,2);{var he=se=>{var _e=sr(),ge=i(_e),we=o(i(ge),2),E=i(we),h=i(E,!0);r(E),r(we),r(ge);var I=o(ge,2);{var G=V=>{var H=lr(),ne=i(H),xe=i(ne);r(ne);var Te=o(ne,2);le(Te,21,()=>t.relationship.separatingFunctions,de,(z,U)=>{var Pe=or(),oe=i(Pe),ee=i(oe,!0);r(oe);var te=o(oe,2),Se=i(te);r(te);var me=o(te,2),fe=i(me,!0);r(me);var ce=o(me,2);{var Oe=Le=>{var be=nr(),L=i(be);r(be),F(C=>R(L,`Refs: [${C??""}]`),[()=>e(U).refs.join(", ")]),_(Le,be)};K(ce,Le=>{e(U).refs&&e(U).refs.length>0&&Le(Oe)})}r(Pe),F(()=>{R(ee,e(U).name),R(Se,`Short: ${e(U).shortName??""}`),R(fe,e(U).description)}),_(z,Pe)}),r(Te),r(H),F(()=>R(xe,`Separating Functions (${t.relationship.separatingFunctions.length??""}):`)),_(V,H)};K(I,V=>{t.relationship.separatingFunctions&&t.relationship.separatingFunctions.length>0&&V(G)})}var ie=o(I,2);{var ue=V=>{var H=dr(),ne=o(i(H),2),xe=i(ne,!0);r(ne),r(H),F(Te=>R(xe,Te),[()=>t.relationship.refs.join(", ")]),_(V,H)};K(ie,V=>{t.relationship.refs&&t.relationship.refs.length>0&&V(ue)})}r(_e),F(()=>R(h,t.relationship.status)),_(se,_e)};K(w,se=>{u()&&se(he)})}r(N),F(()=>{R(j,`${t.relationship.sourceId??""} â†’ ${t.relationship.targetId??""}`),Qe($,"aria-label",u()?"Collapse":"Expand"),R(Ae,u()?"Collapse":"Expand")}),_(P,N)};K(b,P=>{v()&&P(k)})}_(d,s),$e()}We(["click"]);var vr=p('<div class="text-center py-8 text-gray-500 italic">No changes queued yet. Use the buttons below to add items.</div>'),gr=p(`<div class="space-y-3"><h2 class="text-lg font-bold text-gray-900">Queued Changes</h2> <p class="text-sm text-gray-600">Items you've added will appear here.</p> <div class="space-y-2"><!> <!> <!> <!> <!></div></div>`);function fr(d,t){Ze(t,!0);const u=q(()=>t.languagesToAdd.length>0||t.languagesToEdit.length>0||t.newReferences.length>0||t.relationships.filter(x=>t.modifiedRelations.has(tt(x.sourceId,x.targetId))).length>0);var v=gr(),g=o(i(v),4),s=i(g);le(s,17,()=>t.newReferences,de,(x,S,j)=>{{let M=q(()=>t.expandedReferenceIndex===j);tr(x,{get reference(){return e(S)},index:j,get isExpanded(){return e(M)},get onToggleExpand(){return t.onToggleExpandReference},get onEdit(){return t.onEditReference},get onDelete(){return t.onDeleteReference}})}});var b=o(s,2);le(b,17,()=>t.languagesToAdd,de,(x,S,j)=>{{let M=q(()=>t.expandedLanguageToAddIndex===j);At(x,{get language(){return e(S)},index:j,get isExpanded(){return e(M)},isEdit:!1,get onToggleExpand(){return t.onToggleExpandLanguageToAdd},get onEdit(){return t.onEditLanguageToAdd},get onDelete(){return t.onDeleteLanguageToAdd}})}});var k=o(b,2);le(k,17,()=>t.languagesToEdit,de,(x,S,j)=>{{let M=q(()=>t.expandedLanguageToEditIndex===j);At(x,{get language(){return e(S)},index:j,get isExpanded(){return e(M)},isEdit:!0,get onToggleExpand(){return t.onToggleExpandLanguageToEdit},get onEdit(){return t.onEditLanguageToEdit},get onDelete(){return t.onDeleteLanguageToEdit}})}});var P=o(k,2);le(P,17,()=>t.relationships,de,(x,S,j)=>{const M=q(()=>t.modifiedRelations.has(tt(e(S).sourceId,e(S).targetId)));{let $=q(()=>t.expandedRelationshipIndex===j);cr(x,{get relationship(){return e(S)},index:j,get isModified(){return e(M)},get isExpanded(){return e($)},get onToggleExpand(){return t.onToggleExpandRelationship},get onEdit(){return t.onEditRelationship},get onDelete(){return t.onDeleteRelationship}})}});var N=o(P,2);{var A=x=>{var S=vr();_(x,S)};K(N,x=>{e(u)||x(A)})}r(g),r(v),_(d,v),$e()}var br=p('<div class="grid grid-cols-2 md:grid-cols-4 gap-3"><button type="button" class="px-4 py-3 bg-green-600 hover:bg-green-700 text-white font-medium rounded-lg transition-colors">+ New Language</button> <button type="button" class="px-4 py-3 bg-yellow-600 hover:bg-yellow-700 text-white font-medium rounded-lg transition-colors">âœŽ Edit Language</button> <button type="button" class="px-4 py-3 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors">ðŸ”— Manage Relationships</button> <button type="button" class="px-4 py-3 bg-purple-600 hover:bg-purple-700 text-white font-medium rounded-lg transition-colors">+ New Reference</button></div>');function _r(d,t){var u=br(),v=i(u);v.__click=function(...k){t.onAddLanguage?.apply(this,k)};var g=o(v,2);g.__click=function(...k){t.onEditLanguage?.apply(this,k)};var s=o(g,2);s.__click=function(...k){t.onManageRelationships?.apply(this,k)};var b=o(s,2);b.__click=function(...k){t.onAddReference?.apply(this,k)},r(u),_(d,u)}We(["click"]);var xr=p('<div class="pt-6"><button type="submit" class="group relative w-full px-8 py-4 bg-gradient-to-r from-indigo-600 to-purple-700 text-white font-bold text-lg rounded-xl hover:from-indigo-700 hover:to-purple-800 disabled:from-gray-400 disabled:to-gray-500 disabled:cursor-not-allowed transition-all duration-300 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 active:translate-y-0"><span class="flex items-center justify-center"><svg class="w-5 h-5 mr-2 transition-transform group-hover:scale-110" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path></svg> Preview Changes</span></button> <p class="text-center text-sm text-gray-500 mt-4">Preview your changes on the graph before submitting</p></div>');function mr(d,t){let u=je(t,"disabled",3,!1);var v=xr(),g=i(v);ft(2),r(v),F(()=>g.disabled=u()),_(d,v)}var pr=(d,t)=>a(t,!1),yr=d=>d.stopPropagation(),hr=p("<option> </option>"),wr=(d,t,u)=>{a(t,""),a(u,!1)},Er=(d,t,u,v)=>{e(t)&&(a(u,!1),a(v,!0))},kr=p('<div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"><div class="bg-white rounded-xl shadow-2xl max-w-md w-full"><div class="bg-gradient-to-r from-yellow-600 to-yellow-700 px-6 py-4"><h2 class="text-2xl font-bold text-white">Select Language to Edit</h2> <p class="text-yellow-100 mt-1">Choose an existing language</p></div> <div class="p-6"><label for="language-selector" class="block text-sm font-medium text-gray-700 mb-2">Language <span class="text-red-500">*</span></label> <select id="language-selector" class="w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-yellow-500"><option>Choose a language...</option><!></select> <div class="flex gap-3 justify-end pt-4 mt-4 border-t"><button type="button" class="px-4 py-2 border-2 border-gray-300 text-gray-700 font-medium rounded-lg hover:bg-gray-50 transition-colors">Cancel</button> <button type="button" class="px-4 py-2 bg-yellow-600 text-white font-medium rounded-lg hover:bg-yellow-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors">Edit</button></div></div></div></div>'),Rr=p('<div class="min-h-screen bg-gradient-to-br from-blue-50 via-white to-emerald-50 py-12 px-4 sm:px-6 lg:px-8"><div class="max-w-4xl mx-auto"><div class="text-center mb-12"><h1 class="text-5xl font-extrabold text-gray-900 mb-4 tracking-tight">Contribute to the KC Map</h1> <p class="text-xl text-gray-600 max-w-2xl mx-auto leading-relaxed">Help improve the Knowledge Compilation Map by adding new languages or updating existing ones.</p></div> <div class="bg-white rounded-2xl shadow-2xl overflow-hidden border border-gray-100"><div class="bg-gradient-to-r from-blue-600 to-blue-700 px-8 py-6"><h2 class="text-2xl font-bold text-white">Submission Form</h2> <p class="text-blue-100 mt-1">Fill out the details below to contribute</p></div> <div class="p-8 sm:p-10"><form class="space-y-8"><div class="bg-gradient-to-r from-blue-50 to-indigo-50 p-6 rounded-xl border border-blue-200"><h2 class="text-lg font-bold text-gray-900 mb-4">Contributor Information</h2> <div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div><label for="contributor-email" class="block text-sm font-medium text-gray-700 mb-1">Email Address <span class="text-red-500">*</span></label> <input type="email" id="contributor-email" required class="w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="your.email@example.com"/></div> <div><label for="contributor-github" class="block text-sm font-medium text-gray-700 mb-1">GitHub Username (optional)</label> <input type="text" id="contributor-github" class="w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="@username"/></div></div> <div class="mt-4"><label for="contributor-note" class="block text-sm font-medium text-gray-700 mb-1">Note (optional)</label> <textarea id="contributor-note" rows="3" class="w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-y" placeholder="Add any clarifications or additional context for your contribution..."></textarea> <p class="mt-1 text-xs text-gray-500">This note will be included in the pull request description.</p></div></div> <!>  <!> <!></form></div></div></div></div> <!> <!> <!> <!> <!>',1);function Cr(d,t){Ze(t,!0);const u="kcm_contribute_queue_v1",v="kcm_contributor_info_v1",g=n=>typeof n=="string",s=n=>Array.isArray(n)?n.filter(g):[];function b(n){if(!n||typeof n!="object")return{};const f={};for(const[l,c]of Object.entries(n)){if(!c||typeof c!="object")continue;const J=g(c.polytime)?c.polytime:"unknown",Ue=g(c.note)?c.note:void 0,et=s(c.refs),Z={polytime:J,refs:et};Ue&&(Z.note=Ue),f[l]=Z}return f}function k(n){if(!Array.isArray(n))return[];const f=[];for(const l of n){if(!l||typeof l!="object")continue;const c=l;!g(c.id)||!g(c.label)||f.push({id:c.id,label:c.label,color:g(c.color)?c.color:"#6366f1",description:g(c.description)?c.description:void 0,refs:s(c.refs)})}return f}function P(n){return Array.isArray(n)?n.map(f=>{if(!f||typeof f!="object")return null;const l=f;return!g(l.id)||!g(l.name)||!g(l.fullName)||!g(l.description)?null:{id:l.id,name:l.name,fullName:l.fullName,description:l.description,descriptionRefs:s(l.descriptionRefs),queries:b(l.queries),transformations:b(l.transformations),tags:k(l.tags),existingReferences:s(l.existingReferences)}}).filter(f=>f!==null):[]}function N(n){if(!Array.isArray(n))return[];const f=[];for(const l of n){if(!l||typeof l!="object")continue;const c=l;!g(c.shortName)||!g(c.name)||!g(c.description)||f.push({shortName:c.shortName,name:c.name,description:c.description,refs:s(c.refs)})}return f}function A(n){return Array.isArray(n)?n.map(f=>{if(!f||typeof f!="object")return null;const l=f;if(!g(l.sourceId)||!g(l.targetId)||!g(l.status))return null;const c=N(l.separatingFunctions),J={sourceId:l.sourceId,targetId:l.targetId,status:l.status,refs:s(l.refs)};return c.length>0&&(J.separatingFunctions=c),J}).filter(f=>f!==null):[]}const x=Object.values(t.data.polytimeOptions),S=t.data.relationTypes.map(n=>({value:n.id,label:n.name,description:n.description??""})),j=Nt(t.data.adjacencyMatrix);let M=O(""),$=O(""),Ae=O(""),T=O(Ne([])),y=O(Ne([])),w=O(Ne([])),he=O(null),se=O(null),_e=O(null),ge=O(null),we=O(!1),E=O(!1),h=O(!1),I=O(""),G=O(!1),ie=O(!1),ue=O(null),V=O(null),H=O(null),ne=O(null),xe=O(Ne(new Set)),Te=O(!1),z=O(Ne([])),U=O(Ne([]));const Pe=q(()=>e(T).length>0||e(y).length>0||e(w).filter(n=>e(xe).has(tt(n.sourceId,n.targetId))).length>0||e(z).length>0||e(U).length>0);Bt(()=>{try{const n=localStorage.getItem(u);if(n){const l=JSON.parse(n);a(T,P(l?.languagesToAdd),!0),a(y,P(l?.languagesToEdit),!0),a(w,A(l?.relationships),!0),a(z,s(l?.newReferences),!0),a(U,k(l?.customTags),!0),a(xe,new Set(s(l?.modifiedRelations)),!0)}const f=localStorage.getItem(v);if(f){const l=JSON.parse(f);g(l?.email)&&a(M,l.email,!0),g(l?.github)&&a($,l.github,!0),g(l?.note)&&a(Ae,l.note,!0)}}catch(n){console.warn("Failed to restore queued changes from storage",n)}finally{a(Te,!0)}});function oe(n){const f=n(e(xe));a(xe,new Set(f),!0)}function ee(n){const f=tt(n.sourceId,n.targetId);oe(l=>{const c=new Set(l);return c.add(f),c})}function te(n){oe(f=>{if(!f.has(n))return f;const l=new Set(f);return l.delete(n),l})}Xe(()=>{if(!e(Te)||!ht)return;if(e(T).length===0&&e(y).length===0&&e(w).length===0&&e(z).length===0&&e(U).length===0&&e(xe).size===0){try{localStorage.removeItem(u)}catch(l){console.warn("Failed to clear queued changes from storage",l)}return}const f={languagesToAdd:e(T),languagesToEdit:e(y),relationships:e(w),newReferences:e(z),customTags:e(U),modifiedRelations:Array.from(e(xe))};try{localStorage.setItem(u,JSON.stringify(f))}catch(l){console.warn("Failed to persist queued changes",l)}}),Xe(()=>{if(!e(Te)||!ht)return;const n={email:e(M),github:e($),note:e(Ae)};try{localStorage.setItem(v,JSON.stringify(n))}catch(f){console.warn("Failed to persist contributor info",f)}});function Se(n){return a(T,[...e(T),n],!0),{success:!0}}function me(n){const f=e(y).findIndex(l=>l.id===n.id);return f>=0?(e(y)[f]=n,a(y,[...e(y)],!0)):a(y,[...e(y),n],!0),{success:!0}}function fe(n){a(z,[...e(z),n],!0)}let ce=O(null);function Oe(n){a(ce,{languages:e(T).slice(n+1),editedLanguages:e(y).slice(n+1),references:e(z).slice(n+1),relationships:e(w).filter((f,l)=>l>n),tags:e(U).slice(n+1)},!0),a(T,e(T).slice(0,n+1),!0),a(y,e(y).slice(0,n+1),!0),a(z,e(z).slice(0,n+1),!0),a(w,e(w).slice(0,n+1),!0),a(U,e(U).slice(0,n+1),!0),a(ue,n,!0),a(G,!0)}function Le(n){e(ue)!==null&&(e(z)[e(ue)]=n,a(z,[...e(z)],!0),e(ce)&&(a(T,[...e(T),...e(ce).languages],!0),a(y,[...e(y),...e(ce).editedLanguages],!0),a(z,[...e(z),...e(ce).references],!0),a(w,[...e(w),...e(ce).relationships],!0),a(U,[...e(U),...e(ce).tags],!0)),a(ue,null),a(ce,null))}function be(n){a(V,n,!0),a(we,!0)}function L(n){return e(V)!==null&&(e(T)[e(V)]=n,a(T,[...e(T)],!0),a(V,null)),{success:!0}}function C(n){a(H,n,!0),a(E,!0)}function B(n){return e(H)!==null&&(e(y)[e(H)]=n,a(y,[...e(y)],!0),a(H,null)),{success:!0}}function Q(n){a(ne,n,!0),a(ie,!0)}function W(n){e(ne)!==null&&(e(w)[e(ne)]=n,a(w,[...e(w)],!0),ee(n),a(ne,null))}function Y(n){if(e(ne)!==null){W(n);return}const f=tt(n.sourceId,n.targetId),l=e(w).findIndex(c=>tt(c.sourceId,c.targetId)===f);l>=0?(e(w)[l]=n,a(w,[...e(w)],!0)):a(w,[...e(w),n],!0),ee(n)}function De(n){const f=new Set(t.data.existingReferences.map(c=>c.id));for(let c=0;c<n;c++){const J=wt(e(z)[c],f);f.add(J)}const l=wt(e(z)[n],f);a(z,e(z).filter((c,J)=>J!==n),!0),e(T).forEach(c=>{c.descriptionRefs=c.descriptionRefs.filter(J=>J!==l)}),e(y).forEach(c=>{c.descriptionRefs=c.descriptionRefs.filter(J=>J!==l)}),e(w).forEach(c=>{c.refs=c.refs.filter(J=>J!==l),c.separatingFunctions?.forEach(J=>{J.refs=J.refs.filter(Ue=>Ue!==l)})}),e(U).forEach(c=>{c.refs=c.refs.filter(J=>J!==l)}),a(T,[...e(T)],!0),a(y,[...e(y)],!0),a(w,[...e(w)],!0),a(U,[...e(U)],!0)}function D(n){n.preventDefault(),window.location.href="/"}var m=Rr();Jt(n=>{Yt.title="Contribute - Knowledge Compilation Map"});var X=He(m),Ie=i(X),ae=o(i(Ie),2),re=o(i(ae),2),Ce=i(re),pe=i(Ce),Fe=o(i(pe),2),ze=i(Fe),rt=o(i(ze),2);Ge(rt),r(ze);var qe=o(ze,2),Je=o(i(qe),2);Ge(Je),r(qe),r(Fe);var Ye=o(Fe,2),Ke=o(i(Ye),2);ct(Ke),ft(2),r(Ye),r(pe);var it=o(pe,2);fr(it,{get languagesToAdd(){return e(T)},get languagesToEdit(){return e(y)},get newReferences(){return e(z)},get relationships(){return e(w)},get modifiedRelations(){return e(xe)},get expandedLanguageToAddIndex(){return e(he)},get expandedLanguageToEditIndex(){return e(se)},get expandedReferenceIndex(){return e(ge)},get expandedRelationshipIndex(){return e(_e)},onToggleExpandLanguageToAdd:n=>a(he,e(he)===n?null:n,!0),onToggleExpandLanguageToEdit:n=>a(se,e(se)===n?null:n,!0),onToggleExpandReference:n=>a(ge,e(ge)===n?null:n,!0),onToggleExpandRelationship:n=>a(_e,e(_e)===n?null:n,!0),onEditLanguageToAdd:be,onEditLanguageToEdit:C,onDeleteLanguageToAdd:n=>a(T,e(T).filter((f,l)=>l!==n),!0),onDeleteLanguageToEdit:n=>a(y,e(y).filter((f,l)=>l!==n),!0),onEditReference:Oe,onDeleteReference:De,onEditRelationship:Q,onDeleteRelationship:(n,f)=>{a(w,e(w).filter((l,c)=>c!==n),!0),te(f)}});var nt=o(it,2);_r(nt,{onAddLanguage:()=>a(we,!0),onEditLanguage:()=>a(h,!0),onManageRelationships:()=>a(ie,!0),onAddReference:()=>a(G,!0)});var ve=o(nt,2);{let n=q(()=>!e(Pe));mr(ve,{get disabled(){return e(n)}})}r(Ce),r(re),r(ae),r(Ie),r(X);var Ee=o(X,2);{let n=q(()=>e(V)!==null?L:Se),f=q(()=>e(V)!==null),l=q(()=>e(V)!==null?e(T)[e(V)]:void 0),c=q(()=>Object.values(t.data.queries).map(Re=>({code:Re.code,name:Re.label}))),J=q(()=>Object.values(t.data.transformations).map(Re=>({code:Re.code,name:Re.label}))),Ue=q(()=>x.map(Re=>({value:Re.code,label:Re.label,description:Re.description||""}))),et=q(()=>[...t.data.existingTags,...e(U)].map(Re=>({id:Re.id,label:Re.label,color:Re.color||"#6366f1",description:"",refs:[]}))),Z=q(()=>_t(t.data.existingReferences,e(z)));Rt(Ee,{onClose:()=>{a(we,!1),a(V,null)},get onAdd(){return e(n)},get isEdit(){return e(f)},get initialData(){return e(l)},get queries(){return e(c)},get transformations(){return e(J)},get polytimeOptions(){return e(Ue)},get existingTags(){return e(et)},get availableRefs(){return e(Z)},get isOpen(){return e(we)},set isOpen(Re){a(we,Re,!0)}})}var ke=o(Ee,2);{let n=q(()=>e(H)!==null?B:me),f=q(()=>e(H)!==null?e(y)[e(H)]:e(I)?Ft(t.data.languages.find(Z=>Z.id===e(I))):void 0),l=q(()=>Object.values(t.data.queries).map(Z=>({code:Z.code,name:Z.label}))),c=q(()=>Object.values(t.data.transformations).map(Z=>({code:Z.code,name:Z.label}))),J=q(()=>x.map(Z=>({value:Z.code,label:Z.label,description:Z.description||""}))),Ue=q(()=>[...t.data.existingTags,...e(U)].map(Z=>({id:Z.id,label:Z.label,color:Z.color||"#6366f1",description:"",refs:[]}))),et=q(()=>_t(t.data.existingReferences,e(z)));Rt(ke,{onClose:()=>{a(E,!1),a(I,""),a(H,null)},get onAdd(){return e(n)},isEdit:!0,get initialData(){return e(f)},get queries(){return e(l)},get transformations(){return e(c)},get polytimeOptions(){return e(J)},get existingTags(){return e(Ue)},get availableRefs(){return e(et)},get isOpen(){return e(E)},set isOpen(Z){a(E,Z,!0)}})}var Me=o(ke,2);{var ye=n=>{var f=kr();f.__click=[pr,h];var l=i(f);l.__click=[yr];var c=o(i(l),2),J=o(i(c),2),Ue=i(J);Ue.value=Ue.__value="";var et=o(Ue);le(et,17,()=>t.data.languages,de,(bt,vt)=>{var st=hr(),St=i(st);r(st);var yt={};F(()=>{R(St,`${e(vt).name??""} (${e(vt).id??""})`),yt!==(yt=e(vt).id)&&(st.value=(st.__value=e(vt).id)??"")}),_(bt,st)}),r(J);var Z=o(J,2),Re=i(Z);Re.__click=[wr,I,h];var pt=o(Re,2);pt.__click=[Er,I,h,E],r(Z),r(c),r(l),r(f),F(()=>pt.disabled=!e(I)),lt(J,()=>e(I),bt=>a(I,bt)),_(n,f)};K(Me,n=>{e(h)&&n(ye)})}var ot=o(Me,2);{let n=q(()=>e(ue)!==null?Le:fe),f=q(()=>e(ue)!==null?e(z)[e(ue)]:""),l=q(()=>e(ue)!==null);ha(ot,{onClose:()=>{a(G,!1),a(ue,null),a(ce,null)},get onAdd(){return e(n)},get initialValue(){return e(f)},get isEditMode(){return e(l)},get isOpen(){return e(G)},set isOpen(c){a(G,c,!0)}})}var dt=o(ot,2);{let n=q(()=>e(ne)!==null?e(w)[e(ne)]:void 0),f=q(()=>zt(t.data.languages,e(T),e(y))),l=q(()=>_t(t.data.existingReferences,e(z)));Na(dt,{onClose:()=>{a(ie,!1),a(ne,null)},onSave:Y,get initialData(){return e(n)},get languages(){return e(f)},get statusOptions(){return S},get availableRefs(){return e(l)},get baselineRelations(){return j},get isOpen(){return e(ie)},set isOpen(c){a(ie,c,!0)}})}Pt("submit",Ce,D),Be(rt,()=>e(M),n=>a(M,n)),Be(Je,()=>e($),n=>a($,n)),Be(Ke,()=>e(Ae),n=>a(Ae,n)),_(d,m),$e()}We(["click"]);export{Cr as component,Ir as universal};
