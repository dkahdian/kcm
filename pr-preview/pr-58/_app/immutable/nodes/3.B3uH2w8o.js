import{d as Ua,a as pt,r as Ba,b as za,P as Ka,T as Va,Q as Ha,e as de,i as ue,M as We,c as tt,f as Ga,g as jt,v as Xa,p as Ja,h as Wa,j as Lt,k as ra,C as na,s as ia,l as Ya,m as oa,n as Ct,o as Za,q as $a,t as _t,u as er,w as tr}from"../chunks/73Kh69S-.js";import"../chunks/DsnmJJEf.js";import{s as A,o as ar}from"../chunks/D4xMwpl8.js";import{a$ as rr,aT as nr,u as ir,r as or,h as sr,k as ft,be as lr,ba as rt,K as He,X as F,y as Ie,a4 as Qe,z as r,v as e,Z as Ve,_ as Ke,Q as m,R as Ge,M as w,V as i,Y as n,al as at,T as o,bf as bt,O as q,aW as j,aX as dr,a0 as ur,bg as sa,N as cr,bh as gr,$ as vr}from"../chunks/CuxRnwIY.js";import{p as be,i as U}from"../chunks/CTb7Me_4.js";import{r as Ye,s as ze,b as ot,a as Ue,c as fr}from"../chunks/BQmAUj6M.js";function Pe(l,t,d=t){var v=new WeakSet;rr(l,"input",async b=>{var y=b?l.defaultValue:l.value;if(y=Ot(l)?Nt(y):y,d(y),ft!==null&&v.add(ft),await nr(),y!==(y=t())){var p=l.selectionStart,f=l.selectionEnd;l.value=y??"",f!==null&&(l.selectionStart=p,l.selectionEnd=Math.min(f,l.value.length))}}),(sr&&l.defaultValue!==l.value||ir(t)==null&&l.value)&&(d(Ot(l)?Nt(l.value):l.value),ft!==null&&v.add(ft)),or(()=>{var b=t();if(l===document.activeElement){var y=lr??ft;if(v.has(y))return}Ot(l)&&b===Nt(l.value)||l.type==="date"&&!b&&!l.value||b!==l.value&&(l.value=b??"")})}function Ot(l){var t=l.type;return t==="number"||t==="range"}function Nt(l){return l===""?null:+l}const ba={},br=Ua.separatingFunctions;for(const l of br)ba[l.shortName]=l;const mr=Object.values(ba),xr=()=>{const l=pt.map(p=>p.name),t=new Map;for(const p of pt)if(p.references)for(const f of p.references)t.has(f.id)||t.set(f.id,f.title);const d=Array.from(t.entries()).map(([p,f])=>({id:p,title:f})),v=new Map;for(const p of pt)if(p.tags)for(const f of p.tags)v.has(f.label)||v.set(f.label,{label:f.label,color:f.color});const b=Array.from(v.values()),y=mr.map(p=>({shortName:p.shortName,name:p.name,description:p.description}));return{existingLanguageIds:l,existingReferences:d,existingSeparatingFunctions:y,existingTags:b,languages:pt,queries:Ha,transformations:Va,polytimeOptions:Ka,adjacencyMatrix:za,relationTypes:Ba}},pr=!1,xi=Object.freeze(Object.defineProperty({__proto__:null,load:xr,prerender:pr},Symbol.toStringTag,{value:"Module"}));async function _r(l,t,d,v,b,y,p,f,x,S,D,u){if(!e(t).trim()||!e(d).trim()||!e(v).trim()){r(b,"Please fill out all required fields.");return}try{const g=await y.onAdd({name:e(t).trim(),fullName:e(d).trim(),description:e(v).trim(),descriptionRefs:e(p),queries:e(f),transformations:e(x),tags:e(S),existingReferences:e(D)}),_=g&&typeof g=="object"&&"success"in g?g:void 0;if(_&&!_.success){r(b,_.error??"Unable to add language. Please review your input.",!0);return}r(b,null),u(),y.onClose?.()}catch(g){r(b,g instanceof Error?g.message:"Unexpected error while adding the language.",!0)}}function la(l,t,d){t(),d.onClose()}var yr=l=>l.stopPropagation(),hr=w('<div class="p-3 bg-red-50 border border-red-200 rounded-lg text-sm text-red-700"> </div>'),wr=(l,t,d)=>t(e(d)),Er=w('<button type="button"> </button>'),kr=w('<fieldset><legend class="block text-sm font-medium text-gray-700 mb-2">Description References</legend> <div class="flex flex-wrap gap-2"></div></fieldset>'),Rr=w("<option> </option>"),Sr=(l,t,d,v)=>t(e(d).code,e(v)),Ir=w('<button type="button"> </button>'),Tr=w('<div class="mt-2 flex flex-wrap gap-1"></div>'),Fr=w('<div class="p-3 bg-gray-50 rounded-lg border border-gray-200"><div class="grid grid-cols-1 md:grid-cols-2 gap-3"><div><label class="block text-xs font-medium text-gray-700 mb-1"> </label> <select class="w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-green-500"></select></div> <div><label class="block text-xs font-medium text-gray-700 mb-1">Note</label> <input type="text" placeholder="Optional note..." class="w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-green-500"/></div></div> <!></div>'),Dr=w("<option> </option>"),Ar=(l,t,d,v)=>t(e(d).code,e(v)),Lr=w('<button type="button"> </button>'),Or=w('<div class="mt-2 flex flex-wrap gap-1"></div>'),Nr=w('<div class="p-3 bg-gray-50 rounded-lg border border-gray-200"><div class="grid grid-cols-1 md:grid-cols-2 gap-3"><div><label class="block text-xs font-medium text-gray-700 mb-1"> </label> <select class="w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-green-500"></select></div> <div><label class="block text-xs font-medium text-gray-700 mb-1">Note</label> <input type="text" placeholder="Optional note..." class="w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-green-500"/></div></div> <!></div>'),Mr=(l,t,d)=>t(e(d)),jr=w('<button type="button"> </button>'),Cr=w('<div class="space-y-4 border-t pt-6"><h3 class="text-lg font-bold text-gray-900">Tags</h3> <div class="flex flex-wrap gap-2"></div></div>'),qr=w(`<div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"><div class="bg-white rounded-xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto"><div class="bg-gradient-to-r from-green-600 to-green-700 px-6 py-4 sticky top-0 z-10"><h2 class="text-2xl font-bold text-white"> </h2> <p class="text-green-100 mt-1">Define a knowledge compilation language</p></div> <div class="p-6 space-y-6"><!> <div class="space-y-4"><h3 class="text-lg font-bold text-gray-900">Basic Information</h3> <div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div><label for="lang-name" class="block text-sm font-medium text-gray-700 mb-1">Short Name <span class="text-red-500">*</span></label> <input type="text" id="lang-name" placeholder="e.g., 'OBDD', 'd-DNNF'" class="w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"/></div> <div><label for="lang-fullname" class="block text-sm font-medium text-gray-700 mb-1">Full Name <span class="text-red-500">*</span></label> <input type="text" id="lang-fullname" placeholder="e.g., 'Ordered Binary Decision Diagrams'" class="w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"/></div></div> <div><label for="lang-description" class="block text-sm font-medium text-gray-700 mb-1">Description <span class="text-red-500">*</span></label> <textarea id="lang-description" placeholder="Brief description of this language..." rows="3" class="w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"></textarea></div> <!></div> <div class="space-y-4 border-t pt-6"><h3 class="text-lg font-bold text-gray-900">Query Support</h3> <div class="space-y-3"></div></div> <div class="space-y-4 border-t pt-6"><h3 class="text-lg font-bold text-gray-900">Transformation Support</h3> <div class="space-y-3"></div></div> <!> <div class="flex gap-3 justify-end pt-6 border-t sticky bottom-0 bg-white"><button type="button" class="px-4 py-2 border-2 border-gray-300 text-gray-700 font-medium rounded-lg hover:bg-gray-50 transition-colors">Cancel</button> <button type="button" class="px-4 py-2 bg-green-600 text-white font-medium rounded-lg hover:bg-green-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors"> </button></div></div></div></div>`);function da(l,t){He(t,!0);let d=be(t,"isOpen",11,!1),v=be(t,"availableRefs",19,()=>[]),b=be(t,"isEdit",3,!1),y=F(""),p=F(""),f=F(""),x=F(Ie([])),S=F(Ie({})),D=F(Ie({})),u=F(Ie([])),g=F(Ie([])),_=F(null);Qe(()=>{b()&&t.initialData&&(r(y,t.initialData.name,!0),r(p,t.initialData.fullName,!0),r(f,t.initialData.description,!0),r(x,[...t.initialData.descriptionRefs],!0),r(S,{...t.initialData.queries},!0),r(D,{...t.initialData.transformations},!0),r(u,[...t.initialData.tags],!0),r(g,[...t.initialData.existingReferences],!0),r(_,null))});function E(){r(y,""),r(p,""),r(f,""),r(x,[],!0),r(S,{},!0),r(D,{},!0),r(u,[],!0),r(g,[],!0),r(L,!1),r(G,!1),r(_,null)}function N(R){e(x).includes(R)?r(x,e(x).filter(c=>c!==R),!0):r(x,[...e(x),R],!0)}function ie(R){e(u).some(c=>c.label===R.label)?r(u,e(u).filter(c=>c.label!==R.label),!0):r(u,[...e(u),R],!0)}function ae(R,c){if(!e(S)[R])return;const I=e(S)[R].refs;I.includes(c)?e(S)[R].refs=I.filter(C=>C!==c):e(S)[R].refs=[...I,c],r(S,{...e(S)},!0)}function B(R,c){if(!e(D)[R])return;const I=e(D)[R].refs;I.includes(c)?e(D)[R].refs=I.filter(C=>C!==c):e(D)[R].refs=[...I,c],r(D,{...e(D)},!0)}let L=F(!1),G=F(!1);Qe(()=>{if(t.queries.length>0&&!e(L)){const R={};t.queries.forEach(c=>{if(b()&&t.initialData&&t.initialData.queries[c.code]){const I=t.initialData.queries[c.code];R[c.code]={polytime:I.polytime,note:I.note||"",refs:[...I.refs]}}else R[c.code]={polytime:"unknown",note:"",refs:[]}}),r(S,R,!0),r(L,!0)}}),Qe(()=>{if(t.transformations.length>0&&!e(G)){const R={};t.transformations.forEach(c=>{if(b()&&t.initialData){let I=t.initialData.transformations[c.code];if(!I){const C=Object.keys(t.initialData.transformations).find(O=>t.initialData.transformations[O]!==void 0&&(O===c.code||c.code==="∧C"&&O==="AND_C"||c.code==="∧BC"&&O==="AND_BC"||c.code==="∨C"&&O==="OR_C"||c.code==="∨BC"&&O==="OR_BC"||c.code==="¬C"&&O==="NOT_C"));C&&(I=t.initialData.transformations[C])}R[c.code]=I?{polytime:I.polytime,note:I.note||"",refs:[...I.refs]}:{polytime:"unknown",note:"",refs:[]}}else R[c.code]={polytime:"unknown",note:"",refs:[]}}),r(D,R,!0),r(G,!0)}});var H=Ve(),J=Ke(H);{var z=R=>{var c=qr();c.__click=[la,E,t];var I=i(c);I.__click=[yr];var C=i(I),O=i(C),X=i(O);n(O),at(2),n(C);var W=o(C,2),re=i(W);{var ce=Q=>{var P=hr(),Fe=i(P,!0);n(P),q(()=>A(Fe,e(_))),m(Q,P)};U(re,Q=>{e(_)&&Q(ce)})}var ge=o(re,2),pe=o(i(ge),2),te=i(pe),he=o(i(te),2);Ye(he),n(te);var oe=o(te,2),Y=o(i(oe),2);Ye(Y),n(oe),n(pe);var se=o(pe,2),me=o(i(se),2);bt(me),n(se);var _e=o(se,2);{var Ne=Q=>{var P=kr(),Fe=o(i(P),2);de(Fe,21,v,ue,(ke,ve)=>{var ne=Er();ne.__click=[wr,N,ve];var De=i(ne,!0);n(ne),q(Re=>{Ue(ne,1,Re),A(De,e(ve))},[()=>`px-3 py-1 text-sm rounded-lg border-2 transition-colors ${e(x).includes(e(ve))?"bg-green-600 text-white border-green-600":"bg-white text-gray-700 border-gray-300 hover:border-green-300"}`]),m(ke,ne)}),n(Fe),n(P),m(Q,P)};U(_e,Q=>{v().length>0&&Q(Ne)})}n(ge);var Te=o(ge,2),Me=o(i(Te),2);de(Me,21,()=>t.queries,ue,(Q,P)=>{var Fe=Ve(),ke=Ke(Fe);{var ve=ne=>{var De=Fr(),Re=i(De),je=i(Re),Ce=i(je),nt=i(Ce,!0);n(Ce);var Be=o(Ce,2);de(Be,21,()=>t.polytimeOptions,ue,(ye,Ae)=>{var Le=Rr(),qe=i(Le,!0);n(Le);var Se={};q(()=>{A(qe,e(Ae).label),Se!==(Se=e(Ae).value)&&(Le.value=(Le.__value=e(Ae).value)??"")}),m(ye,Le)}),n(Be),n(je);var Ze=o(je,2),$e=i(Ze),Xe=o($e,2);Ye(Xe),n(Ze),n(Re);var st=o(Re,2);{var lt=ye=>{var Ae=Tr();de(Ae,21,v,ue,(Le,qe)=>{var Se=Ir();Se.__click=[Sr,ae,P,qe];var dt=i(Se,!0);n(Se),q(ut=>{Ue(Se,1,ut),A(dt,e(qe))},[()=>`px-2 py-0.5 text-xs rounded ${e(S)[e(P).code].refs.includes(e(qe))?"bg-green-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`]),m(Le,Se)}),n(Ae),m(ye,Ae)};U(st,ye=>{v().length>0&&ye(lt)})}n(De),q(()=>{ze(Ce,"for",`query-${e(P).code??""}-polytime`),A(nt,e(P).name),ze(Be,"id",`query-${e(P).code??""}-polytime`),ze($e,"for",`query-${e(P).code??""}-note`),ze(Xe,"id",`query-${e(P).code??""}-note`)}),ot(Be,()=>e(S)[e(P).code].polytime,ye=>e(S)[e(P).code].polytime=ye),Pe(Xe,()=>e(S)[e(P).code].note,ye=>e(S)[e(P).code].note=ye),m(ne,De)};U(ke,ne=>{e(S)[e(P).code]&&ne(ve)})}m(Q,Fe)}),n(Me),n(Te);var Oe=o(Te,2),K=o(i(Oe),2);de(K,21,()=>t.transformations,ue,(Q,P)=>{var Fe=Ve(),ke=Ke(Fe);{var ve=ne=>{var De=Nr(),Re=i(De),je=i(Re),Ce=i(je),nt=i(Ce,!0);n(Ce);var Be=o(Ce,2);de(Be,21,()=>t.polytimeOptions,ue,(ye,Ae)=>{var Le=Dr(),qe=i(Le,!0);n(Le);var Se={};q(()=>{A(qe,e(Ae).label),Se!==(Se=e(Ae).value)&&(Le.value=(Le.__value=e(Ae).value)??"")}),m(ye,Le)}),n(Be),n(je);var Ze=o(je,2),$e=i(Ze),Xe=o($e,2);Ye(Xe),n(Ze),n(Re);var st=o(Re,2);{var lt=ye=>{var Ae=Or();de(Ae,21,v,ue,(Le,qe)=>{var Se=Lr();Se.__click=[Ar,B,P,qe];var dt=i(Se,!0);n(Se),q(ut=>{Ue(Se,1,ut),A(dt,e(qe))},[()=>`px-2 py-0.5 text-xs rounded ${e(D)[e(P).code].refs.includes(e(qe))?"bg-green-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`]),m(Le,Se)}),n(Ae),m(ye,Ae)};U(st,ye=>{v().length>0&&ye(lt)})}n(De),q(()=>{ze(Ce,"for",`transform-${e(P).code??""}-polytime`),A(nt,e(P).name),ze(Be,"id",`transform-${e(P).code??""}-polytime`),ze($e,"for",`transform-${e(P).code??""}-note`),ze(Xe,"id",`transform-${e(P).code??""}-note`)}),ot(Be,()=>e(D)[e(P).code].polytime,ye=>e(D)[e(P).code].polytime=ye),Pe(Xe,()=>e(D)[e(P).code].note,ye=>e(D)[e(P).code].note=ye),m(ne,De)};U(ke,ne=>{e(D)[e(P).code]&&ne(ve)})}m(Q,Fe)}),n(K),n(Oe);var Z=o(Oe,2);{var V=Q=>{var P=Cr(),Fe=o(i(P),2);de(Fe,21,()=>t.existingTags,ue,(ke,ve)=>{var ne=jr();ne.__click=[Mr,ie,ve];var De=i(ne,!0);n(ne),q((Re,je)=>{Ue(ne,1,Re),fr(ne,`background-color: ${e(ve).color??""}; color: white; ${je??""}`),A(De,e(ve).label)},[()=>`px-3 py-1 rounded-full text-sm font-medium transition-all ${e(u).some(Re=>Re.label===e(ve).label)?"ring-2 ring-offset-2":"opacity-60 hover:opacity-100"}`,()=>e(u).some(Re=>Re.label===e(ve).label)?`ring-color: ${e(ve).color};`:""]),m(ke,ne)}),n(Fe),n(P),m(Q,P)};U(Z,Q=>{t.existingTags.length>0&&Q(V)})}var we=o(Z,2),$=i(we);$.__click=[la,E,t];var le=o($,2);le.__click=[_r,y,p,f,_,t,x,S,D,u,g,E];var Ee=i(le);n(le),n(we),n(W),n(I),n(c),q(Q=>{A(X,`${b()?"Edit":"Add New"} Language`),le.disabled=Q,A(Ee,`${b()?"Update":"Add"} Language`)},[()=>!e(y).trim()||!e(p).trim()||!e(f).trim()]),Pe(he,()=>e(y),Q=>r(y,Q)),Pe(Y,()=>e(p),Q=>r(p,Q)),Pe(me,()=>e(f),Q=>r(f,Q)),m(R,c)};U(J,R=>{d()&&R(z)})}m(l,H),Ge()}rt(["click"]);function Pr(l,t,d,v){e(t).trim()&&(d.onAdd(e(t).trim()),r(t,""),v(!1))}function ua(l,t,d,v){t()||r(d,""),v.onClose()}var Qr=l=>l.stopPropagation(),Ur=w('<div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"><div class="bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto"><div class="bg-gradient-to-r from-purple-600 to-purple-700 px-6 py-4"><h2 class="text-2xl font-bold text-white"> </h2> <p class="text-purple-100 mt-1"> </p></div> <div class="p-6 space-y-4"><div><label for="bibtex-input" class="block text-sm font-medium text-gray-700 mb-2">BibTeX Entry <span class="text-red-500">*</span></label> <textarea id="bibtex-input" rows="8" class="w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 font-mono text-sm"></textarea> <p class="text-xs text-gray-500 mt-1">Paste a complete BibTeX entry.</p></div> <div class="flex gap-3 justify-end pt-4"><button type="button" class="px-4 py-2 border-2 border-gray-300 text-gray-700 font-medium rounded-lg hover:bg-gray-50 transition-colors">Cancel</button> <button type="button" class="px-4 py-2 bg-purple-600 text-white font-medium rounded-lg hover:bg-purple-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors"> </button></div></div></div></div>');function Br(l,t){He(t,!0);let d=be(t,"isOpen",15,!1),v=be(t,"initialValue",3,""),b=be(t,"isEditMode",3,!1),y=F(Ie(v()));Qe(()=>{d()&&v()&&r(y,v())});const p=`@article{Darwiche_2002,
  title={A Knowledge Compilation Map},
  author={Darwiche, Adnan and Marquis, Pierre},
  journal={Journal of AI Research},
  year={2002}
}`;var f=Ve(),x=Ke(f);{var S=D=>{var u=Ur();u.__click=[ua,b,y,t];var g=i(u);g.__click=[Qr];var _=i(g),E=i(_),N=i(E,!0);n(E);var ie=o(E,2),ae=i(ie,!0);n(ie),n(_);var B=o(_,2),L=i(B),G=o(i(L),2);bt(G),ze(G,"placeholder",p),at(2),n(L);var H=o(L,2),J=i(H);J.__click=[ua,b,y,t];var z=o(J,2);z.__click=[Pr,y,t,d];var R=i(z,!0);n(z),n(H),n(B),n(g),n(u),q(c=>{A(N,b()?"Edit Reference":"Add New Reference"),A(ae,b()?"Update BibTeX citation":"Paste BibTeX citation"),z.disabled=c,A(R,b()?"Update Reference":"Add Reference")},[()=>!e(y).trim()]),Pe(G,()=>e(y),c=>r(y,c)),m(D,u)};U(x,D=>{d()&&D(S)})}m(l,f),Ge()}rt(["click"]);function zr(l,t,d,v,b,y,p,f,x){!e(t).trim()||!e(d).trim()||(v.onAdd({shortName:e(t).trim(),name:e(d).trim(),description:e(b).trim(),refs:e(y)}),p()||f(),x(!1))}function ca(l,t,d,v){t()||d(),v.onClose()}var Kr=l=>l.stopPropagation(),Vr=(l,t,d)=>t(e(d)),Hr=w('<button type="button"> </button>'),Gr=w('<fieldset><legend class="block text-sm font-medium text-gray-700 mb-2">References</legend> <div class="flex flex-wrap gap-2"></div></fieldset>'),Xr=w('<div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"><div class="bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto"><div class="bg-gradient-to-r from-orange-600 to-orange-700 px-6 py-4"><h2 class="text-2xl font-bold text-white"> </h2> <p class="text-orange-100 mt-1"> </p></div> <div class="p-6 space-y-4"><div><label for="sf-shortName" class="block text-sm font-medium text-gray-700 mb-2">Short Name <span class="text-red-500">*</span></label> <input id="sf-shortName" type="text" placeholder="e.g., Clique" class="w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"/> <p class="text-xs text-gray-500 mt-1">Brief label displayed on edges (e.g., "Clique", "PI")</p></div> <div><label for="sf-name" class="block text-sm font-medium text-gray-700 mb-2">Full Name <span class="text-red-500">*</span></label> <input id="sf-name" type="text" placeholder="e.g., Clique Detection Instances" class="w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"/> <p class="text-xs text-gray-500 mt-1">Full human-readable name</p></div> <div><label for="sf-description" class="block text-sm font-medium text-gray-700 mb-2">Description</label> <textarea id="sf-description" rows="3" placeholder="Describe what this function separates..." class="w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 resize-y"></textarea></div> <!> <div class="flex gap-3 justify-end pt-4"><button type="button" class="px-4 py-2 border-2 border-gray-300 text-gray-700 font-medium rounded-lg hover:bg-gray-50 transition-colors">Cancel</button> <button type="button" class="px-4 py-2 bg-orange-600 text-white font-medium rounded-lg hover:bg-orange-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors"> </button></div></div></div></div>');function Jr(l,t){He(t,!0);let d=be(t,"isOpen",15,!1),v=be(t,"availableRefs",19,()=>[]),b=be(t,"isEditMode",3,!1),y=F(""),p=F(""),f=F(""),x=F(Ie([]));Qe(()=>{d()&&t.initialValue&&(r(y,t.initialValue.shortName,!0),r(p,t.initialValue.name,!0),r(f,t.initialValue.description,!0),r(x,[...t.initialValue.refs],!0))});function S(){r(y,""),r(p,""),r(f,""),r(x,[],!0)}function D(E){e(x).includes(E)?r(x,e(x).filter(N=>N!==E),!0):r(x,[...e(x),E],!0)}var u=Ve(),g=Ke(u);{var _=E=>{var N=Xr();N.__click=[ca,b,S,t];var ie=i(N);ie.__click=[Kr];var ae=i(ie),B=i(ae),L=i(B,!0);n(B);var G=o(B,2),H=i(G,!0);n(G),n(ae);var J=o(ae,2),z=i(J),R=o(i(z),2);Ye(R),at(2),n(z);var c=o(z,2),I=o(i(c),2);Ye(I),at(2),n(c);var C=o(c,2),O=o(i(C),2);bt(O),n(C);var X=o(C,2);{var W=te=>{var he=Gr(),oe=o(i(he),2);de(oe,21,v,ue,(Y,se)=>{var me=Hr();me.__click=[Vr,D,se];var _e=i(me,!0);n(me),q(Ne=>{Ue(me,1,Ne),A(_e,e(se))},[()=>`px-3 py-1 text-sm rounded-lg border-2 transition-colors ${e(x).includes(e(se))?"bg-orange-600 text-white border-orange-600":"bg-white text-gray-700 border-gray-300 hover:border-orange-300"}`]),m(Y,me)}),n(oe),n(he),m(te,he)};U(X,te=>{v().length>0&&te(W)})}var re=o(X,2),ce=i(re);ce.__click=[ca,b,S,t];var ge=o(ce,2);ge.__click=[zr,y,p,t,f,x,b,S,d];var pe=i(ge,!0);n(ge),n(re),n(J),n(ie),n(N),q(te=>{A(L,b()?"Edit Separating Function":"Add New Separating Function"),A(H,b()?"Update separating function details":"Define a new separating function"),ge.disabled=te,A(pe,b()?"Update Function":"Add Function")},[()=>!e(y).trim()||!e(p).trim()]),Pe(R,()=>e(y),te=>r(y,te)),Pe(I,()=>e(p),te=>r(p,te)),Pe(O,()=>e(f),te=>r(f,te)),m(E,N)};U(g,E=>{d()&&E(_)})}m(l,u),Ge()}rt(["click"]);function Wr(l,t,d,v,b,y,p,f,x,S){!e(t)||!e(d)||!e(v)||e(t)===e(d)||(b.onSave({sourceId:e(t),targetId:e(d),status:e(v),description:e(y)||void 0,refs:e(p),separatingFunctionIds:e(f).length>0?e(f):void 0}),x(),S(!1))}function ga(l,t,d){t(),d.onClose()}var Yr=l=>l.stopPropagation(),Zr=w("<option> </option>"),$r=w("<option> </option>"),en=w("<option> </option>"),tn=w('<p class="text-xs text-gray-500 mt-1"> </p>'),an=(l,t,d)=>t(e(d)),rn=w('<button type="button"> </button>'),nn=w('<fieldset><legend class="block text-sm font-medium text-gray-700 mb-2">References</legend> <div class="flex flex-wrap gap-2"></div></fieldset>'),on=(l,t,d)=>t(e(d).shortName),sn=w('<button type="button"> </button>'),ln=w('<p class="text-xs text-gray-500 mt-2"> </p>'),dn=w('<fieldset class="border-t pt-4"><legend class="block text-sm font-medium text-gray-700 mb-2">Separating Functions (optional)</legend> <div class="flex flex-wrap gap-2"></div> <!></fieldset>'),un=w('<div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"><div class="bg-white rounded-xl shadow-2xl max-w-3xl w-full max-h-[90vh] overflow-y-auto"><div class="bg-gradient-to-r from-blue-600 to-blue-700 px-6 py-4 sticky top-0 z-10"><h2 class="text-2xl font-bold text-white">Manage Relationship</h2> <p class="text-blue-100 mt-1">Add or update transformation relationships</p></div> <div class="p-6 space-y-4"><div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div><label for="rel-source" class="block text-sm font-medium text-gray-700 mb-1">Source Language <span class="text-red-500">*</span></label> <select id="rel-source" class="w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"><option>Select source...</option><!></select></div> <div><label for="rel-target" class="block text-sm font-medium text-gray-700 mb-1">Target Language <span class="text-red-500">*</span></label> <select id="rel-target" class="w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"><option>Select target...</option><!></select></div></div> <div><label for="rel-status" class="block text-sm font-medium text-gray-700 mb-1">Classification <span class="text-red-500">*</span></label> <select id="rel-status" class="w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"><option>Select classification...</option><!></select> <!></div> <div><label for="rel-description" class="block text-sm font-medium text-gray-700 mb-1">Description</label> <textarea id="rel-description" rows="3" class="w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-y" placeholder="Describe this transformation relationship (optional)..."></textarea></div> <!> <!> <div class="flex gap-3 justify-end pt-4 border-t"><button type="button" class="px-4 py-2 border-2 border-gray-300 text-gray-700 font-medium rounded-lg hover:bg-gray-50 transition-colors">Cancel</button> <button type="button" class="px-4 py-2 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors">Save Relationship</button></div></div></div></div>');function cn(l,t){He(t,!0);let d=be(t,"isOpen",15,!1),v=be(t,"availableRefs",19,()=>[]),b=be(t,"availableSeparatingFunctions",19,()=>[]),y=be(t,"baselineRelations",19,()=>new Map),p=F(""),f=F(""),x=F(""),S=F(""),D=F(Ie([])),u=F(Ie([]));Qe(()=>{d()&&t.initialData&&(r(p,t.initialData.sourceId,!0),r(f,t.initialData.targetId,!0),r(x,t.initialData.status,!0),r(S,t.initialData.description||"",!0),r(D,[...t.initialData.refs],!0),t.initialData.separatingFunctionIds?r(u,[...t.initialData.separatingFunctionIds],!0):t.initialData.separatingFunctions?r(u,t.initialData.separatingFunctions.map(B=>B.shortName),!0):r(u,[],!0))}),Qe(()=>{if(e(p)&&e(f)&&e(p)!==e(f)){const B=`${e(p)}->${e(f)}`,L=y().get(B);L&&(r(x,L.status,!0),r(D,[...L.refs],!0),L.separatingFunctionIds?r(u,[...L.separatingFunctionIds],!0):L.separatingFunctions?r(u,L.separatingFunctions.map(G=>G.shortName),!0):r(u,[],!0))}});function g(){r(p,""),r(f,""),r(x,""),r(S,""),r(D,[],!0),r(u,[],!0)}function _(B){e(D).includes(B)?r(D,e(D).filter(L=>L!==B),!0):r(D,[...e(D),B],!0)}function E(B){e(u).includes(B)?r(u,e(u).filter(L=>L!==B),!0):r(u,[...e(u),B],!0)}var N=Ve(),ie=Ke(N);{var ae=B=>{var L=un();L.__click=[ga,g,t];var G=i(L);G.__click=[Yr];var H=o(i(G),2),J=i(H),z=i(J),R=o(i(z),2),c=i(R);c.value=c.__value="";var I=o(c);de(I,17,()=>t.languages,ue,(K,Z)=>{var V=Zr(),we=i(V,!0);n(V);var $={};q(()=>{A(we,e(Z).name),$!==($=e(Z).name)&&(V.value=(V.__value=e(Z).name)??"")}),m(K,V)}),n(R),n(z);var C=o(z,2),O=o(i(C),2),X=i(O);X.value=X.__value="";var W=o(X);de(W,17,()=>t.languages,ue,(K,Z)=>{var V=$r(),we=i(V,!0);n(V);var $={};q(()=>{V.disabled=e(Z).name===e(p),A(we,e(Z).name),$!==($=e(Z).name)&&(V.value=(V.__value=e(Z).name)??"")}),m(K,V)}),n(O),n(C),n(J);var re=o(J,2),ce=o(i(re),2),ge=i(ce);ge.value=ge.__value="";var pe=o(ge);de(pe,17,()=>t.statusOptions,ue,(K,Z)=>{var V=en(),we=i(V,!0);n(V);var $={};q(()=>{A(we,e(Z).label),$!==($=e(Z).value)&&(V.value=(V.__value=e(Z).value)??"")}),m(K,V)}),n(ce);var te=o(ce,2);{var he=K=>{const Z=j(()=>t.statusOptions.find(le=>le.value===e(x)));var V=Ve(),we=Ke(V);{var $=le=>{var Ee=tn(),Q=i(Ee,!0);n(Ee),q(()=>A(Q,e(Z).description)),m(le,Ee)};U(we,le=>{e(Z)&&le($)})}m(K,V)};U(te,K=>{e(x)&&K(he)})}n(re);var oe=o(re,2),Y=o(i(oe),2);bt(Y),n(oe);var se=o(oe,2);{var me=K=>{var Z=nn(),V=o(i(Z),2);de(V,21,v,ue,(we,$)=>{var le=rn();le.__click=[an,_,$];var Ee=i(le,!0);n(le),q(Q=>{Ue(le,1,Q),A(Ee,e($))},[()=>`px-3 py-1 text-sm rounded-lg border-2 transition-colors ${e(D).includes(e($))?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-300 hover:border-blue-300"}`]),m(we,le)}),n(V),n(Z),m(K,Z)};U(se,K=>{v().length>0&&K(me)})}var _e=o(se,2);{var Ne=K=>{var Z=dn(),V=o(i(Z),2);de(V,21,b,ue,(le,Ee)=>{var Q=sn();Q.__click=[on,E,Ee];var P=i(Q,!0);n(Q),q(Fe=>{Ue(Q,1,Fe),ze(Q,"title",e(Ee).name),A(P,e(Ee).shortName)},[()=>`px-3 py-1 text-sm rounded-lg border-2 transition-colors ${e(u).includes(e(Ee).shortName)?"bg-orange-600 text-white border-orange-600":"bg-white text-gray-700 border-gray-300 hover:border-orange-300"}`]),m(le,Q)}),n(V);var we=o(V,2);{var $=le=>{var Ee=ln(),Q=i(Ee);n(Ee),q(P=>A(Q,`Selected: ${P??""}`),[()=>e(u).join(", ")]),m(le,Ee)};U(we,le=>{e(u).length>0&&le($)})}n(Z),m(K,Z)};U(_e,K=>{b().length>0&&K(Ne)})}var Te=o(_e,2),Me=i(Te);Me.__click=[ga,g,t];var Oe=o(Me,2);Oe.__click=[Wr,p,f,x,t,S,D,u,g,d],n(Te),n(H),n(G),n(L),q(()=>Oe.disabled=!e(p)||!e(f)||!e(x)||e(p)===e(f)),ot(R,()=>e(p),K=>r(p,K)),ot(O,()=>e(f),K=>r(f,K)),ot(ce,()=>e(x),K=>r(x,K)),Pe(Y,()=>e(S),K=>r(S,K)),m(B,L)};U(ie,B=>{d()&&B(ae)})}m(l,N),Ge()}rt(["click"]);var gn=w('<span class="text-sm font-bold text-gray-900"> </span>'),vn=w('<span class="text-sm text-gray-600">( <!> )</span>'),fn=(l,t)=>t.onToggleExpand(t.index),bn=(l,t)=>t.onEdit(t.index),mn=(l,t)=>t.onDelete(t.index),xn=w("<div><!></div>"),pn=w('<div><div class="flex items-center justify-between"><div class="flex items-center gap-2"><span> </span> <!> <!></div> <div class="flex items-center gap-2"><button type="button"> </button> <button type="button" class="px-2 py-1 text-xs bg-blue-100 hover:bg-blue-200 text-blue-800 rounded border border-blue-300" aria-label="Edit">Edit</button> <button type="button" class="px-2 py-1 text-xs bg-red-100 hover:bg-red-200 text-red-800 rounded border border-red-300" aria-label="Delete">Delete</button></div></div> <!></div>');function yt(l,t){He(t,!0);let d=be(t,"colorScheme",3,"purple"),v=be(t,"isExpanded",3,!1),b=be(t,"renderMathTitle",3,!0),y=be(t,"renderMathSubtitle",3,!0);const f={purple:{border:"border-purple-300",bg:"bg-purple-50",text:"text-purple-800",button:"bg-purple-100 hover:bg-purple-200 text-purple-800 border-purple-300",divider:"border-purple-200"},orange:{border:"border-orange-300",bg:"bg-orange-50",text:"text-orange-800",button:"bg-orange-100 hover:bg-orange-200 text-orange-800 border-orange-300",divider:"border-orange-200"},green:{border:"border-green-300",bg:"bg-green-50",text:"text-green-800",button:"bg-green-100 hover:bg-green-200 text-green-800 border-green-300",divider:"border-green-200"},yellow:{border:"border-yellow-300",bg:"bg-yellow-50",text:"text-yellow-800",button:"bg-yellow-100 hover:bg-yellow-200 text-yellow-800 border-yellow-300",divider:"border-yellow-200"},blue:{border:"border-blue-300",bg:"bg-blue-50",text:"text-blue-800",button:"bg-blue-100 hover:bg-blue-200 text-blue-800 border-blue-300",divider:"border-blue-200"}}[d()];var x=pn(),S=i(x),D=i(S),u=i(D),g=i(u);n(u);var _=o(u,2);{var E=c=>{We(c,{get text(){return t.title},className:"text-sm font-bold text-gray-900"})},N=c=>{var I=gn(),C=i(I,!0);n(I),q(()=>A(C,t.title)),m(c,I)};U(_,c=>{b()?c(E):c(N,!1)})}var ie=o(_,2);{var ae=c=>{var I=vn(),C=o(i(I));{var O=W=>{We(W,{get text(){return t.subtitle},className:"inline"})},X=W=>{var re=dr();q(()=>A(re,t.subtitle)),m(W,re)};U(C,W=>{y()?W(O):W(X,!1)})}at(),n(I),m(c,I)};U(ie,c=>{t.subtitle&&c(ae)})}n(D);var B=o(D,2),L=i(B);L.__click=[fn,t];var G=i(L,!0);n(L);var H=o(L,2);H.__click=[bn,t];var J=o(H,2);J.__click=[mn,t],n(B),n(S);var z=o(S,2);{var R=c=>{var I=xn(),C=i(I);{var O=X=>{var W=Ve(),re=Ke(W);ur(re,()=>t.children),m(X,W)};U(C,X=>{t.children&&X(O)})}n(I),q(()=>Ue(I,1,`mt-4 pt-4 border-t ${f.divider??""}`)),m(c,I)};U(z,c=>{v()&&c(R)})}n(x),q(()=>{Ue(x,1,`border-2 ${f.border??""} ${f.bg??""} rounded-lg p-3`),Ue(u,1,`text-sm font-semibold ${f.text??""}`),A(g,`${t.type??""}:`),Ue(L,1,`px-2 py-1 text-xs ${f.button??""} rounded border`),ze(L,"aria-label",v()?"Collapse":"Expand"),A(G,v()?"Collapse":"Expand")}),m(l,x),Ge()}rt(["click"]);var _n=w('<div class="text-gray-500 text-xs"> </div>'),yn=w('<div class="bg-white p-2 rounded border"><div class="font-medium"> </div> <div class="text-gray-600"> </div> <!> <!></div>'),hn=w('<div><div class="font-semibold text-gray-700 mb-1"> </div> <div class="grid grid-cols-2 gap-2"></div></div>'),wn=w('<div class="text-gray-500 text-xs"> </div>'),En=w('<div class="bg-white p-2 rounded border"><div class="font-medium"> </div> <div class="text-gray-600"> </div> <!> <!></div>'),kn=w('<div><div class="font-semibold text-gray-700 mb-1"> </div> <div class="grid grid-cols-2 gap-2"></div></div>'),Rn=w('<div class="bg-white p-2 rounded border"><div class="font-medium"> </div> <div class="text-gray-600"> </div></div>'),Sn=w('<div><div class="font-semibold text-gray-700 mb-1"> </div> <div class="space-y-2"></div></div>'),In=w('<div class="space-y-3 text-xs"><div><div class="font-semibold text-gray-700 mb-1">Full Name:</div> <!></div> <div><div class="font-semibold text-gray-700 mb-1">Description:</div> <!></div> <!> <!> <!></div>');function va(l,t){He(t,!0);let d=be(t,"isExpanded",3,!1),v=be(t,"isEdit",3,!1);const b=v()?"yellow":"green";{const y=f=>{var x=In(),S=i(x),D=o(i(S),2);We(D,{get text(){return t.language.fullName},className:"text-gray-900 block"}),n(S);var u=o(S,2),g=o(i(u),2);We(g,{get text(){return t.language.description},className:"text-gray-900 block"}),n(u);var _=o(u,2);{var E=L=>{var G=hn(),H=i(G),J=i(H);n(H);var z=o(H,2);de(z,21,()=>Object.entries(t.language.queries),ue,(R,c)=>{var I=j(()=>sa(e(c),2));let C=()=>e(I)[0],O=()=>e(I)[1];var X=yn(),W=i(X),re=i(W,!0);n(W);var ce=o(W,2),ge=i(ce,!0);n(ce);var pe=o(ce,2);{var te=Y=>{We(Y,{get text(){return O().note},className:"text-gray-500 italic text-xs block"})};U(pe,Y=>{O().note&&Y(te)})}var he=o(pe,2);{var oe=Y=>{var se=_n(),me=i(se);n(se),q(_e=>A(me,`Refs: [${_e??""}]`),[()=>O().refs.join(", ")]),m(Y,se)};U(he,Y=>{O().refs.length>0&&Y(oe)})}n(X),q(()=>{A(re,C()),A(ge,O().polytime)}),m(R,X)}),n(z),n(G),q(R=>A(J,`Query Support (${R??""}):`),[()=>Object.keys(t.language.queries).length]),m(L,G)};U(_,L=>{t.language.queries&&Object.keys(t.language.queries).length>0&&L(E)})}var N=o(_,2);{var ie=L=>{var G=kn(),H=i(G),J=i(H);n(H);var z=o(H,2);de(z,21,()=>Object.entries(t.language.transformations),ue,(R,c)=>{var I=j(()=>sa(e(c),2));let C=()=>e(I)[0],O=()=>e(I)[1];var X=En(),W=i(X),re=i(W,!0);n(W);var ce=o(W,2),ge=i(ce,!0);n(ce);var pe=o(ce,2);{var te=Y=>{We(Y,{get text(){return O().note},className:"text-gray-500 italic text-xs block"})};U(pe,Y=>{O().note&&Y(te)})}var he=o(pe,2);{var oe=Y=>{var se=wn(),me=i(se);n(se),q(_e=>A(me,`Refs: [${_e??""}]`),[()=>O().refs.join(", ")]),m(Y,se)};U(he,Y=>{O().refs.length>0&&Y(oe)})}n(X),q(()=>{A(re,C()),A(ge,O().polytime)}),m(R,X)}),n(z),n(G),q(R=>A(J,`Transformation Support (${R??""}):`),[()=>Object.keys(t.language.transformations).length]),m(L,G)};U(N,L=>{t.language.transformations&&Object.keys(t.language.transformations).length>0&&L(ie)})}var ae=o(N,2);{var B=L=>{var G=Sn(),H=i(G),J=i(H);n(H);var z=o(H,2);de(z,21,()=>t.language.tags,ue,(R,c)=>{var I=Rn(),C=i(I),O=i(C,!0);n(C);var X=o(C,2),W=i(X,!0);n(X),n(I),q(()=>{A(O,e(c).label),A(W,e(c).description||"No description")}),m(R,I)}),n(z),n(G),q(()=>A(J,`Tags (${t.language.tags.length??""}):`)),m(L,G)};U(ae,L=>{t.language.tags.length>0&&L(B)})}n(x),m(f,x)};let p=j(()=>v()?"Edit Language":"New Language");yt(l,{get type(){return e(p)},get title(){return t.language.name},get subtitle(){return t.language.description},get colorScheme(){return b},get index(){return t.index},get isExpanded(){return d()},get onToggleExpand(){return t.onToggleExpand},get onEdit(){return t.onEdit},get onDelete(){return t.onDelete},children:y,$$slots:{default:!0}})}Ge()}var Tn=w('<pre class="text-xs bg-white p-2 rounded border border-purple-200 overflow-x-auto"> </pre>');function Fn(l,t){let d=be(t,"isExpanded",3,!1);yt(l,{type:"Reference",get title(){return`new-${t.index??""}`},renderMathTitle:!1,renderMathSubtitle:!1,colorScheme:"purple",get index(){return t.index},get isExpanded(){return d()},get onToggleExpand(){return t.onToggleExpand},get onEdit(){return t.onEdit},get onDelete(){return t.onDelete},children:b=>{var y=Tn(),p=i(y,!0);n(y),q(()=>A(p,t.reference)),m(b,y)},$$slots:{default:!0}})}var Dn=w('<div><span class="text-xs font-semibold text-gray-700">Description:</span> <!></div>'),An=w('<div><span class="text-xs font-semibold text-gray-700">References:</span> <span class="text-xs text-gray-600 ml-2"> </span></div>'),Ln=w('<div class="space-y-2"><div><span class="text-xs font-semibold text-gray-700">Short Name:</span> <!></div> <div><span class="text-xs font-semibold text-gray-700">Full Name:</span> <!></div> <!> <!></div>');function On(l,t){He(t,!0),yt(l,{type:"SF",get title(){return t.separatingFunction.shortName},get subtitle(){return t.separatingFunction.name},colorScheme:"orange",get index(){return t.index},get isExpanded(){return t.isExpanded},get onToggleExpand(){return t.onToggleExpand},get onEdit(){return t.onEdit},get onDelete(){return t.onDelete},children:v=>{var b=Ln(),y=i(b),p=o(i(y),2);We(p,{get text(){return t.separatingFunction.shortName},className:"text-xs text-gray-900 ml-2 inline"}),n(y);var f=o(y,2),x=o(i(f),2);We(x,{get text(){return t.separatingFunction.name},className:"text-xs text-gray-900 ml-2 inline"}),n(f);var S=o(f,2);{var D=_=>{var E=Dn(),N=o(i(E),2);We(N,{get text(){return t.separatingFunction.description},className:"text-xs text-gray-700 mt-1 block"}),n(E),m(_,E)};U(S,_=>{t.separatingFunction.description&&_(D)})}var u=o(S,2);{var g=_=>{var E=An(),N=o(i(E),2),ie=i(N,!0);n(N),n(E),q(ae=>A(ie,ae),[()=>t.separatingFunction.refs.join(", ")]),m(_,E)};U(u,_=>{t.separatingFunction.refs&&t.separatingFunction.refs.length>0&&_(g)})}n(b),m(v,b)},$$slots:{default:!0}}),Ge()}var Nn=w('<div class="text-gray-500 text-xs mt-1"> </div>'),Mn=w('<div class="bg-white p-2 rounded border"><div class="font-medium"> </div> <div class="text-gray-600 text-xs"> </div> <div class="text-gray-500 italic text-xs"> </div> <!></div>'),jn=w('<div><div class="font-semibold text-gray-700 mb-1"> </div> <div class="space-y-2"></div></div>'),Cn=w('<div><div class="font-semibold text-gray-700 mb-1">References:</div> <div class="text-gray-600"> </div></div>'),qn=w('<div class="space-y-3 text-xs"><div><div class="font-semibold text-gray-700 mb-1">Transformation Status:</div> <div class="bg-white p-2 rounded border"><span class="font-mono text-gray-900"> </span></div></div> <!> <!></div>');function Pn(l,t){He(t,!0);let d=be(t,"isExpanded",3,!1),v=be(t,"isModified",3,!1);const b=tt(t.relationship.sourceId,t.relationship.targetId),y=`${t.relationship.sourceId} → ${t.relationship.targetId}`;var p=Ve(),f=Ke(p);{var x=S=>{yt(S,{type:"Relationship",get title(){return y},get subtitle(){return t.relationship.status},colorScheme:"blue",get index(){return t.index},get isExpanded(){return d()},get onToggleExpand(){return t.onToggleExpand},onEdit:()=>t.onEdit(t.index),onDelete:()=>t.onDelete(t.index,b),children:u=>{var g=qn(),_=i(g),E=o(i(_),2),N=i(E),ie=i(N,!0);n(N),n(E),n(_);var ae=o(_,2);{var B=H=>{var J=jn(),z=i(J),R=i(z);n(z);var c=o(z,2);de(c,21,()=>t.relationship.separatingFunctions,ue,(I,C)=>{var O=Mn(),X=i(O),W=i(X,!0);n(X);var re=o(X,2),ce=i(re);n(re);var ge=o(re,2),pe=i(ge,!0);n(ge);var te=o(ge,2);{var he=oe=>{var Y=Nn(),se=i(Y);n(Y),q(me=>A(se,`Refs: [${me??""}]`),[()=>e(C).refs.join(", ")]),m(oe,Y)};U(te,oe=>{e(C).refs&&e(C).refs.length>0&&oe(he)})}n(O),q(()=>{A(W,e(C).name),A(ce,`Short: ${e(C).shortName??""}`),A(pe,e(C).description)}),m(I,O)}),n(c),n(J),q(()=>A(R,`Separating Functions (${t.relationship.separatingFunctions.length??""}):`)),m(H,J)};U(ae,H=>{t.relationship.separatingFunctions&&t.relationship.separatingFunctions.length>0&&H(B)})}var L=o(ae,2);{var G=H=>{var J=Cn(),z=o(i(J),2),R=i(z,!0);n(z),n(J),q(c=>A(R,c),[()=>t.relationship.refs.join(", ")]),m(H,J)};U(L,H=>{t.relationship.refs&&t.relationship.refs.length>0&&H(G)})}n(g),q(()=>A(ie,t.relationship.status)),m(u,g)},$$slots:{default:!0}})};U(f,S=>{v()&&S(x)})}m(l,p),Ge()}var Qn=w('<div class="text-center py-8 text-gray-500 italic">No changes queued yet. Use the buttons below to add items.</div>'),Un=w(`<div class="space-y-3"><h2 class="text-lg font-bold text-gray-900">Queued Changes</h2> <p class="text-sm text-gray-600">Items you've added will appear here.</p> <div class="space-y-2"><!> <!> <!> <!> <!> <!></div></div>`);function Bn(l,t){He(t,!0);const d=j(()=>t.languagesToAdd.length>0||t.languagesToEdit.length>0||t.newReferences.length>0||t.newSeparatingFunctions.length>0||t.relationships.filter(g=>t.modifiedRelations.has(tt(g.sourceId,g.targetId))).length>0);var v=Un(),b=o(i(v),4),y=i(b);de(y,17,()=>t.newReferences,ue,(g,_,E)=>{{let N=j(()=>t.expandedReferenceIndex===E);Fn(g,{get reference(){return e(_)},index:E,get isExpanded(){return e(N)},get onToggleExpand(){return t.onToggleExpandReference},get onEdit(){return t.onEditReference},get onDelete(){return t.onDeleteReference}})}});var p=o(y,2);de(p,17,()=>t.newSeparatingFunctions,ue,(g,_,E)=>{{let N=j(()=>t.expandedSeparatingFunctionIndex===E);On(g,{get separatingFunction(){return e(_)},index:E,get isExpanded(){return e(N)},get onToggleExpand(){return t.onToggleExpandSeparatingFunction},get onEdit(){return t.onEditSeparatingFunction},get onDelete(){return t.onDeleteSeparatingFunction}})}});var f=o(p,2);de(f,17,()=>t.languagesToAdd,ue,(g,_,E)=>{{let N=j(()=>t.expandedLanguageToAddIndex===E);va(g,{get language(){return e(_)},index:E,get isExpanded(){return e(N)},isEdit:!1,get onToggleExpand(){return t.onToggleExpandLanguageToAdd},get onEdit(){return t.onEditLanguageToAdd},get onDelete(){return t.onDeleteLanguageToAdd}})}});var x=o(f,2);de(x,17,()=>t.languagesToEdit,ue,(g,_,E)=>{{let N=j(()=>t.expandedLanguageToEditIndex===E);va(g,{get language(){return e(_)},index:E,get isExpanded(){return e(N)},isEdit:!0,get onToggleExpand(){return t.onToggleExpandLanguageToEdit},get onEdit(){return t.onEditLanguageToEdit},get onDelete(){return t.onDeleteLanguageToEdit}})}});var S=o(x,2);de(S,17,()=>t.relationships,ue,(g,_,E)=>{const N=j(()=>t.modifiedRelations.has(tt(e(_).sourceId,e(_).targetId)));{let ie=j(()=>t.expandedRelationshipIndex===E);Pn(g,{get relationship(){return e(_)},index:E,get isModified(){return e(N)},get isExpanded(){return e(ie)},get onToggleExpand(){return t.onToggleExpandRelationship},get onEdit(){return t.onEditRelationship},get onDelete(){return t.onDeleteRelationship}})}});var D=o(S,2);{var u=g=>{var _=Qn();m(g,_)};U(D,g=>{e(d)||g(u)})}n(b),n(v),m(l,v),Ge()}var zn=w('<div class="grid grid-cols-2 md:grid-cols-5 gap-3"><button type="button" class="px-3 py-3 bg-green-600 hover:bg-green-700 text-white font-medium rounded-lg transition-colors">New Language</button> <button type="button" class="px-3 py-3 bg-yellow-600 hover:bg-yellow-700 text-white font-medium rounded-lg transition-colors">Edit Language</button> <button type="button" class="px-3 py-3 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors">Relationship</button> <button type="button" class="px-3 py-3 bg-purple-600 hover:bg-purple-700 text-white font-medium rounded-lg transition-colors">Reference</button> <button type="button" class="px-3 py-3 bg-orange-600 hover:bg-orange-700 text-white font-medium rounded-lg transition-colors">Separator</button></div>');function Kn(l,t){var d=zn(),v=i(d);v.__click=function(...x){t.onAddLanguage?.apply(this,x)};var b=o(v,2);b.__click=function(...x){t.onEditLanguage?.apply(this,x)};var y=o(b,2);y.__click=function(...x){t.onManageRelationships?.apply(this,x)};var p=o(y,2);p.__click=function(...x){t.onAddReference?.apply(this,x)};var f=o(p,2);f.__click=function(...x){t.onAddSeparatingFunction?.apply(this,x)},n(d),m(l,d)}rt(["click"]);var Vn=w('<div class="pt-6"><button type="submit" class="group relative w-full px-8 py-4 bg-gradient-to-r from-indigo-600 to-purple-700 text-white font-bold text-lg rounded-xl hover:from-indigo-700 hover:to-purple-800 disabled:from-gray-400 disabled:to-gray-500 disabled:cursor-not-allowed transition-all duration-300 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 active:translate-y-0"><span class="flex items-center justify-center"><svg class="w-5 h-5 mr-2 transition-transform group-hover:scale-110" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path></svg> Preview Changes</span></button> <p class="text-center text-sm text-gray-500 mt-4">Preview your changes on the graph before submitting</p></div>');function Hn(l,t){let d=be(t,"disabled",3,!1);var v=Vn(),b=i(v);at(2),n(v),q(()=>b.disabled=d()),m(l,v)}function Gn(l){const t=l.match(/@\w+\{([^,\s]+)/);return t?t[1]:null}function Mt(l,t){const d=[];for(const v of l.descriptionRefs){const b=t.get(v);b&&d.push(b)}return{name:l.name,fullName:l.fullName,description:l.description,descriptionRefs:[...l.descriptionRefs],properties:{queries:l.queries,transformations:l.transformations},tags:l.tags,references:d}}function Xn(l,t){const d=Ga(l),v=u=>{const{adjacencyMatrix:g}=d;if(u in g.indexByLanguage)return;const _=g.languageIds.length;g.languageIds.push(u),g.indexByLanguage[u]=_;for(const E of g.matrix)E.push(null);g.matrix.push(new Array(_+1).fill(null))},b=new Map;for(const u of d.languages)if(u.references)for(const g of u.references)b.set(g.id,g);const y=new Set(b.keys()),p=new Map;if(d.separatingFunctions)for(const u of d.separatingFunctions)p.set(u.shortName,u);const f=new Set(t.modifiedRelations??[]),x=u=>{const g={shortName:u.shortName,name:u.name,description:u.description,refs:[...u.refs]};p.set(g.shortName,g),d.separatingFunctions=[...d.separatingFunctions??[],g]},S=u=>{v(u.sourceId),v(u.targetId);const g=d.adjacencyMatrix.indexByLanguage[u.sourceId],_=d.adjacencyMatrix.indexByLanguage[u.targetId];if(g===void 0||_===void 0)return;const E=`${u.sourceId}->${u.targetId}`;if(f.size>0&&!f.has(E)&&d.adjacencyMatrix.matrix[g]?.[_])return;const N=[];if(u.separatingFunctionIds&&u.separatingFunctionIds.length>0)for(const ae of u.separatingFunctionIds){const B=p.get(ae);B&&N.push({shortName:B.shortName,name:B.name,description:B.description,refs:[...B.refs]})}else if(u.separatingFunctions)for(const ae of u.separatingFunctions)N.push({shortName:ae.shortName,name:ae.name,description:ae.description,refs:[...ae.refs]});const ie={status:u.status,refs:[...u.refs],separatingFunctions:N};d.adjacencyMatrix.matrix[g][_]=ie};for(const u of t.entries)switch(u.kind){case"reference":{const g=u.payload,_=jt(g,y);y.add(_);const E=Gn(g),N={id:_,title:E||_,href:"",bibtex:g};b.set(_,N);break}case"separator":{x(u.payload);break}case"language:new":{const g=Mt(u.payload,b);d.languages.push(g),v(u.payload.name);break}case"language:edit":{const g=d.languages.findIndex(_=>_.name===u.payload.name);if(g===-1){const _=Mt(u.payload,b);d.languages.push(_),v(u.payload.name)}else d.languages[g]=Mt(u.payload,b);break}case"relationship":{S(u.payload);break}}const D=Xa(d);if(!D.ok){const u=D.errors?.join("; ")??"unknown structural error";throw new Error(`Contribution queue produced an invalid dataset: ${u}`)}return Ja(d)}function fa(l,t,d){const v=!e(t);r(t,v),v&&r(d,Ct(),!0)}function Jn(l,t){r(t,null)}var Wn=w('<div class="mr-auto mb-3 flex items-center gap-3 rounded-lg border border-amber-300 bg-amber-50 px-4 py-2 text-sm text-amber-800 shadow-sm"><span class="font-medium">Editing prior submission</span> <button type="button" class="rounded-md border border-amber-400 px-2 py-1 text-xs font-semibold text-amber-700 transition-colors hover:bg-amber-100">Stop</button></div>'),Yn=w('<p class="text-sm text-gray-500">No saved submissions yet. Submit once to keep a snapshot.</p>'),Zn=w('<div class="text-xs font-medium text-amber-600">Superseded</div>'),$n=w('<div class="text-xs font-medium text-emerald-600">Currently editing clone</div>'),ei=(l,t,d)=>t(e(d)),ti=w('<li class="rounded-md border border-gray-200 bg-white px-3 py-2 shadow-sm"><div class="flex items-start justify-between gap-3"><div class="space-y-1"><div class="text-sm font-medium text-gray-800"> </div> <div class="text-xs text-gray-600"> </div> <!></div> <button type="button" class="rounded-md border border-blue-500 px-3 py-1 text-xs font-semibold text-blue-600 transition-colors hover:bg-blue-50">Load</button></div></li>'),ai=w('<ul class="space-y-3 max-h-64 overflow-y-auto pr-1"></ul>'),ri=w('<div class="mb-6 rounded-lg border border-gray-200 bg-gradient-to-br from-gray-50 to-white p-4 shadow-sm"><div class="mb-3 flex items-center justify-between"><h3 class="text-sm font-semibold text-gray-800">Previous submissions</h3> <button type="button" class="rounded-md px-2 py-1 text-xs font-medium text-gray-500 hover:bg-gray-200/70 hover:text-gray-700">Close</button></div> <!></div>'),ni=(l,t)=>r(t,!1),ii=l=>l.stopPropagation(),oi=w("<option> </option>"),si=(l,t,d)=>{r(t,""),r(d,!1)},li=(l,t,d,v)=>{e(t)&&(r(d,!1),r(v,!0))},di=w('<div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"><div class="bg-white rounded-xl shadow-2xl max-w-md w-full"><div class="bg-gradient-to-r from-yellow-600 to-yellow-700 px-6 py-4"><h2 class="text-2xl font-bold text-white">Select Language to Edit</h2> <p class="text-yellow-100 mt-1">Choose an existing language</p></div> <div class="p-6"><label for="language-selector" class="block text-sm font-medium text-gray-700 mb-2">Language <span class="text-red-500">*</span></label> <select id="language-selector" class="w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-yellow-500"><option>Choose a language...</option><!></select> <div class="flex gap-3 justify-end pt-4 mt-4 border-t"><button type="button" class="px-4 py-2 border-2 border-gray-300 text-gray-700 font-medium rounded-lg hover:bg-gray-50 transition-colors">Cancel</button> <button type="button" class="px-4 py-2 bg-yellow-600 text-white font-medium rounded-lg hover:bg-yellow-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors">Edit</button></div></div></div></div>'),ui=w('<div class="min-h-screen bg-gradient-to-br from-blue-50 via-white to-emerald-50 py-12 px-4 sm:px-6 lg:px-8"><div class="max-w-4xl mx-auto"><div class="text-center mb-12"><h1 class="text-5xl font-extrabold text-gray-900 mb-4 tracking-tight">Contribute to the KC Map</h1> <p class="text-xl text-gray-600 max-w-2xl mx-auto leading-relaxed">Help improve the Knowledge Compilation Map by adding new languages or updating existing ones.</p> <p class="mt-4"><a href="https://github.com/dkahdian/kcm" target="_blank" rel="noopener noreferrer" class="inline-flex items-center gap-2 text-blue-600 hover:text-blue-800 font-medium"><svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"></path></svg> View on GitHub</a></p></div> <div class="bg-white rounded-2xl shadow-2xl overflow-hidden border border-gray-100"><div class="bg-gradient-to-r from-blue-600 to-blue-700 px-8 py-6"><h2 class="text-2xl font-bold text-white">Submission Form</h2> <p class="text-blue-100 mt-1">Fill out the details below to contribute</p></div> <div class="p-8 sm:p-10"><form class="space-y-8"><div class="bg-gradient-to-r from-blue-50 to-indigo-50 p-6 rounded-xl border border-blue-200"><h2 class="text-lg font-bold text-gray-900 mb-4">Contributor Information</h2> <div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div><label for="contributor-email" class="block text-sm font-medium text-gray-700 mb-1">Email Address <span class="text-red-500">*</span></label> <input type="email" id="contributor-email" required class="w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="your.email@example.com"/></div> <div><label for="contributor-github" class="block text-sm font-medium text-gray-700 mb-1">GitHub Username (optional)</label> <input type="text" id="contributor-github" class="w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="@username"/></div></div> <div class="mt-4"><label for="contributor-note" class="block text-sm font-medium text-gray-700 mb-1">Note (optional)</label> <textarea id="contributor-note" rows="3" class="w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-y" placeholder="Add any clarifications or additional context for your contribution..."></textarea> <p class="mt-1 text-xs text-gray-500">This note will be included in the pull request description.</p></div></div> <div class="flex justify-end"><!> <button type="button" class="mb-3 inline-flex items-center gap-2 rounded-full border border-gray-300 px-3 py-1 text-sm font-medium text-gray-700 shadow-sm transition-colors hover:border-blue-400 hover:text-blue-600"><span aria-hidden="true">🗂️</span> Submission history <svg viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M2 4l4 4 4-4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg></button></div> <!> <!>  <!> <!></form></div></div></div></div> <!> <!> <!> <!> <!> <!>',1);function pi(l,t){He(t,!0);const d=a=>typeof a=="string",v=a=>Array.isArray(a)?a.filter(d):[],b=()=>typeof crypto<"u"&&typeof crypto.randomUUID=="function"?crypto.randomUUID():oa(),y=a=>typeof a=="string"&&a.trim().length>0?a:null;function p(a){if(!Array.isArray(a))return[];const s=[];for(const h of a){if(!h||typeof h!="object")continue;const T=h;d(T.label)&&s.push({label:T.label,color:d(T.color)?T.color:"#6366f1",description:d(T.description)?T.description:void 0,refs:v(T.refs)})}return s}const f=a=>({...a,descriptionRefs:[...a.descriptionRefs],queries:Object.fromEntries(Object.entries(a.queries).map(([s,h])=>[s,{...h,refs:[...h.refs]}])),transformations:Object.fromEntries(Object.entries(a.transformations).map(([s,h])=>[s,{...h,refs:[...h.refs]}])),tags:a.tags.map(s=>({...s,refs:[...s.refs]})),existingReferences:[...a.existingReferences]}),x=a=>({...a,refs:[...a.refs],separatingFunctionIds:a.separatingFunctionIds?[...a.separatingFunctionIds]:void 0,separatingFunctions:a.separatingFunctions?a.separatingFunctions.map(s=>({...s,refs:[...s.refs]})):void 0}),S=a=>({shortName:a.shortName,name:a.name,description:a.description,refs:[...a.refs]}),D=a=>{switch(a.kind){case"language:new":case"language:edit":return{...a,payload:f(a.payload)};case"relationship":return{...a,payload:x(a.payload)};case"separator":return{...a,payload:S(a.payload)};case"reference":default:return{...a,payload:a.payload}}};function u(a){if(!Array.isArray(a.queueEntries)||a.queueEntries.length===0)throw new Error("Submission history entry is missing queueEntries.");return a.queueEntries.map(D)}const g=()=>typeof crypto<"u"&&typeof crypto.randomUUID=="function"?crypto.randomUUID():oa();function _(a){r(c,[...e(c),a],!0)}function E(a,s,h){r(c,e(c).map(T=>T.id===a&&T.kind===s?{...T,payload:h}:T),!0)}function N(a){r(c,e(c).filter(s=>s.id!==a),!0)}const ie=a=>({...a,refs:[...a.refs]}),ae=a=>{try{return new Intl.DateTimeFormat(void 0,{dateStyle:"medium",timeStyle:"short"}).format(new Date(a))}catch{return a}},B=a=>{const s=[];return a.summary.languagesToAdd&&s.push(`${a.summary.languagesToAdd} new ${a.summary.languagesToAdd===1?"language":"languages"}`),a.summary.languagesToEdit&&s.push(`${a.summary.languagesToEdit} edit${a.summary.languagesToEdit===1?"":"s"}`),a.summary.relationships&&s.push(`${a.summary.relationships} relation${a.summary.relationships===1?"":"s"}`),a.summary.newReferences&&s.push(`${a.summary.newReferences} reference${a.summary.newReferences===1?"":"s"}`),s.length>0?s.join(" · "):"No changes"},L=Object.values(t.data.polytimeOptions),G=t.data.relationTypes.map(a=>({value:a.id,label:a.name,description:a.description??""})),H=Wa(t.data.adjacencyMatrix);let J=F(""),z=F(""),R=F(""),c=F(Ie([])),I=F(Ie([])),C=F(Ie([])),O=F(Ie([])),X=F(null),W=F(null),re=F(null),ce=F(null),ge=F(null),pe=F(!1),te=F(!1),he=F(!1),oe=F(""),Y=F(!1),se=F(!1),me=F(!1),_e=F(null),Ne=F(null),Te=F(null),Me=F(null),Oe=F(null),K=F(Ie(new Set)),Z=F(!1),V=F(Ie([])),we=F(Ie([])),$=F(Ie([]));const le=j(()=>e(I).map(a=>a.payload)),Ee=j(()=>e(C).map(a=>a.payload)),Q=j(()=>e(V).map(a=>a.bibtex)),P=j(()=>e(we).map(a=>a.payload)),Fe=j(()=>e(O).map(a=>a.payload));let ke=F(""),ve=F(null),ne=F(Ie([])),De=F(!1);const Re=j(()=>e(c).length>0||e($).length>0||e(K).size>0);let je=!1;Qe(()=>{const a=e(Re);a&&!je&&!e(ke)&&r(ke,b(),!0),!a&&je&&(r(ke,b(),!0),r(ve,null)),je=a}),ar(()=>{r(ne,Ct(),!0);try{const a=Za();a&&(r(c,a.entries.map(D),!0),r($,p(a.customTags),!0),r(K,new Set(v(a.modifiedRelations)),!0),r(ke,y(a.submissionId)??"",!0),r(ve,y(a.supersedesSubmissionId),!0));const s=localStorage.getItem(na);if(s){const h=JSON.parse(s);d(h?.email)&&r(J,h.email,!0),d(h?.github)&&r(z,h.github,!0),d(h?.note)&&r(R,h.note,!0)}}catch(a){console.warn("Failed to restore queued changes from storage",a)}finally{r(Z,!0)}e(ke)||r(ke,b(),!0)});function Ce(a){const s=a(e(K));r(K,new Set(s),!0)}function nt(a){const s=tt(a.sourceId,a.targetId);Ce(h=>{const T=new Set(h);return T.add(s),T})}function Be(a){Ce(s=>{if(!s.has(a))return s;const h=new Set(s);return h.delete(a),h})}Qe(()=>{const a=[],s=[],h=[],T=[],k=[];for(const M of e(c))switch(M.kind){case"language:new":a.push({queueEntryId:M.id,payload:f(M.payload)});break;case"language:edit":s.push({queueEntryId:M.id,payload:f(M.payload)});break;case"relationship":h.push({queueEntryId:M.id,payload:x(M.payload)});break;case"reference":T.push({queueEntryId:M.id,bibtex:M.payload});break;case"separator":k.push({queueEntryId:M.id,payload:S(M.payload)});break}r(I,a,!0),r(C,s,!0),r(O,h,!0),r(V,T,!0),r(we,k,!0)}),Qe(()=>{if(!e(Z)||!Lt)return;if(e(ke)||r(ke,b(),!0),e(c).length===0&&e($).length===0&&e(K).size===0){try{localStorage.removeItem(ra)}catch(h){console.warn("Failed to clear queued changes from storage",h)}r(ve,null);return}const s={entries:e(c).map(D),customTags:e($).map(ie),modifiedRelations:Array.from(e(K)),submissionId:e(ke),supersedesSubmissionId:e(ve)??null};try{localStorage.setItem(ra,JSON.stringify(s))}catch(h){console.warn("Failed to persist queued changes",h)}}),Qe(()=>{if(!e(Z)||!Lt)return;const a={email:e(J),github:e(z),note:e(R)};try{localStorage.setItem(na,JSON.stringify(a))}catch(s){console.warn("Failed to persist contributor info",s)}}),Qe(()=>{if(!e(Z)||!Lt)return;if(!e(Re)){ia(null);return}const a={entries:e(c).map(D),customTags:e($).map(ie),modifiedRelations:Array.from(e(K)),submissionId:e(ke),supersedesSubmissionId:e(ve)??null};try{const s=Xn(Ya,a);ia(s)}catch(s){console.error("Failed to build preview dataset:",s)}});function Ze(a){return _({id:g(),kind:"language:new",payload:f(a)}),{success:!0}}function $e(a){const s=e(C).find(h=>h.payload.name===a.name);return s?E(s.queueEntryId,"language:edit",f(a)):_({id:g(),kind:"language:edit",payload:f(a)}),{success:!0}}function Xe(a){_({id:g(),kind:"reference",payload:a})}function st(a){_({id:g(),kind:"separator",payload:S(a)})}function lt(a){r(Ne,a,!0),r(se,!0)}function ye(a){if(e(Ne)!==null){const s=e(we)[e(Ne)];s&&E(s.queueEntryId,"separator",S(a)),r(Ne,null)}}function Ae(a){r(_e,a,!0),r(Y,!0)}function Le(a){if(e(_e)!==null){const s=e(V)[e(_e)];s&&E(s.queueEntryId,"reference",a),r(_e,null)}}function qe(a){r(Te,a,!0),r(pe,!0)}function Se(a){if(e(Te)!==null){const s=e(I)[e(Te)];s&&E(s.queueEntryId,"language:new",f(a)),r(Te,null)}return{success:!0}}function dt(a){r(Me,a,!0),r(te,!0)}function ut(a){if(e(Me)!==null){const s=e(C)[e(Me)];s&&E(s.queueEntryId,"language:edit",f(a)),r(Me,null)}return{success:!0}}function ma(a){r(Oe,a,!0),r(me,!0)}function xa(a){if(e(Oe)!==null){const s=e(O)[e(Oe)];s&&(E(s.queueEntryId,"relationship",x(a)),nt(a)),r(Oe,null)}}function pa(a){if(e(Oe)!==null){xa(a);return}const s=tt(a.sourceId,a.targetId),h=e(O).find(T=>tt(T.payload.sourceId,T.payload.targetId)===s);h?E(h.queueEntryId,"relationship",x(a)):_({id:g(),kind:"relationship",payload:x(a)}),nt(a)}function _a(a){const s=e(I)[a];s&&qt(s.queueEntryId,s.payload.name)}function ya(a){const s=e(C)[a];s&&qt(s.queueEntryId,s.payload.name)}function ha(a){const s=e(O)[a];s&&(N(s.queueEntryId),Be(tt(s.payload.sourceId,s.payload.targetId)))}function qt(a,s){const h=e(O).filter(k=>k.payload.sourceId===s||k.payload.targetId===s).map(k=>k.queueEntryId),T=new Set([a,...h]);r(c,e(c).filter(k=>!T.has(k.id)),!0),Ce(k=>{if(k.size===0)return k;const M=new Set(k);for(const xe of Array.from(M))(xe.startsWith(`${s}->`)||xe.endsWith(`->${s}`))&&M.delete(xe);return M})}function wa(a){const s=e(V)[a];if(!s)return;const h=new Set(t.data.existingReferences.map(k=>k.id));for(let k=0;k<a;k++){const M=jt(e(V)[k].bibtex,h);h.add(M)}const T=jt(s.bibtex,h);r(c,e(c).map(k=>{if(k.kind==="language:new"||k.kind==="language:edit"){if(!k.payload.descriptionRefs.includes(T))return k;const M=f(k.payload);return M.descriptionRefs=M.descriptionRefs.filter(xe=>xe!==T),{...k,payload:M}}if(k.kind==="relationship"){if(!k.payload.refs.includes(T)&&!k.payload.separatingFunctions?.some(xe=>xe.refs.includes(T)))return k;const M=x(k.payload);return M.refs=M.refs.filter(xe=>xe!==T),M.separatingFunctions&&(M.separatingFunctions=M.separatingFunctions.map(xe=>({...xe,refs:xe.refs.filter(ee=>ee!==T)}))),{...k,payload:M}}if(k.kind==="separator"){if(!k.payload.refs.includes(T))return k;const M=S(k.payload);return M.refs=M.refs.filter(xe=>xe!==T),{...k,payload:M}}return k}),!0),N(s.queueEntryId),r($,e($).map(k=>({...k,refs:k.refs.filter(M=>M!==T)})),!0)}function Ea(a){const s=e(we)[a];if(!s)return;const h=s.payload.shortName;N(s.queueEntryId),r(c,e(c).map(T=>{if(T.kind!=="relationship"||!T.payload.separatingFunctionIds||!T.payload.separatingFunctionIds.includes(h))return T;const k=x(T.payload);return k.separatingFunctionIds=(k.separatingFunctionIds||[]).filter(M=>M!==h),{...T,payload:k}}),!0)}function ka(a){try{const s=a.payload;r(c,u(s),!0),r($,s.customTags.map(ie),!0),r(K,new Set(s.modifiedRelations),!0),r(J,s.contributor.email,!0),r(z,s.contributor.github,!0),r(R,s.contributor.note,!0),r(ve,s.submissionId,!0),r(ke,b(),!0),r(ne,Ct(),!0),r(De,!1),r(_e,null),r(Te,null),r(Me,null),r(Oe,null),r(X,null),r(W,null),r(re,null),r(ce,null)}catch(s){console.error("Failed to load submission from history",s),alert("Unable to load this submission. It was saved before ordered queues were supported.")}}function Ra(a){a.preventDefault(),window.location.href="/"}var Pt=ui();cr(a=>{vr.title="Contribute - Knowledge Compilation Map"});var ht=Ke(Pt),Qt=i(ht),Ut=o(i(Qt),2),Bt=o(i(Ut),2),wt=i(Bt),Et=i(wt),kt=o(i(Et),2),Rt=i(kt),zt=o(i(Rt),2);Ye(zt),n(Rt);var Kt=o(Rt,2),Vt=o(i(Kt),2);Ye(Vt),n(Kt),n(kt);var Ht=o(kt,2),Gt=o(i(Ht),2);bt(Gt),at(2),n(Ht),n(Et);var St=o(Et,2),Xt=i(St);{var Sa=a=>{var s=Wn(),h=o(i(s),2);h.__click=[Jn,ve],n(s),m(a,s)};U(Xt,a=>{e(ve)&&a(Sa)})}var It=o(Xt,2);It.__click=[fa,De,ne];var Ia=o(i(It),2);n(It),n(St);var Jt=o(St,2);{var Ta=a=>{var s=ri(),h=i(s),T=o(i(h),2);T.__click=[fa,De,ne],n(h);var k=o(h,2);{var M=ee=>{var fe=Yn();m(ee,fe)},xe=ee=>{var fe=ai();de(fe,21,()=>e(ne),ue,(mt,Je)=>{const ct=j(()=>B(e(Je))),et=j(()=>ae(e(Je).createdAt));var gt=ti(),vt=i(gt),Tt=i(vt),Ft=i(Tt),La=i(Ft,!0);n(Ft);var Dt=o(Ft,2),Oa=i(Dt,!0);n(Dt);var Na=o(Dt,2);{var Ma=it=>{var xt=Zn();m(it,xt)},ja=it=>{var xt=Ve(),qa=Ke(xt);{var Pa=At=>{var Qa=$n();m(At,Qa)};U(qa,At=>{e(Je).payload.submissionId===e(ve)&&At(Pa)},!0)}m(it,xt)};U(Na,it=>{e(Je).supersededBySubmissionId?it(Ma):it(ja,!1)})}n(Tt);var Ca=o(Tt,2);Ca.__click=[ei,ka,Je],n(vt),n(gt),q(()=>{A(La,e(et)),A(Oa,e(ct))}),m(mt,gt)}),n(fe),m(ee,fe)};U(k,ee=>{e(ne).length===0?ee(M):ee(xe,!1)})}n(s),m(a,s)};U(Jt,a=>{e(De)&&a(Ta)})}var Wt=o(Jt,2);Bn(Wt,{get languagesToAdd(){return e(le)},get languagesToEdit(){return e(Ee)},get newReferences(){return e(Q)},get newSeparatingFunctions(){return e(P)},get relationships(){return e(Fe)},get modifiedRelations(){return e(K)},get expandedLanguageToAddIndex(){return e(X)},get expandedLanguageToEditIndex(){return e(W)},get expandedReferenceIndex(){return e(ce)},get expandedSeparatingFunctionIndex(){return e(ge)},get expandedRelationshipIndex(){return e(re)},onToggleExpandLanguageToAdd:a=>r(X,e(X)===a?null:a,!0),onToggleExpandLanguageToEdit:a=>r(W,e(W)===a?null:a,!0),onToggleExpandReference:a=>r(ce,e(ce)===a?null:a,!0),onToggleExpandSeparatingFunction:a=>r(ge,e(ge)===a?null:a,!0),onToggleExpandRelationship:a=>r(re,e(re)===a?null:a,!0),onEditLanguageToAdd:qe,onEditLanguageToEdit:dt,onDeleteLanguageToAdd:_a,onDeleteLanguageToEdit:ya,onEditReference:Ae,onDeleteReference:wa,onEditSeparatingFunction:lt,onDeleteSeparatingFunction:Ea,onEditRelationship:ma,onDeleteRelationship:a=>ha(a)});var Yt=o(Wt,2);Kn(Yt,{onAddLanguage:()=>r(pe,!0),onEditLanguage:()=>r(he,!0),onManageRelationships:()=>r(me,!0),onAddReference:()=>r(Y,!0),onAddSeparatingFunction:()=>r(se,!0)});var Fa=o(Yt,2);{let a=j(()=>!e(Re));Hn(Fa,{get disabled(){return e(a)}})}n(wt),n(Bt),n(Ut),n(Qt),n(ht);var Zt=o(ht,2);{let a=j(()=>e(Te)!==null?Se:Ze),s=j(()=>e(Te)!==null),h=j(()=>e(Te)!==null?e(I)[e(Te)]?.payload:void 0),T=j(()=>Object.values(t.data.queries).map(fe=>({code:fe.code,name:fe.label}))),k=j(()=>Object.values(t.data.transformations).map(fe=>({code:fe.code,name:fe.label}))),M=j(()=>L.map(fe=>({value:fe.code,label:fe.label,description:fe.description||""}))),xe=j(()=>[...t.data.existingTags,...e($)].map(fe=>({label:fe.label,color:fe.color||"#6366f1",description:"",refs:[]}))),ee=j(()=>_t(t.data.existingReferences,e(Q)));da(Zt,{onClose:()=>{r(pe,!1),r(Te,null)},get onAdd(){return e(a)},get isEdit(){return e(s)},get initialData(){return e(h)},get queries(){return e(T)},get transformations(){return e(k)},get polytimeOptions(){return e(M)},get existingTags(){return e(xe)},get availableRefs(){return e(ee)},get isOpen(){return e(pe)},set isOpen(fe){r(pe,fe,!0)}})}var $t=o(Zt,2);{let a=j(()=>e(Me)!==null?ut:$e),s=j(()=>e(Me)!==null?e(C)[e(Me)]?.payload:e(oe)?$a(t.data.languages.find(ee=>ee.name===e(oe))):void 0),h=j(()=>Object.values(t.data.queries).map(ee=>({code:ee.code,name:ee.label}))),T=j(()=>Object.values(t.data.transformations).map(ee=>({code:ee.code,name:ee.label}))),k=j(()=>L.map(ee=>({value:ee.code,label:ee.label,description:ee.description||""}))),M=j(()=>[...t.data.existingTags,...e($)].map(ee=>({label:ee.label,color:ee.color||"#6366f1",description:"",refs:[]}))),xe=j(()=>_t(t.data.existingReferences,e(Q)));da($t,{onClose:()=>{r(te,!1),r(oe,""),r(Me,null)},get onAdd(){return e(a)},isEdit:!0,get initialData(){return e(s)},get queries(){return e(h)},get transformations(){return e(T)},get polytimeOptions(){return e(k)},get existingTags(){return e(M)},get availableRefs(){return e(xe)},get isOpen(){return e(te)},set isOpen(ee){r(te,ee,!0)}})}var ea=o($t,2);{var Da=a=>{var s=di();s.__click=[ni,he];var h=i(s);h.__click=[ii];var T=o(i(h),2),k=o(i(T),2),M=i(k);M.value=M.__value="";var xe=o(M);de(xe,17,()=>t.data.languages,ue,(Je,ct)=>{var et=oi(),gt=i(et,!0);n(et);var vt={};q(()=>{A(gt,e(ct).name),vt!==(vt=e(ct).name)&&(et.value=(et.__value=e(ct).name)??"")}),m(Je,et)}),n(k);var ee=o(k,2),fe=i(ee);fe.__click=[si,oe,he];var mt=o(fe,2);mt.__click=[li,oe,he,te],n(ee),n(T),n(h),n(s),q(()=>mt.disabled=!e(oe)),ot(k,()=>e(oe),Je=>r(oe,Je)),m(a,s)};U(ea,a=>{e(he)&&a(Da)})}var ta=o(ea,2);{let a=j(()=>e(_e)!==null?Le:Xe),s=j(()=>e(_e)!==null?e(V)[e(_e)]?.bibtex??"":""),h=j(()=>e(_e)!==null);Br(ta,{onClose:()=>{r(Y,!1),r(_e,null)},get onAdd(){return e(a)},get initialValue(){return e(s)},get isEditMode(){return e(h)},get isOpen(){return e(Y)},set isOpen(T){r(Y,T,!0)}})}var aa=o(ta,2);{let a=j(()=>e(Ne)!==null?ye:st),s=j(()=>e(Ne)!==null?e(we)[e(Ne)]?.payload:void 0),h=j(()=>_t(t.data.existingReferences,e(Q))),T=j(()=>e(Ne)!==null);Jr(aa,{onClose:()=>{r(se,!1),r(Ne,null)},get onAdd(){return e(a)},get initialValue(){return e(s)},get availableRefs(){return e(h)},get isEditMode(){return e(T)},get isOpen(){return e(se)},set isOpen(k){r(se,k,!0)}})}var Aa=o(aa,2);{let a=j(()=>e(Oe)!==null?e(O)[e(Oe)]?.payload:void 0),s=j(()=>tr(t.data.languages,e(le),e(Ee))),h=j(()=>_t(t.data.existingReferences,e(Q))),T=j(()=>er(t.data.existingSeparatingFunctions,e(P)));cn(Aa,{onClose:()=>{r(me,!1),r(Oe,null)},onSave:pa,get initialData(){return e(a)},get languages(){return e(s)},get statusOptions(){return G},get availableRefs(){return e(h)},get availableSeparatingFunctions(){return e(T)},get baselineRelations(){return H},get isOpen(){return e(me)},set isOpen(k){r(me,k,!0)}})}q(()=>Ue(Ia,0,`h-3 w-3 transition-transform ${e(De)?"rotate-180":""}`)),gr("submit",wt,Ra),Pe(zt,()=>e(J),a=>r(J,a)),Pe(Vt,()=>e(z),a=>r(z,a)),Pe(Gt,()=>e(R),a=>r(R,a)),m(l,Pt),Ge()}rt(["click"]);export{pi as component,xi as universal};
