import{d as Ba,a as xt,r as Qa,b as za,P as Ka,T as Va,Q as Ha,e as de,i as ue,M as Je,c as Xa,v as Ga,p as Wa,f as Lt,g as ra,C as na,s as ia,h as Ja,j as oa,l as Ct,k as Ya}from"../chunks/IvJ2Gu4b.js";import"../chunks/DsnmJJEf.js";import{s as A,o as Za}from"../chunks/D4xMwpl8.js";import{a$ as $a,aT as er,u as tr,r as ar,h as rr,k as ft,be as nr,ba as rt,K as He,X as D,y as Ie,a4 as Pe,z as r,v as e,Z as Ve,_ as Ke,Q as _,R as Xe,M as w,V as i,Y as n,al as at,T as o,bf as bt,O as q,aW as j,aX as ir,a0 as or,bg as sa,N as sr,bh as lr,$ as dr}from"../chunks/CuxRnwIY.js";import{p as be,i as B}from"../chunks/CTb7Me_4.js";import{r as Ye,s as ze,b as ot,a as Be,c as ur}from"../chunks/BQmAUj6M.js";function Ue(s,t,l=t){var g=new WeakSet;$a(s,"input",async v=>{var m=v?s.defaultValue:s.value;if(m=Mt(s)?Ot(m):m,l(m),ft!==null&&g.add(ft),await er(),m!==(m=t())){var u=s.selectionStart,b=s.selectionEnd;s.value=m??"",b!==null&&(s.selectionStart=u,s.selectionEnd=Math.min(b,s.value.length))}}),(rr&&s.defaultValue!==s.value||tr(t)==null&&s.value)&&(l(Mt(s)?Ot(s.value):s.value),ft!==null&&g.add(ft)),ar(()=>{var v=t();if(s===document.activeElement){var m=nr??ft;if(g.has(m))return}Mt(s)&&v===Ot(s.value)||s.type==="date"&&!v&&!s.value||v!==s.value&&(s.value=v??"")})}function Mt(s){var t=s.type;return t==="number"||t==="range"}function Ot(s){return s===""?null:+s}const ba={},cr=Ba.separatingFunctions;for(const s of cr)ba[s.shortName]=s;const gr=Object.values(ba),vr=()=>{const s=xt.map(u=>u.name),t=new Map;for(const u of xt)if(u.references)for(const b of u.references)t.has(b.id)||t.set(b.id,b.title);const l=Array.from(t.entries()).map(([u,b])=>({id:u,title:b})),g=new Map;for(const u of xt)if(u.tags)for(const b of u.tags)g.has(b.label)||g.set(b.label,{label:b.label,color:b.color});const v=Array.from(g.values()),m=gr.map(u=>({shortName:u.shortName,name:u.name,description:u.description}));return{existingLanguageIds:s,existingReferences:l,existingSeparatingFunctions:m,existingTags:v,languages:xt,queries:Ha,transformations:Va,polytimeOptions:Ka,adjacencyMatrix:za,relationTypes:Qa}},fr=!1,xi=Object.freeze(Object.defineProperty({__proto__:null,load:vr,prerender:fr},Symbol.toStringTag,{value:"Module"}));async function br(s,t,l,g,v,m,u,b,x,E,F,c){if(!e(t).trim()||!e(l).trim()||!e(g).trim()){r(v,"Please fill out all required fields.");return}try{const p=await m.onAdd({name:e(t).trim(),fullName:e(l).trim(),description:e(g).trim(),descriptionRefs:e(u),queries:e(b),transformations:e(x),tags:e(E),existingReferences:e(F)}),y=p&&typeof p=="object"&&"success"in p?p:void 0;if(y&&!y.success){r(v,y.error??"Unable to add language. Please review your input.",!0);return}r(v,null),c(),m.onClose?.()}catch(p){r(v,p instanceof Error?p.message:"Unexpected error while adding the language.",!0)}}function la(s,t,l){t(),l.onClose()}var mr=s=>s.stopPropagation(),pr=w('<div class="p-3 bg-red-50 border border-red-200 rounded-lg text-sm text-red-700"> </div>'),xr=(s,t,l)=>t(e(l)),_r=w('<button type="button"> </button>'),yr=w('<fieldset><legend class="block text-sm font-medium text-gray-700 mb-2">Description References</legend> <div class="flex flex-wrap gap-2"></div></fieldset>'),hr=w("<option> </option>"),wr=(s,t,l,g)=>t(e(l).code,e(g)),Er=w('<button type="button"> </button>'),kr=w('<div class="mt-2 flex flex-wrap gap-1"></div>'),Rr=w('<div class="p-3 bg-gray-50 rounded-lg border border-gray-200"><div class="grid grid-cols-1 md:grid-cols-2 gap-3"><div><label class="block text-xs font-medium text-gray-700 mb-1"> </label> <select class="w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-green-500"></select></div> <div><label class="block text-xs font-medium text-gray-700 mb-1">Note</label> <input type="text" placeholder="Optional note..." class="w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-green-500"/></div></div> <!></div>'),Sr=w("<option> </option>"),Ir=(s,t,l,g)=>t(e(l).code,e(g)),Fr=w('<button type="button"> </button>'),Tr=w('<div class="mt-2 flex flex-wrap gap-1"></div>'),Dr=w('<div class="p-3 bg-gray-50 rounded-lg border border-gray-200"><div class="grid grid-cols-1 md:grid-cols-2 gap-3"><div><label class="block text-xs font-medium text-gray-700 mb-1"> </label> <select class="w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-green-500"></select></div> <div><label class="block text-xs font-medium text-gray-700 mb-1">Note</label> <input type="text" placeholder="Optional note..." class="w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-green-500"/></div></div> <!></div>'),Ar=(s,t,l)=>t(e(l)),Nr=w('<button type="button"> </button>'),Lr=w('<div class="space-y-4 border-t pt-6"><h3 class="text-lg font-bold text-gray-900">Tags</h3> <div class="flex flex-wrap gap-2"></div></div>'),Mr=w(`<div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"><div class="bg-white rounded-xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto"><div class="bg-gradient-to-r from-green-600 to-green-700 px-6 py-4 sticky top-0 z-10"><h2 class="text-2xl font-bold text-white"> </h2> <p class="text-green-100 mt-1">Define a knowledge compilation language</p></div> <div class="p-6 space-y-6"><!> <div class="space-y-4"><h3 class="text-lg font-bold text-gray-900">Basic Information</h3> <div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div><label for="lang-name" class="block text-sm font-medium text-gray-700 mb-1">Short Name <span class="text-red-500">*</span></label> <input type="text" id="lang-name" placeholder="e.g., 'OBDD', 'd-DNNF'" class="w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"/></div> <div><label for="lang-fullname" class="block text-sm font-medium text-gray-700 mb-1">Full Name <span class="text-red-500">*</span></label> <input type="text" id="lang-fullname" placeholder="e.g., 'Ordered Binary Decision Diagrams'" class="w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"/></div></div> <div><label for="lang-description" class="block text-sm font-medium text-gray-700 mb-1">Description <span class="text-red-500">*</span></label> <textarea id="lang-description" placeholder="Brief description of this language..." rows="3" class="w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"></textarea></div> <!></div> <div class="space-y-4 border-t pt-6"><h3 class="text-lg font-bold text-gray-900">Query Support</h3> <div class="space-y-3"></div></div> <div class="space-y-4 border-t pt-6"><h3 class="text-lg font-bold text-gray-900">Transformation Support</h3> <div class="space-y-3"></div></div> <!> <div class="flex gap-3 justify-end pt-6 border-t sticky bottom-0 bg-white"><button type="button" class="px-4 py-2 border-2 border-gray-300 text-gray-700 font-medium rounded-lg hover:bg-gray-50 transition-colors">Cancel</button> <button type="button" class="px-4 py-2 bg-green-600 text-white font-medium rounded-lg hover:bg-green-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors"> </button></div></div></div></div>`);function da(s,t){He(t,!0);let l=be(t,"isOpen",11,!1),g=be(t,"availableRefs",19,()=>[]),v=be(t,"isEdit",3,!1),m=D(""),u=D(""),b=D(""),x=D(Ie([])),E=D(Ie({})),F=D(Ie({})),c=D(Ie([])),p=D(Ie([])),y=D(null);Pe(()=>{v()&&t.initialData&&(r(m,t.initialData.name,!0),r(u,t.initialData.fullName,!0),r(b,t.initialData.description,!0),r(x,[...t.initialData.descriptionRefs],!0),r(E,{...t.initialData.queries},!0),r(F,{...t.initialData.transformations},!0),r(c,[...t.initialData.tags],!0),r(p,[...t.initialData.existingReferences],!0),r(y,null))});function k(){r(m,""),r(u,""),r(b,""),r(x,[],!0),r(E,{},!0),r(F,{},!0),r(c,[],!0),r(p,[],!0),r(N,!1),r(X,!1),r(y,null)}function M(S){e(x).includes(S)?r(x,e(x).filter(f=>f!==S),!0):r(x,[...e(x),S],!0)}function ie(S){e(c).some(f=>f.label===S.label)?r(c,e(c).filter(f=>f.label!==S.label),!0):r(c,[...e(c),S],!0)}function ae(S,f){if(!e(E)[S])return;const I=e(E)[S].refs;I.includes(f)?e(E)[S].refs=I.filter(C=>C!==f):e(E)[S].refs=[...I,f],r(E,{...e(E)},!0)}function Q(S,f){if(!e(F)[S])return;const I=e(F)[S].refs;I.includes(f)?e(F)[S].refs=I.filter(C=>C!==f):e(F)[S].refs=[...I,f],r(F,{...e(F)},!0)}let N=D(!1),X=D(!1);Pe(()=>{if(t.queries.length>0&&!e(N)){const S={};t.queries.forEach(f=>{if(v()&&t.initialData&&t.initialData.queries[f.code]){const I=t.initialData.queries[f.code];S[f.code]={polytime:I.polytime,note:I.note||"",refs:[...I.refs]}}else S[f.code]={polytime:"unknown",note:"",refs:[]}}),r(E,S,!0),r(N,!0)}}),Pe(()=>{if(t.transformations.length>0&&!e(X)){const S={};t.transformations.forEach(f=>{if(v()&&t.initialData){let I=t.initialData.transformations[f.code];if(!I){const C=Object.keys(t.initialData.transformations).find(L=>t.initialData.transformations[L]!==void 0&&(L===f.code||f.code==="∧C"&&L==="AND_C"||f.code==="∧BC"&&L==="AND_BC"||f.code==="∨C"&&L==="OR_C"||f.code==="∨BC"&&L==="OR_BC"||f.code==="¬C"&&L==="NOT_C"));C&&(I=t.initialData.transformations[C])}S[f.code]=I?{polytime:I.polytime,note:I.note||"",refs:[...I.refs]}:{polytime:"unknown",note:"",refs:[]}}else S[f.code]={polytime:"unknown",note:"",refs:[]}}),r(F,S,!0),r(X,!0)}});var H=Ve(),W=Ke(H);{var z=S=>{var f=Mr();f.__click=[la,k,t];var I=i(f);I.__click=[mr];var C=i(I),L=i(C),G=i(L);n(L),at(2),n(C);var J=o(C,2),re=i(J);{var ce=P=>{var U=pr(),Te=i(U,!0);n(U),q(()=>A(Te,e(y))),_(P,U)};B(re,P=>{e(y)&&P(ce)})}var ge=o(re,2),xe=o(i(ge),2),te=i(xe),he=o(i(te),2);Ye(he),n(te);var oe=o(te,2),Y=o(i(oe),2);Ye(Y),n(oe),n(xe);var se=o(xe,2),me=o(i(se),2);bt(me),n(se);var _e=o(se,2);{var Me=P=>{var U=yr(),Te=o(i(U),2);de(Te,21,g,ue,(ke,ve)=>{var ne=_r();ne.__click=[xr,M,ve];var De=i(ne,!0);n(ne),q(Re=>{Be(ne,1,Re),A(De,e(ve))},[()=>`px-3 py-1 text-sm rounded-lg border-2 transition-colors ${e(x).includes(e(ve))?"bg-green-600 text-white border-green-600":"bg-white text-gray-700 border-gray-300 hover:border-green-300"}`]),_(ke,ne)}),n(Te),n(U),_(P,U)};B(_e,P=>{g().length>0&&P(Me)})}n(ge);var Fe=o(ge,2),Oe=o(i(Fe),2);de(Oe,21,()=>t.queries,ue,(P,U)=>{var Te=Ve(),ke=Ke(Te);{var ve=ne=>{var De=Rr(),Re=i(De),je=i(Re),Ce=i(je),nt=i(Ce,!0);n(Ce);var Qe=o(Ce,2);de(Qe,21,()=>t.polytimeOptions,ue,(ye,Ae)=>{var Ne=hr(),qe=i(Ne,!0);n(Ne);var Se={};q(()=>{A(qe,e(Ae).label),Se!==(Se=e(Ae).value)&&(Ne.value=(Ne.__value=e(Ae).value)??"")}),_(ye,Ne)}),n(Qe),n(je);var $e=o(je,2),et=i($e),Ge=o(et,2);Ye(Ge),n($e),n(Re);var st=o(Re,2);{var lt=ye=>{var Ae=kr();de(Ae,21,g,ue,(Ne,qe)=>{var Se=Er();Se.__click=[wr,ae,U,qe];var dt=i(Se,!0);n(Se),q(ut=>{Be(Se,1,ut),A(dt,e(qe))},[()=>`px-2 py-0.5 text-xs rounded ${e(E)[e(U).code].refs.includes(e(qe))?"bg-green-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`]),_(Ne,Se)}),n(Ae),_(ye,Ae)};B(st,ye=>{g().length>0&&ye(lt)})}n(De),q(()=>{ze(Ce,"for",`query-${e(U).code??""}-polytime`),A(nt,e(U).name),ze(Qe,"id",`query-${e(U).code??""}-polytime`),ze(et,"for",`query-${e(U).code??""}-note`),ze(Ge,"id",`query-${e(U).code??""}-note`)}),ot(Qe,()=>e(E)[e(U).code].polytime,ye=>e(E)[e(U).code].polytime=ye),Ue(Ge,()=>e(E)[e(U).code].note,ye=>e(E)[e(U).code].note=ye),_(ne,De)};B(ke,ne=>{e(E)[e(U).code]&&ne(ve)})}_(P,Te)}),n(Oe),n(Fe);var Le=o(Fe,2),K=o(i(Le),2);de(K,21,()=>t.transformations,ue,(P,U)=>{var Te=Ve(),ke=Ke(Te);{var ve=ne=>{var De=Dr(),Re=i(De),je=i(Re),Ce=i(je),nt=i(Ce,!0);n(Ce);var Qe=o(Ce,2);de(Qe,21,()=>t.polytimeOptions,ue,(ye,Ae)=>{var Ne=Sr(),qe=i(Ne,!0);n(Ne);var Se={};q(()=>{A(qe,e(Ae).label),Se!==(Se=e(Ae).value)&&(Ne.value=(Ne.__value=e(Ae).value)??"")}),_(ye,Ne)}),n(Qe),n(je);var $e=o(je,2),et=i($e),Ge=o(et,2);Ye(Ge),n($e),n(Re);var st=o(Re,2);{var lt=ye=>{var Ae=Tr();de(Ae,21,g,ue,(Ne,qe)=>{var Se=Fr();Se.__click=[Ir,Q,U,qe];var dt=i(Se,!0);n(Se),q(ut=>{Be(Se,1,ut),A(dt,e(qe))},[()=>`px-2 py-0.5 text-xs rounded ${e(F)[e(U).code].refs.includes(e(qe))?"bg-green-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`]),_(Ne,Se)}),n(Ae),_(ye,Ae)};B(st,ye=>{g().length>0&&ye(lt)})}n(De),q(()=>{ze(Ce,"for",`transform-${e(U).code??""}-polytime`),A(nt,e(U).name),ze(Qe,"id",`transform-${e(U).code??""}-polytime`),ze(et,"for",`transform-${e(U).code??""}-note`),ze(Ge,"id",`transform-${e(U).code??""}-note`)}),ot(Qe,()=>e(F)[e(U).code].polytime,ye=>e(F)[e(U).code].polytime=ye),Ue(Ge,()=>e(F)[e(U).code].note,ye=>e(F)[e(U).code].note=ye),_(ne,De)};B(ke,ne=>{e(F)[e(U).code]&&ne(ve)})}_(P,Te)}),n(K),n(Le);var Z=o(Le,2);{var V=P=>{var U=Lr(),Te=o(i(U),2);de(Te,21,()=>t.existingTags,ue,(ke,ve)=>{var ne=Nr();ne.__click=[Ar,ie,ve];var De=i(ne,!0);n(ne),q((Re,je)=>{Be(ne,1,Re),ur(ne,`background-color: ${e(ve).color??""}; color: white; ${je??""}`),A(De,e(ve).label)},[()=>`px-3 py-1 rounded-full text-sm font-medium transition-all ${e(c).some(Re=>Re.label===e(ve).label)?"ring-2 ring-offset-2":"opacity-60 hover:opacity-100"}`,()=>e(c).some(Re=>Re.label===e(ve).label)?`ring-color: ${e(ve).color};`:""]),_(ke,ne)}),n(Te),n(U),_(P,U)};B(Z,P=>{t.existingTags.length>0&&P(V)})}var we=o(Z,2),$=i(we);$.__click=[la,k,t];var le=o($,2);le.__click=[br,m,u,b,y,t,x,E,F,c,p,k];var Ee=i(le);n(le),n(we),n(J),n(I),n(f),q(P=>{A(G,`${v()?"Edit":"Add New"} Language`),le.disabled=P,A(Ee,`${v()?"Update":"Add"} Language`)},[()=>!e(m).trim()||!e(u).trim()||!e(b).trim()]),Ue(he,()=>e(m),P=>r(m,P)),Ue(Y,()=>e(u),P=>r(u,P)),Ue(me,()=>e(b),P=>r(b,P)),_(S,f)};B(W,S=>{l()&&S(z)})}_(s,H),Xe()}rt(["click"]);function Or(s,t,l,g){e(t).trim()&&(l.onAdd(e(t).trim()),r(t,""),g(!1))}function ua(s,t,l,g){t()||r(l,""),g.onClose()}var jr=s=>s.stopPropagation(),Cr=w('<div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"><div class="bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto"><div class="bg-gradient-to-r from-purple-600 to-purple-700 px-6 py-4"><h2 class="text-2xl font-bold text-white"> </h2> <p class="text-purple-100 mt-1"> </p></div> <div class="p-6 space-y-4"><div><label for="bibtex-input" class="block text-sm font-medium text-gray-700 mb-2">BibTeX Entry <span class="text-red-500">*</span></label> <textarea id="bibtex-input" rows="8" class="w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 font-mono text-sm"></textarea> <p class="text-xs text-gray-500 mt-1">Paste a complete BibTeX entry.</p></div> <div class="flex gap-3 justify-end pt-4"><button type="button" class="px-4 py-2 border-2 border-gray-300 text-gray-700 font-medium rounded-lg hover:bg-gray-50 transition-colors">Cancel</button> <button type="button" class="px-4 py-2 bg-purple-600 text-white font-medium rounded-lg hover:bg-purple-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors"> </button></div></div></div></div>');function qr(s,t){He(t,!0);let l=be(t,"isOpen",15,!1),g=be(t,"initialValue",3,""),v=be(t,"isEditMode",3,!1),m=D(Ie(g()));Pe(()=>{l()&&g()&&r(m,g())});const u=`@article{Darwiche_2002,
  title={A Knowledge Compilation Map},
  author={Darwiche, Adnan and Marquis, Pierre},
  journal={Journal of AI Research},
  year={2002}
}`;var b=Ve(),x=Ke(b);{var E=F=>{var c=Cr();c.__click=[ua,v,m,t];var p=i(c);p.__click=[jr];var y=i(p),k=i(y),M=i(k,!0);n(k);var ie=o(k,2),ae=i(ie,!0);n(ie),n(y);var Q=o(y,2),N=i(Q),X=o(i(N),2);bt(X),ze(X,"placeholder",u),at(2),n(N);var H=o(N,2),W=i(H);W.__click=[ua,v,m,t];var z=o(W,2);z.__click=[Or,m,t,l];var S=i(z,!0);n(z),n(H),n(Q),n(p),n(c),q(f=>{A(M,v()?"Edit Reference":"Add New Reference"),A(ae,v()?"Update BibTeX citation":"Paste BibTeX citation"),z.disabled=f,A(S,v()?"Update Reference":"Add Reference")},[()=>!e(m).trim()]),Ue(X,()=>e(m),f=>r(m,f)),_(F,c)};B(x,F=>{l()&&F(E)})}_(s,b),Xe()}rt(["click"]);function Ur(s,t,l,g,v,m,u,b,x){!e(t).trim()||!e(l).trim()||(g.onAdd({shortName:e(t).trim(),name:e(l).trim(),description:e(v).trim(),refs:e(m)}),u()||b(),x(!1))}function ca(s,t,l,g){t()||l(),g.onClose()}var Pr=s=>s.stopPropagation(),Br=(s,t,l)=>t(e(l)),Qr=w('<button type="button"> </button>'),zr=w('<fieldset><legend class="block text-sm font-medium text-gray-700 mb-2">References</legend> <div class="flex flex-wrap gap-2"></div></fieldset>'),Kr=w('<div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"><div class="bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto"><div class="bg-gradient-to-r from-orange-600 to-orange-700 px-6 py-4"><h2 class="text-2xl font-bold text-white"> </h2> <p class="text-orange-100 mt-1"> </p></div> <div class="p-6 space-y-4"><div><label for="sf-shortName" class="block text-sm font-medium text-gray-700 mb-2">Short Name <span class="text-red-500">*</span></label> <input id="sf-shortName" type="text" placeholder="e.g., Clique" class="w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"/> <p class="text-xs text-gray-500 mt-1">Brief label displayed on edges (e.g., "Clique", "PI")</p></div> <div><label for="sf-name" class="block text-sm font-medium text-gray-700 mb-2">Full Name <span class="text-red-500">*</span></label> <input id="sf-name" type="text" placeholder="e.g., Clique Detection Instances" class="w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"/> <p class="text-xs text-gray-500 mt-1">Full human-readable name</p></div> <div><label for="sf-description" class="block text-sm font-medium text-gray-700 mb-2">Description</label> <textarea id="sf-description" rows="3" placeholder="Describe what this function separates..." class="w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 resize-y"></textarea></div> <!> <div class="flex gap-3 justify-end pt-4"><button type="button" class="px-4 py-2 border-2 border-gray-300 text-gray-700 font-medium rounded-lg hover:bg-gray-50 transition-colors">Cancel</button> <button type="button" class="px-4 py-2 bg-orange-600 text-white font-medium rounded-lg hover:bg-orange-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors"> </button></div></div></div></div>');function Vr(s,t){He(t,!0);let l=be(t,"isOpen",15,!1),g=be(t,"availableRefs",19,()=>[]),v=be(t,"isEditMode",3,!1),m=D(""),u=D(""),b=D(""),x=D(Ie([]));Pe(()=>{l()&&t.initialValue&&(r(m,t.initialValue.shortName,!0),r(u,t.initialValue.name,!0),r(b,t.initialValue.description,!0),r(x,[...t.initialValue.refs],!0))});function E(){r(m,""),r(u,""),r(b,""),r(x,[],!0)}function F(k){e(x).includes(k)?r(x,e(x).filter(M=>M!==k),!0):r(x,[...e(x),k],!0)}var c=Ve(),p=Ke(c);{var y=k=>{var M=Kr();M.__click=[ca,v,E,t];var ie=i(M);ie.__click=[Pr];var ae=i(ie),Q=i(ae),N=i(Q,!0);n(Q);var X=o(Q,2),H=i(X,!0);n(X),n(ae);var W=o(ae,2),z=i(W),S=o(i(z),2);Ye(S),at(2),n(z);var f=o(z,2),I=o(i(f),2);Ye(I),at(2),n(f);var C=o(f,2),L=o(i(C),2);bt(L),n(C);var G=o(C,2);{var J=te=>{var he=zr(),oe=o(i(he),2);de(oe,21,g,ue,(Y,se)=>{var me=Qr();me.__click=[Br,F,se];var _e=i(me,!0);n(me),q(Me=>{Be(me,1,Me),A(_e,e(se))},[()=>`px-3 py-1 text-sm rounded-lg border-2 transition-colors ${e(x).includes(e(se))?"bg-orange-600 text-white border-orange-600":"bg-white text-gray-700 border-gray-300 hover:border-orange-300"}`]),_(Y,me)}),n(oe),n(he),_(te,he)};B(G,te=>{g().length>0&&te(J)})}var re=o(G,2),ce=i(re);ce.__click=[ca,v,E,t];var ge=o(ce,2);ge.__click=[Ur,m,u,t,b,x,v,E,l];var xe=i(ge,!0);n(ge),n(re),n(W),n(ie),n(M),q(te=>{A(N,v()?"Edit Separating Function":"Add New Separating Function"),A(H,v()?"Update separating function details":"Define a new separating function"),ge.disabled=te,A(xe,v()?"Update Function":"Add Function")},[()=>!e(m).trim()||!e(u).trim()]),Ue(S,()=>e(m),te=>r(m,te)),Ue(I,()=>e(u),te=>r(u,te)),Ue(L,()=>e(b),te=>r(b,te)),_(k,M)};B(p,k=>{l()&&k(y)})}_(s,c),Xe()}rt(["click"]);function Hr(s,t,l,g,v,m,u,b,x,E){!e(t)||!e(l)||!e(g)||e(t)===e(l)||(v.onSave({sourceId:e(t),targetId:e(l),status:e(g),description:e(m)||void 0,refs:e(u),separatingFunctionIds:e(b).length>0?e(b):void 0}),x(),E(!1))}function ga(s,t,l){t(),l.onClose()}var Xr=s=>s.stopPropagation(),Gr=w("<option> </option>"),Wr=w("<option> </option>"),Jr=w("<option> </option>"),Yr=w('<p class="text-xs text-gray-500 mt-1"> </p>'),Zr=(s,t,l)=>t(e(l)),$r=w('<button type="button"> </button>'),en=w('<fieldset><legend class="block text-sm font-medium text-gray-700 mb-2">References</legend> <div class="flex flex-wrap gap-2"></div></fieldset>'),tn=(s,t,l)=>t(e(l).shortName),an=w('<button type="button"> </button>'),rn=w('<p class="text-xs text-gray-500 mt-2"> </p>'),nn=w('<fieldset class="border-t pt-4"><legend class="block text-sm font-medium text-gray-700 mb-2">Separating Functions (optional)</legend> <div class="flex flex-wrap gap-2"></div> <!></fieldset>'),on=w('<div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"><div class="bg-white rounded-xl shadow-2xl max-w-3xl w-full max-h-[90vh] overflow-y-auto"><div class="bg-gradient-to-r from-blue-600 to-blue-700 px-6 py-4 sticky top-0 z-10"><h2 class="text-2xl font-bold text-white">Manage Relationship</h2> <p class="text-blue-100 mt-1">Add or update transformation relationships</p></div> <div class="p-6 space-y-4"><div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div><label for="rel-source" class="block text-sm font-medium text-gray-700 mb-1">Source Language <span class="text-red-500">*</span></label> <select id="rel-source" class="w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"><option>Select source...</option><!></select></div> <div><label for="rel-target" class="block text-sm font-medium text-gray-700 mb-1">Target Language <span class="text-red-500">*</span></label> <select id="rel-target" class="w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"><option>Select target...</option><!></select></div></div> <div><label for="rel-status" class="block text-sm font-medium text-gray-700 mb-1">Classification <span class="text-red-500">*</span></label> <select id="rel-status" class="w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"><option>Select classification...</option><!></select> <!></div> <div><label for="rel-description" class="block text-sm font-medium text-gray-700 mb-1">Description</label> <textarea id="rel-description" rows="3" class="w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-y" placeholder="Describe this transformation relationship (optional)..."></textarea></div> <!> <!> <div class="flex gap-3 justify-end pt-4 border-t"><button type="button" class="px-4 py-2 border-2 border-gray-300 text-gray-700 font-medium rounded-lg hover:bg-gray-50 transition-colors">Cancel</button> <button type="button" class="px-4 py-2 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors">Save Relationship</button></div></div></div></div>');function sn(s,t){He(t,!0);let l=be(t,"isOpen",15,!1),g=be(t,"availableRefs",19,()=>[]),v=be(t,"availableSeparatingFunctions",19,()=>[]),m=be(t,"baselineRelations",19,()=>new Map),u=D(""),b=D(""),x=D(""),E=D(""),F=D(Ie([])),c=D(Ie([]));Pe(()=>{l()&&t.initialData&&(r(u,t.initialData.sourceId,!0),r(b,t.initialData.targetId,!0),r(x,t.initialData.status,!0),r(E,t.initialData.description||"",!0),r(F,[...t.initialData.refs],!0),t.initialData.separatingFunctionIds?r(c,[...t.initialData.separatingFunctionIds],!0):t.initialData.separatingFunctions?r(c,t.initialData.separatingFunctions.map(Q=>Q.shortName),!0):r(c,[],!0))}),Pe(()=>{if(e(u)&&e(b)&&e(u)!==e(b)){const Q=`${e(u)}->${e(b)}`,N=m().get(Q);N&&(r(x,N.status,!0),r(F,[...N.refs],!0),N.separatingFunctionIds?r(c,[...N.separatingFunctionIds],!0):N.separatingFunctions?r(c,N.separatingFunctions.map(X=>X.shortName),!0):r(c,[],!0))}});function p(){r(u,""),r(b,""),r(x,""),r(E,""),r(F,[],!0),r(c,[],!0)}function y(Q){e(F).includes(Q)?r(F,e(F).filter(N=>N!==Q),!0):r(F,[...e(F),Q],!0)}function k(Q){e(c).includes(Q)?r(c,e(c).filter(N=>N!==Q),!0):r(c,[...e(c),Q],!0)}var M=Ve(),ie=Ke(M);{var ae=Q=>{var N=on();N.__click=[ga,p,t];var X=i(N);X.__click=[Xr];var H=o(i(X),2),W=i(H),z=i(W),S=o(i(z),2),f=i(S);f.value=f.__value="";var I=o(f);de(I,17,()=>t.languages,ue,(K,Z)=>{var V=Gr(),we=i(V,!0);n(V);var $={};q(()=>{A(we,e(Z).name),$!==($=e(Z).name)&&(V.value=(V.__value=e(Z).name)??"")}),_(K,V)}),n(S),n(z);var C=o(z,2),L=o(i(C),2),G=i(L);G.value=G.__value="";var J=o(G);de(J,17,()=>t.languages,ue,(K,Z)=>{var V=Wr(),we=i(V,!0);n(V);var $={};q(()=>{V.disabled=e(Z).name===e(u),A(we,e(Z).name),$!==($=e(Z).name)&&(V.value=(V.__value=e(Z).name)??"")}),_(K,V)}),n(L),n(C),n(W);var re=o(W,2),ce=o(i(re),2),ge=i(ce);ge.value=ge.__value="";var xe=o(ge);de(xe,17,()=>t.statusOptions,ue,(K,Z)=>{var V=Jr(),we=i(V,!0);n(V);var $={};q(()=>{A(we,e(Z).label),$!==($=e(Z).value)&&(V.value=(V.__value=e(Z).value)??"")}),_(K,V)}),n(ce);var te=o(ce,2);{var he=K=>{const Z=j(()=>t.statusOptions.find(le=>le.value===e(x)));var V=Ve(),we=Ke(V);{var $=le=>{var Ee=Yr(),P=i(Ee,!0);n(Ee),q(()=>A(P,e(Z).description)),_(le,Ee)};B(we,le=>{e(Z)&&le($)})}_(K,V)};B(te,K=>{e(x)&&K(he)})}n(re);var oe=o(re,2),Y=o(i(oe),2);bt(Y),n(oe);var se=o(oe,2);{var me=K=>{var Z=en(),V=o(i(Z),2);de(V,21,g,ue,(we,$)=>{var le=$r();le.__click=[Zr,y,$];var Ee=i(le,!0);n(le),q(P=>{Be(le,1,P),A(Ee,e($))},[()=>`px-3 py-1 text-sm rounded-lg border-2 transition-colors ${e(F).includes(e($))?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-300 hover:border-blue-300"}`]),_(we,le)}),n(V),n(Z),_(K,Z)};B(se,K=>{g().length>0&&K(me)})}var _e=o(se,2);{var Me=K=>{var Z=nn(),V=o(i(Z),2);de(V,21,v,ue,(le,Ee)=>{var P=an();P.__click=[tn,k,Ee];var U=i(P,!0);n(P),q(Te=>{Be(P,1,Te),ze(P,"title",e(Ee).name),A(U,e(Ee).shortName)},[()=>`px-3 py-1 text-sm rounded-lg border-2 transition-colors ${e(c).includes(e(Ee).shortName)?"bg-orange-600 text-white border-orange-600":"bg-white text-gray-700 border-gray-300 hover:border-orange-300"}`]),_(le,P)}),n(V);var we=o(V,2);{var $=le=>{var Ee=rn(),P=i(Ee);n(Ee),q(U=>A(P,`Selected: ${U??""}`),[()=>e(c).join(", ")]),_(le,Ee)};B(we,le=>{e(c).length>0&&le($)})}n(Z),_(K,Z)};B(_e,K=>{v().length>0&&K(Me)})}var Fe=o(_e,2),Oe=i(Fe);Oe.__click=[ga,p,t];var Le=o(Oe,2);Le.__click=[Hr,u,b,x,t,E,F,c,p,l],n(Fe),n(H),n(X),n(N),q(()=>Le.disabled=!e(u)||!e(b)||!e(x)||e(u)===e(b)),ot(S,()=>e(u),K=>r(u,K)),ot(L,()=>e(b),K=>r(b,K)),ot(ce,()=>e(x),K=>r(x,K)),Ue(Y,()=>e(E),K=>r(E,K)),_(Q,N)};B(ie,Q=>{l()&&Q(ae)})}_(s,M),Xe()}rt(["click"]);function ln(s){const t=s.match(/author\s*=\s*[{"']([^}"']+)[}"']/i);let l="Unknown";if(t){const u=t[1].split(/\s+and\s+/i)[0].trim();if(u.includes(","))l=u.split(",")[0].trim();else{const b=u.trim().split(/\s+/);l=b[b.length-1]}l=l.replace(/[{}]/g,"").trim()}const g=s.match(/year\s*=\s*[{"']?(\d{4})[}"']?/i),v=g?g[1]:"XXXX";return{author:l,year:v}}function yt(s,t){const l=ln(s);if(!l){let u="Reference_Unknown",b=1;for(;t.has(u);)u=`Reference_Unknown_${b}`,b++;return u}const g=`${l.author}_${l.year}`;if(!t.has(g))return g;const v="abcdefghijklmnopqrstuvwxyz".split("");for(const u of v){const b=`${g}_${u}`;if(!t.has(b))return b}let m=1;for(;t.has(`${g}_${m}`);)m++;return`${g}_${m}`}function Ze(s,t){return`${s}->${t}`}function dn(s){const t=new Map,{languageIds:l,matrix:g}=s;for(let v=0;v<l.length;v++)for(let m=0;m<l.length;m++){const u=g[v][m];if(u){const b=l[v],x=l[m];let E,F=[];u.separatingFunctionIds&&Array.isArray(u.separatingFunctionIds)?E=[...u.separatingFunctionIds]:u.separatingFunctions&&Array.isArray(u.separatingFunctions)&&(F=u.separatingFunctions.map(c=>({shortName:c.shortName,name:c.name,description:c.description,refs:[...c.refs]}))),t.set(Ze(b,x),{status:u.status,refs:u.refs?[...u.refs]:[],separatingFunctionIds:E,separatingFunctions:F})}}return t}function _t(s,t){const l=s.map(m=>m.id),g=new Set(l),v=t.map(m=>{const u=yt(m,g);return g.add(u),u});return[...l,...v]}function un(s,t,l){const g=s.map(u=>({name:u.name})),v=t.map(u=>({name:u.name})),m=l.map(u=>({name:u.name}));return[...g,...v,...m]}function cn(s){return{name:s.name,fullName:s.fullName||"",description:s.description||"",descriptionRefs:s.descriptionRefs||[],queries:s.properties?.queries||{},transformations:s.properties?.transformations||{},tags:(s.tags||[]).map(t=>({...t,color:t.color||"#6366f1"})),existingReferences:s.references?.map(t=>t.id)||[]}}function gn(s,t){const l=s.map(v=>({shortName:v.shortName,name:v.name,description:v.description})),g=t.map(v=>({shortName:v.shortName,name:v.name,description:v.description}));return[...l,...g]}var vn=w('<span class="text-sm font-bold text-gray-900"> </span>'),fn=w('<span class="text-sm text-gray-600">( <!> )</span>'),bn=(s,t)=>t.onToggleExpand(t.index),mn=(s,t)=>t.onEdit(t.index),pn=(s,t)=>t.onDelete(t.index),xn=w("<div><!></div>"),_n=w('<div><div class="flex items-center justify-between"><div class="flex items-center gap-2"><span> </span> <!> <!></div> <div class="flex items-center gap-2"><button type="button"> </button> <button type="button" class="px-2 py-1 text-xs bg-blue-100 hover:bg-blue-200 text-blue-800 rounded border border-blue-300" aria-label="Edit">Edit</button> <button type="button" class="px-2 py-1 text-xs bg-red-100 hover:bg-red-200 text-red-800 rounded border border-red-300" aria-label="Delete">Delete</button></div></div> <!></div>');function ht(s,t){He(t,!0);let l=be(t,"colorScheme",3,"purple"),g=be(t,"isExpanded",3,!1),v=be(t,"renderMathTitle",3,!0),m=be(t,"renderMathSubtitle",3,!0);const b={purple:{border:"border-purple-300",bg:"bg-purple-50",text:"text-purple-800",button:"bg-purple-100 hover:bg-purple-200 text-purple-800 border-purple-300",divider:"border-purple-200"},orange:{border:"border-orange-300",bg:"bg-orange-50",text:"text-orange-800",button:"bg-orange-100 hover:bg-orange-200 text-orange-800 border-orange-300",divider:"border-orange-200"},green:{border:"border-green-300",bg:"bg-green-50",text:"text-green-800",button:"bg-green-100 hover:bg-green-200 text-green-800 border-green-300",divider:"border-green-200"},yellow:{border:"border-yellow-300",bg:"bg-yellow-50",text:"text-yellow-800",button:"bg-yellow-100 hover:bg-yellow-200 text-yellow-800 border-yellow-300",divider:"border-yellow-200"},blue:{border:"border-blue-300",bg:"bg-blue-50",text:"text-blue-800",button:"bg-blue-100 hover:bg-blue-200 text-blue-800 border-blue-300",divider:"border-blue-200"}}[l()];var x=_n(),E=i(x),F=i(E),c=i(F),p=i(c);n(c);var y=o(c,2);{var k=f=>{Je(f,{get text(){return t.title},className:"text-sm font-bold text-gray-900"})},M=f=>{var I=vn(),C=i(I,!0);n(I),q(()=>A(C,t.title)),_(f,I)};B(y,f=>{v()?f(k):f(M,!1)})}var ie=o(y,2);{var ae=f=>{var I=fn(),C=o(i(I));{var L=J=>{Je(J,{get text(){return t.subtitle},className:"inline"})},G=J=>{var re=ir();q(()=>A(re,t.subtitle)),_(J,re)};B(C,J=>{m()?J(L):J(G,!1)})}at(),n(I),_(f,I)};B(ie,f=>{t.subtitle&&f(ae)})}n(F);var Q=o(F,2),N=i(Q);N.__click=[bn,t];var X=i(N,!0);n(N);var H=o(N,2);H.__click=[mn,t];var W=o(H,2);W.__click=[pn,t],n(Q),n(E);var z=o(E,2);{var S=f=>{var I=xn(),C=i(I);{var L=G=>{var J=Ve(),re=Ke(J);or(re,()=>t.children),_(G,J)};B(C,G=>{t.children&&G(L)})}n(I),q(()=>Be(I,1,`mt-4 pt-4 border-t ${b.divider??""}`)),_(f,I)};B(z,f=>{g()&&f(S)})}n(x),q(()=>{Be(x,1,`border-2 ${b.border??""} ${b.bg??""} rounded-lg p-3`),Be(c,1,`text-sm font-semibold ${b.text??""}`),A(p,`${t.type??""}:`),Be(N,1,`px-2 py-1 text-xs ${b.button??""} rounded border`),ze(N,"aria-label",g()?"Collapse":"Expand"),A(X,g()?"Collapse":"Expand")}),_(s,x),Xe()}rt(["click"]);var yn=w('<div class="text-gray-500 text-xs"> </div>'),hn=w('<div class="bg-white p-2 rounded border"><div class="font-medium"> </div> <div class="text-gray-600"> </div> <!> <!></div>'),wn=w('<div><div class="font-semibold text-gray-700 mb-1"> </div> <div class="grid grid-cols-2 gap-2"></div></div>'),En=w('<div class="text-gray-500 text-xs"> </div>'),kn=w('<div class="bg-white p-2 rounded border"><div class="font-medium"> </div> <div class="text-gray-600"> </div> <!> <!></div>'),Rn=w('<div><div class="font-semibold text-gray-700 mb-1"> </div> <div class="grid grid-cols-2 gap-2"></div></div>'),Sn=w('<div class="bg-white p-2 rounded border"><div class="font-medium"> </div> <div class="text-gray-600"> </div></div>'),In=w('<div><div class="font-semibold text-gray-700 mb-1"> </div> <div class="space-y-2"></div></div>'),Fn=w('<div class="space-y-3 text-xs"><div><div class="font-semibold text-gray-700 mb-1">Full Name:</div> <!></div> <div><div class="font-semibold text-gray-700 mb-1">Description:</div> <!></div> <!> <!> <!></div>');function va(s,t){He(t,!0);let l=be(t,"isExpanded",3,!1),g=be(t,"isEdit",3,!1);const v=g()?"yellow":"green";{const m=b=>{var x=Fn(),E=i(x),F=o(i(E),2);Je(F,{get text(){return t.language.fullName},className:"text-gray-900 block"}),n(E);var c=o(E,2),p=o(i(c),2);Je(p,{get text(){return t.language.description},className:"text-gray-900 block"}),n(c);var y=o(c,2);{var k=N=>{var X=wn(),H=i(X),W=i(H);n(H);var z=o(H,2);de(z,21,()=>Object.entries(t.language.queries),ue,(S,f)=>{var I=j(()=>sa(e(f),2));let C=()=>e(I)[0],L=()=>e(I)[1];var G=hn(),J=i(G),re=i(J,!0);n(J);var ce=o(J,2),ge=i(ce,!0);n(ce);var xe=o(ce,2);{var te=Y=>{Je(Y,{get text(){return L().note},className:"text-gray-500 italic text-xs block"})};B(xe,Y=>{L().note&&Y(te)})}var he=o(xe,2);{var oe=Y=>{var se=yn(),me=i(se);n(se),q(_e=>A(me,`Refs: [${_e??""}]`),[()=>L().refs.join(", ")]),_(Y,se)};B(he,Y=>{L().refs.length>0&&Y(oe)})}n(G),q(()=>{A(re,C()),A(ge,L().polytime)}),_(S,G)}),n(z),n(X),q(S=>A(W,`Query Support (${S??""}):`),[()=>Object.keys(t.language.queries).length]),_(N,X)};B(y,N=>{t.language.queries&&Object.keys(t.language.queries).length>0&&N(k)})}var M=o(y,2);{var ie=N=>{var X=Rn(),H=i(X),W=i(H);n(H);var z=o(H,2);de(z,21,()=>Object.entries(t.language.transformations),ue,(S,f)=>{var I=j(()=>sa(e(f),2));let C=()=>e(I)[0],L=()=>e(I)[1];var G=kn(),J=i(G),re=i(J,!0);n(J);var ce=o(J,2),ge=i(ce,!0);n(ce);var xe=o(ce,2);{var te=Y=>{Je(Y,{get text(){return L().note},className:"text-gray-500 italic text-xs block"})};B(xe,Y=>{L().note&&Y(te)})}var he=o(xe,2);{var oe=Y=>{var se=En(),me=i(se);n(se),q(_e=>A(me,`Refs: [${_e??""}]`),[()=>L().refs.join(", ")]),_(Y,se)};B(he,Y=>{L().refs.length>0&&Y(oe)})}n(G),q(()=>{A(re,C()),A(ge,L().polytime)}),_(S,G)}),n(z),n(X),q(S=>A(W,`Transformation Support (${S??""}):`),[()=>Object.keys(t.language.transformations).length]),_(N,X)};B(M,N=>{t.language.transformations&&Object.keys(t.language.transformations).length>0&&N(ie)})}var ae=o(M,2);{var Q=N=>{var X=In(),H=i(X),W=i(H);n(H);var z=o(H,2);de(z,21,()=>t.language.tags,ue,(S,f)=>{var I=Sn(),C=i(I),L=i(C,!0);n(C);var G=o(C,2),J=i(G,!0);n(G),n(I),q(()=>{A(L,e(f).label),A(J,e(f).description||"No description")}),_(S,I)}),n(z),n(X),q(()=>A(W,`Tags (${t.language.tags.length??""}):`)),_(N,X)};B(ae,N=>{t.language.tags.length>0&&N(Q)})}n(x),_(b,x)};let u=j(()=>g()?"Edit Language":"New Language");ht(s,{get type(){return e(u)},get title(){return t.language.name},get subtitle(){return t.language.description},get colorScheme(){return v},get index(){return t.index},get isExpanded(){return l()},get onToggleExpand(){return t.onToggleExpand},get onEdit(){return t.onEdit},get onDelete(){return t.onDelete},children:m,$$slots:{default:!0}})}Xe()}var Tn=w('<pre class="text-xs bg-white p-2 rounded border border-purple-200 overflow-x-auto"> </pre>');function Dn(s,t){let l=be(t,"isExpanded",3,!1);ht(s,{type:"Reference",get title(){return`new-${t.index??""}`},renderMathTitle:!1,renderMathSubtitle:!1,colorScheme:"purple",get index(){return t.index},get isExpanded(){return l()},get onToggleExpand(){return t.onToggleExpand},get onEdit(){return t.onEdit},get onDelete(){return t.onDelete},children:v=>{var m=Tn(),u=i(m,!0);n(m),q(()=>A(u,t.reference)),_(v,m)},$$slots:{default:!0}})}var An=w('<div><span class="text-xs font-semibold text-gray-700">Description:</span> <!></div>'),Nn=w('<div><span class="text-xs font-semibold text-gray-700">References:</span> <span class="text-xs text-gray-600 ml-2"> </span></div>'),Ln=w('<div class="space-y-2"><div><span class="text-xs font-semibold text-gray-700">Short Name:</span> <!></div> <div><span class="text-xs font-semibold text-gray-700">Full Name:</span> <!></div> <!> <!></div>');function Mn(s,t){He(t,!0),ht(s,{type:"SF",get title(){return t.separatingFunction.shortName},get subtitle(){return t.separatingFunction.name},colorScheme:"orange",get index(){return t.index},get isExpanded(){return t.isExpanded},get onToggleExpand(){return t.onToggleExpand},get onEdit(){return t.onEdit},get onDelete(){return t.onDelete},children:g=>{var v=Ln(),m=i(v),u=o(i(m),2);Je(u,{get text(){return t.separatingFunction.shortName},className:"text-xs text-gray-900 ml-2 inline"}),n(m);var b=o(m,2),x=o(i(b),2);Je(x,{get text(){return t.separatingFunction.name},className:"text-xs text-gray-900 ml-2 inline"}),n(b);var E=o(b,2);{var F=y=>{var k=An(),M=o(i(k),2);Je(M,{get text(){return t.separatingFunction.description},className:"text-xs text-gray-700 mt-1 block"}),n(k),_(y,k)};B(E,y=>{t.separatingFunction.description&&y(F)})}var c=o(E,2);{var p=y=>{var k=Nn(),M=o(i(k),2),ie=i(M,!0);n(M),n(k),q(ae=>A(ie,ae),[()=>t.separatingFunction.refs.join(", ")]),_(y,k)};B(c,y=>{t.separatingFunction.refs&&t.separatingFunction.refs.length>0&&y(p)})}n(v),_(g,v)},$$slots:{default:!0}}),Xe()}var On=w('<div class="text-gray-500 text-xs mt-1"> </div>'),jn=w('<div class="bg-white p-2 rounded border"><div class="font-medium"> </div> <div class="text-gray-600 text-xs"> </div> <div class="text-gray-500 italic text-xs"> </div> <!></div>'),Cn=w('<div><div class="font-semibold text-gray-700 mb-1"> </div> <div class="space-y-2"></div></div>'),qn=w('<div><div class="font-semibold text-gray-700 mb-1">References:</div> <div class="text-gray-600"> </div></div>'),Un=w('<div class="space-y-3 text-xs"><div><div class="font-semibold text-gray-700 mb-1">Transformation Status:</div> <div class="bg-white p-2 rounded border"><span class="font-mono text-gray-900"> </span></div></div> <!> <!></div>');function Pn(s,t){He(t,!0);let l=be(t,"isExpanded",3,!1),g=be(t,"isModified",3,!1);const v=Ze(t.relationship.sourceId,t.relationship.targetId),m=`${t.relationship.sourceId} → ${t.relationship.targetId}`;var u=Ve(),b=Ke(u);{var x=E=>{ht(E,{type:"Relationship",get title(){return m},get subtitle(){return t.relationship.status},colorScheme:"blue",get index(){return t.index},get isExpanded(){return l()},get onToggleExpand(){return t.onToggleExpand},onEdit:()=>t.onEdit(t.index),onDelete:()=>t.onDelete(t.index,v),children:c=>{var p=Un(),y=i(p),k=o(i(y),2),M=i(k),ie=i(M,!0);n(M),n(k),n(y);var ae=o(y,2);{var Q=H=>{var W=Cn(),z=i(W),S=i(z);n(z);var f=o(z,2);de(f,21,()=>t.relationship.separatingFunctions,ue,(I,C)=>{var L=jn(),G=i(L),J=i(G,!0);n(G);var re=o(G,2),ce=i(re);n(re);var ge=o(re,2),xe=i(ge,!0);n(ge);var te=o(ge,2);{var he=oe=>{var Y=On(),se=i(Y);n(Y),q(me=>A(se,`Refs: [${me??""}]`),[()=>e(C).refs.join(", ")]),_(oe,Y)};B(te,oe=>{e(C).refs&&e(C).refs.length>0&&oe(he)})}n(L),q(()=>{A(J,e(C).name),A(ce,`Short: ${e(C).shortName??""}`),A(xe,e(C).description)}),_(I,L)}),n(f),n(W),q(()=>A(S,`Separating Functions (${t.relationship.separatingFunctions.length??""}):`)),_(H,W)};B(ae,H=>{t.relationship.separatingFunctions&&t.relationship.separatingFunctions.length>0&&H(Q)})}var N=o(ae,2);{var X=H=>{var W=qn(),z=o(i(W),2),S=i(z,!0);n(z),n(W),q(f=>A(S,f),[()=>t.relationship.refs.join(", ")]),_(H,W)};B(N,H=>{t.relationship.refs&&t.relationship.refs.length>0&&H(X)})}n(p),q(()=>A(ie,t.relationship.status)),_(c,p)},$$slots:{default:!0}})};B(b,E=>{g()&&E(x)})}_(s,u),Xe()}var Bn=w('<div class="text-center py-8 text-gray-500 italic">No changes queued yet. Use the buttons below to add items.</div>'),Qn=w(`<div class="space-y-3"><h2 class="text-lg font-bold text-gray-900">Queued Changes</h2> <p class="text-sm text-gray-600">Items you've added will appear here.</p> <div class="space-y-2"><!> <!> <!> <!> <!> <!></div></div>`);function zn(s,t){He(t,!0);const l=j(()=>t.languagesToAdd.length>0||t.languagesToEdit.length>0||t.newReferences.length>0||t.newSeparatingFunctions.length>0||t.relationships.filter(p=>t.modifiedRelations.has(Ze(p.sourceId,p.targetId))).length>0);var g=Qn(),v=o(i(g),4),m=i(v);de(m,17,()=>t.newReferences,ue,(p,y,k)=>{{let M=j(()=>t.expandedReferenceIndex===k);Dn(p,{get reference(){return e(y)},index:k,get isExpanded(){return e(M)},get onToggleExpand(){return t.onToggleExpandReference},get onEdit(){return t.onEditReference},get onDelete(){return t.onDeleteReference}})}});var u=o(m,2);de(u,17,()=>t.newSeparatingFunctions,ue,(p,y,k)=>{{let M=j(()=>t.expandedSeparatingFunctionIndex===k);Mn(p,{get separatingFunction(){return e(y)},index:k,get isExpanded(){return e(M)},get onToggleExpand(){return t.onToggleExpandSeparatingFunction},get onEdit(){return t.onEditSeparatingFunction},get onDelete(){return t.onDeleteSeparatingFunction}})}});var b=o(u,2);de(b,17,()=>t.languagesToAdd,ue,(p,y,k)=>{{let M=j(()=>t.expandedLanguageToAddIndex===k);va(p,{get language(){return e(y)},index:k,get isExpanded(){return e(M)},isEdit:!1,get onToggleExpand(){return t.onToggleExpandLanguageToAdd},get onEdit(){return t.onEditLanguageToAdd},get onDelete(){return t.onDeleteLanguageToAdd}})}});var x=o(b,2);de(x,17,()=>t.languagesToEdit,ue,(p,y,k)=>{{let M=j(()=>t.expandedLanguageToEditIndex===k);va(p,{get language(){return e(y)},index:k,get isExpanded(){return e(M)},isEdit:!0,get onToggleExpand(){return t.onToggleExpandLanguageToEdit},get onEdit(){return t.onEditLanguageToEdit},get onDelete(){return t.onDeleteLanguageToEdit}})}});var E=o(x,2);de(E,17,()=>t.relationships,ue,(p,y,k)=>{const M=j(()=>t.modifiedRelations.has(Ze(e(y).sourceId,e(y).targetId)));{let ie=j(()=>t.expandedRelationshipIndex===k);Pn(p,{get relationship(){return e(y)},index:k,get isModified(){return e(M)},get isExpanded(){return e(ie)},get onToggleExpand(){return t.onToggleExpandRelationship},get onEdit(){return t.onEditRelationship},get onDelete(){return t.onDeleteRelationship}})}});var F=o(E,2);{var c=p=>{var y=Bn();_(p,y)};B(F,p=>{e(l)||p(c)})}n(v),n(g),_(s,g),Xe()}var Kn=w('<div class="grid grid-cols-2 md:grid-cols-5 gap-3"><button type="button" class="px-3 py-3 bg-green-600 hover:bg-green-700 text-white font-medium rounded-lg transition-colors">New Language</button> <button type="button" class="px-3 py-3 bg-yellow-600 hover:bg-yellow-700 text-white font-medium rounded-lg transition-colors">Edit Language</button> <button type="button" class="px-3 py-3 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors">Relationship</button> <button type="button" class="px-3 py-3 bg-purple-600 hover:bg-purple-700 text-white font-medium rounded-lg transition-colors">Reference</button> <button type="button" class="px-3 py-3 bg-orange-600 hover:bg-orange-700 text-white font-medium rounded-lg transition-colors">Separator</button></div>');function Vn(s,t){var l=Kn(),g=i(l);g.__click=function(...x){t.onAddLanguage?.apply(this,x)};var v=o(g,2);v.__click=function(...x){t.onEditLanguage?.apply(this,x)};var m=o(v,2);m.__click=function(...x){t.onManageRelationships?.apply(this,x)};var u=o(m,2);u.__click=function(...x){t.onAddReference?.apply(this,x)};var b=o(u,2);b.__click=function(...x){t.onAddSeparatingFunction?.apply(this,x)},n(l),_(s,l)}rt(["click"]);var Hn=w('<div class="pt-6"><button type="submit" class="group relative w-full px-8 py-4 bg-gradient-to-r from-indigo-600 to-purple-700 text-white font-bold text-lg rounded-xl hover:from-indigo-700 hover:to-purple-800 disabled:from-gray-400 disabled:to-gray-500 disabled:cursor-not-allowed transition-all duration-300 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 active:translate-y-0"><span class="flex items-center justify-center"><svg class="w-5 h-5 mr-2 transition-transform group-hover:scale-110" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path></svg> Preview Changes</span></button> <p class="text-center text-sm text-gray-500 mt-4">Preview your changes on the graph before submitting</p></div>');function Xn(s,t){let l=be(t,"disabled",3,!1);var g=Hn(),v=i(g);at(2),n(g),q(()=>v.disabled=l()),_(s,g)}function Gn(s){const t=s.match(/@\w+\{([^,\s]+)/);return t?t[1]:null}function jt(s,t){const l=[];for(const g of s.descriptionRefs){const v=t.get(g);v&&l.push(v)}return{name:s.name,fullName:s.fullName,description:s.description,descriptionRefs:[...s.descriptionRefs],properties:{queries:s.queries,transformations:s.transformations},tags:s.tags,references:l}}function Wn(s,t){const l=Xa(s),g=c=>{const{adjacencyMatrix:p}=l;if(c in p.indexByLanguage)return;const y=p.languageIds.length;p.languageIds.push(c),p.indexByLanguage[c]=y;for(const k of p.matrix)k.push(null);p.matrix.push(new Array(y+1).fill(null))},v=new Map;for(const c of l.languages)if(c.references)for(const p of c.references)v.set(p.id,p);const m=new Set(v.keys()),u=new Map;if(l.separatingFunctions)for(const c of l.separatingFunctions)u.set(c.shortName,c);const b=new Set(t.modifiedRelations??[]),x=c=>{const p={shortName:c.shortName,name:c.name,description:c.description,refs:[...c.refs]};u.set(p.shortName,p),l.separatingFunctions=[...l.separatingFunctions??[],p]},E=c=>{g(c.sourceId),g(c.targetId);const p=l.adjacencyMatrix.indexByLanguage[c.sourceId],y=l.adjacencyMatrix.indexByLanguage[c.targetId];if(p===void 0||y===void 0)return;const k=`${c.sourceId}->${c.targetId}`;if(b.size>0&&!b.has(k)&&l.adjacencyMatrix.matrix[p]?.[y])return;const M=[];if(c.separatingFunctionIds&&c.separatingFunctionIds.length>0)for(const ae of c.separatingFunctionIds){const Q=u.get(ae);Q&&M.push({shortName:Q.shortName,name:Q.name,description:Q.description,refs:[...Q.refs]})}else if(c.separatingFunctions)for(const ae of c.separatingFunctions)M.push({shortName:ae.shortName,name:ae.name,description:ae.description,refs:[...ae.refs]});const ie={status:c.status,refs:[...c.refs],separatingFunctions:M};l.adjacencyMatrix.matrix[p][y]=ie};for(const c of t.entries)switch(c.kind){case"reference":{const p=c.payload,y=yt(p,m);m.add(y);const k=Gn(p),M={id:y,title:k||y,href:"",bibtex:p};v.set(y,M);break}case"separator":{x(c.payload);break}case"language:new":{const p=jt(c.payload,v);l.languages.push(p),g(c.payload.name);break}case"language:edit":{const p=l.languages.findIndex(y=>y.name===c.payload.name);if(p===-1){const y=jt(c.payload,v);l.languages.push(y),g(c.payload.name)}else l.languages[p]=jt(c.payload,v);break}case"relationship":{E(c.payload);break}}const F=Ga(l);if(!F.ok){const c=F.errors?.join("; ")??"unknown structural error";throw new Error(`Contribution queue produced an invalid dataset: ${c}`)}return Wa(l)}function fa(s,t,l){const g=!e(t);r(t,g),g&&r(l,Ct(),!0)}function Jn(s,t){r(t,null)}var Yn=w('<div class="mr-auto mb-3 flex items-center gap-3 rounded-lg border border-amber-300 bg-amber-50 px-4 py-2 text-sm text-amber-800 shadow-sm"><span class="font-medium">Editing prior submission</span> <button type="button" class="rounded-md border border-amber-400 px-2 py-1 text-xs font-semibold text-amber-700 transition-colors hover:bg-amber-100">Stop</button></div>'),Zn=w('<p class="text-sm text-gray-500">No saved submissions yet. Submit once to keep a snapshot.</p>'),$n=w('<div class="text-xs font-medium text-amber-600">Superseded</div>'),ei=w('<div class="text-xs font-medium text-emerald-600">Currently editing clone</div>'),ti=(s,t,l)=>t(e(l)),ai=w('<li class="rounded-md border border-gray-200 bg-white px-3 py-2 shadow-sm"><div class="flex items-start justify-between gap-3"><div class="space-y-1"><div class="text-sm font-medium text-gray-800"> </div> <div class="text-xs text-gray-600"> </div> <!></div> <button type="button" class="rounded-md border border-blue-500 px-3 py-1 text-xs font-semibold text-blue-600 transition-colors hover:bg-blue-50">Load</button></div></li>'),ri=w('<ul class="space-y-3 max-h-64 overflow-y-auto pr-1"></ul>'),ni=w('<div class="mb-6 rounded-lg border border-gray-200 bg-gradient-to-br from-gray-50 to-white p-4 shadow-sm"><div class="mb-3 flex items-center justify-between"><h3 class="text-sm font-semibold text-gray-800">Previous submissions</h3> <button type="button" class="rounded-md px-2 py-1 text-xs font-medium text-gray-500 hover:bg-gray-200/70 hover:text-gray-700">Close</button></div> <!></div>'),ii=(s,t)=>r(t,!1),oi=s=>s.stopPropagation(),si=w("<option> </option>"),li=(s,t,l)=>{r(t,""),r(l,!1)},di=(s,t,l,g)=>{e(t)&&(r(l,!1),r(g,!0))},ui=w('<div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"><div class="bg-white rounded-xl shadow-2xl max-w-md w-full"><div class="bg-gradient-to-r from-yellow-600 to-yellow-700 px-6 py-4"><h2 class="text-2xl font-bold text-white">Select Language to Edit</h2> <p class="text-yellow-100 mt-1">Choose an existing language</p></div> <div class="p-6"><label for="language-selector" class="block text-sm font-medium text-gray-700 mb-2">Language <span class="text-red-500">*</span></label> <select id="language-selector" class="w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-yellow-500"><option>Choose a language...</option><!></select> <div class="flex gap-3 justify-end pt-4 mt-4 border-t"><button type="button" class="px-4 py-2 border-2 border-gray-300 text-gray-700 font-medium rounded-lg hover:bg-gray-50 transition-colors">Cancel</button> <button type="button" class="px-4 py-2 bg-yellow-600 text-white font-medium rounded-lg hover:bg-yellow-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors">Edit</button></div></div></div></div>'),ci=w('<div class="min-h-screen bg-gradient-to-br from-blue-50 via-white to-emerald-50 py-12 px-4 sm:px-6 lg:px-8"><div class="max-w-4xl mx-auto"><div class="text-center mb-12"><h1 class="text-5xl font-extrabold text-gray-900 mb-4 tracking-tight">Contribute to the KC Map</h1> <p class="text-xl text-gray-600 max-w-2xl mx-auto leading-relaxed">Help improve the Knowledge Compilation Map by adding new languages or updating existing ones.</p> <p class="mt-4"><a href="https://github.com/dkahdian/kcm" target="_blank" rel="noopener noreferrer" class="inline-flex items-center gap-2 text-blue-600 hover:text-blue-800 font-medium"><svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"></path></svg> View on GitHub</a></p></div> <div class="bg-white rounded-2xl shadow-2xl overflow-hidden border border-gray-100"><div class="bg-gradient-to-r from-blue-600 to-blue-700 px-8 py-6"><h2 class="text-2xl font-bold text-white">Submission Form</h2> <p class="text-blue-100 mt-1">Fill out the details below to contribute</p></div> <div class="p-8 sm:p-10"><form class="space-y-8"><div class="bg-gradient-to-r from-blue-50 to-indigo-50 p-6 rounded-xl border border-blue-200"><h2 class="text-lg font-bold text-gray-900 mb-4">Contributor Information</h2> <div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div><label for="contributor-email" class="block text-sm font-medium text-gray-700 mb-1">Email Address <span class="text-red-500">*</span></label> <input type="email" id="contributor-email" required class="w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="your.email@example.com"/></div> <div><label for="contributor-github" class="block text-sm font-medium text-gray-700 mb-1">GitHub Username (optional)</label> <input type="text" id="contributor-github" class="w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="@username"/></div></div> <div class="mt-4"><label for="contributor-note" class="block text-sm font-medium text-gray-700 mb-1">Note (optional)</label> <textarea id="contributor-note" rows="3" class="w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-y" placeholder="Add any clarifications or additional context for your contribution..."></textarea> <p class="mt-1 text-xs text-gray-500">This note will be included in the pull request description.</p></div></div> <div class="flex justify-end"><!> <button type="button" class="mb-3 inline-flex items-center gap-2 rounded-full border border-gray-300 px-3 py-1 text-sm font-medium text-gray-700 shadow-sm transition-colors hover:border-blue-400 hover:text-blue-600"><span aria-hidden="true">🗂️</span> Submission history <svg viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M2 4l4 4 4-4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg></button></div> <!> <!>  <!> <!></form></div></div></div></div> <!> <!> <!> <!> <!> <!>',1);function _i(s,t){He(t,!0);const l=a=>typeof a=="string",g=a=>Array.isArray(a)?a.filter(l):[],v=()=>typeof crypto<"u"&&typeof crypto.randomUUID=="function"?crypto.randomUUID():oa(),m=a=>typeof a=="string"&&a.trim().length>0?a:null;function u(a){if(!Array.isArray(a))return[];const d=[];for(const h of a){if(!h||typeof h!="object")continue;const T=h;l(T.label)&&d.push({label:T.label,color:l(T.color)?T.color:"#6366f1",description:l(T.description)?T.description:void 0,refs:g(T.refs)})}return d}const b=a=>({...a,descriptionRefs:[...a.descriptionRefs],queries:Object.fromEntries(Object.entries(a.queries).map(([d,h])=>[d,{...h,refs:[...h.refs]}])),transformations:Object.fromEntries(Object.entries(a.transformations).map(([d,h])=>[d,{...h,refs:[...h.refs]}])),tags:a.tags.map(d=>({...d,refs:[...d.refs]})),existingReferences:[...a.existingReferences]}),x=a=>({...a,refs:[...a.refs],separatingFunctionIds:a.separatingFunctionIds?[...a.separatingFunctionIds]:void 0,separatingFunctions:a.separatingFunctions?a.separatingFunctions.map(d=>({...d,refs:[...d.refs]})):void 0}),E=a=>({shortName:a.shortName,name:a.name,description:a.description,refs:[...a.refs]}),F=a=>{switch(a.kind){case"language:new":case"language:edit":return{...a,payload:b(a.payload)};case"relationship":return{...a,payload:x(a.payload)};case"separator":return{...a,payload:E(a.payload)};case"reference":default:return{...a,payload:a.payload}}};function c(a){if(!Array.isArray(a.queueEntries)||a.queueEntries.length===0)throw new Error("Submission history entry is missing queueEntries.");return a.queueEntries.map(F)}const p=()=>typeof crypto<"u"&&typeof crypto.randomUUID=="function"?crypto.randomUUID():oa();function y(a){r(f,[...e(f),a],!0)}function k(a,d,h){r(f,e(f).map(T=>T.id===a&&T.kind===d?{...T,payload:h}:T),!0)}function M(a){r(f,e(f).filter(d=>d.id!==a),!0)}const ie=a=>({...a,refs:[...a.refs]}),ae=a=>{try{return new Intl.DateTimeFormat(void 0,{dateStyle:"medium",timeStyle:"short"}).format(new Date(a))}catch{return a}},Q=a=>{const d=[];return a.summary.languagesToAdd&&d.push(`${a.summary.languagesToAdd} new ${a.summary.languagesToAdd===1?"language":"languages"}`),a.summary.languagesToEdit&&d.push(`${a.summary.languagesToEdit} edit${a.summary.languagesToEdit===1?"":"s"}`),a.summary.relationships&&d.push(`${a.summary.relationships} relation${a.summary.relationships===1?"":"s"}`),a.summary.newReferences&&d.push(`${a.summary.newReferences} reference${a.summary.newReferences===1?"":"s"}`),d.length>0?d.join(" · "):"No changes"},N=Object.values(t.data.polytimeOptions),X=t.data.relationTypes.map(a=>({value:a.id,label:a.name,description:a.description??""})),H=dn(t.data.adjacencyMatrix);let W=D(""),z=D(""),S=D(""),f=D(Ie([])),I=D(Ie([])),C=D(Ie([])),L=D(Ie([])),G=D(null),J=D(null),re=D(null),ce=D(null),ge=D(null),xe=D(!1),te=D(!1),he=D(!1),oe=D(""),Y=D(!1),se=D(!1),me=D(!1),_e=D(null),Me=D(null),Fe=D(null),Oe=D(null),Le=D(null),K=D(Ie(new Set)),Z=D(!1),V=D(Ie([])),we=D(Ie([])),$=D(Ie([]));const le=j(()=>e(I).map(a=>a.payload)),Ee=j(()=>e(C).map(a=>a.payload)),P=j(()=>e(V).map(a=>a.bibtex)),U=j(()=>e(we).map(a=>a.payload)),Te=j(()=>e(L).map(a=>a.payload));let ke=D(""),ve=D(null),ne=D(Ie([])),De=D(!1);const Re=j(()=>e(f).length>0||e($).length>0||e(K).size>0);let je=!1;Pe(()=>{const a=e(Re);a&&!je&&!e(ke)&&r(ke,v(),!0),!a&&je&&(r(ke,v(),!0),r(ve,null)),je=a}),Za(()=>{r(ne,Ct(),!0);try{const a=Ya();a&&(r(f,a.entries.map(F),!0),r($,u(a.customTags),!0),r(K,new Set(g(a.modifiedRelations)),!0),r(ke,m(a.submissionId)??"",!0),r(ve,m(a.supersedesSubmissionId),!0));const d=localStorage.getItem(na);if(d){const h=JSON.parse(d);l(h?.email)&&r(W,h.email,!0),l(h?.github)&&r(z,h.github,!0),l(h?.note)&&r(S,h.note,!0)}}catch(a){console.warn("Failed to restore queued changes from storage",a)}finally{r(Z,!0)}e(ke)||r(ke,v(),!0)});function Ce(a){const d=a(e(K));r(K,new Set(d),!0)}function nt(a){const d=Ze(a.sourceId,a.targetId);Ce(h=>{const T=new Set(h);return T.add(d),T})}function Qe(a){Ce(d=>{if(!d.has(a))return d;const h=new Set(d);return h.delete(a),h})}Pe(()=>{const a=[],d=[],h=[],T=[],R=[];for(const O of e(f))switch(O.kind){case"language:new":a.push({queueEntryId:O.id,payload:b(O.payload)});break;case"language:edit":d.push({queueEntryId:O.id,payload:b(O.payload)});break;case"relationship":h.push({queueEntryId:O.id,payload:x(O.payload)});break;case"reference":T.push({queueEntryId:O.id,bibtex:O.payload});break;case"separator":R.push({queueEntryId:O.id,payload:E(O.payload)});break}r(I,a,!0),r(C,d,!0),r(L,h,!0),r(V,T,!0),r(we,R,!0)}),Pe(()=>{if(!e(Z)||!Lt)return;if(e(ke)||r(ke,v(),!0),e(f).length===0&&e($).length===0&&e(K).size===0){try{localStorage.removeItem(ra)}catch(h){console.warn("Failed to clear queued changes from storage",h)}r(ve,null);return}const d={entries:e(f).map(F),customTags:e($).map(ie),modifiedRelations:Array.from(e(K)),submissionId:e(ke),supersedesSubmissionId:e(ve)??null};try{localStorage.setItem(ra,JSON.stringify(d))}catch(h){console.warn("Failed to persist queued changes",h)}}),Pe(()=>{if(!e(Z)||!Lt)return;const a={email:e(W),github:e(z),note:e(S)};try{localStorage.setItem(na,JSON.stringify(a))}catch(d){console.warn("Failed to persist contributor info",d)}}),Pe(()=>{if(!e(Z)||!Lt)return;if(!e(Re)){ia(null);return}const a={entries:e(f).map(F),customTags:e($).map(ie),modifiedRelations:Array.from(e(K)),submissionId:e(ke),supersedesSubmissionId:e(ve)??null};try{const d=Wn(Ja,a);ia(d)}catch(d){console.error("Failed to build preview dataset:",d)}});function $e(a){return y({id:p(),kind:"language:new",payload:b(a)}),{success:!0}}function et(a){const d=e(C).find(h=>h.payload.name===a.name);return d?k(d.queueEntryId,"language:edit",b(a)):y({id:p(),kind:"language:edit",payload:b(a)}),{success:!0}}function Ge(a){y({id:p(),kind:"reference",payload:a})}function st(a){y({id:p(),kind:"separator",payload:E(a)})}function lt(a){r(Me,a,!0),r(se,!0)}function ye(a){if(e(Me)!==null){const d=e(we)[e(Me)];d&&k(d.queueEntryId,"separator",E(a)),r(Me,null)}}function Ae(a){r(_e,a,!0),r(Y,!0)}function Ne(a){if(e(_e)!==null){const d=e(V)[e(_e)];d&&k(d.queueEntryId,"reference",a),r(_e,null)}}function qe(a){r(Fe,a,!0),r(xe,!0)}function Se(a){if(e(Fe)!==null){const d=e(I)[e(Fe)];d&&k(d.queueEntryId,"language:new",b(a)),r(Fe,null)}return{success:!0}}function dt(a){r(Oe,a,!0),r(te,!0)}function ut(a){if(e(Oe)!==null){const d=e(C)[e(Oe)];d&&k(d.queueEntryId,"language:edit",b(a)),r(Oe,null)}return{success:!0}}function ma(a){r(Le,a,!0),r(me,!0)}function pa(a){if(e(Le)!==null){const d=e(L)[e(Le)];d&&(k(d.queueEntryId,"relationship",x(a)),nt(a)),r(Le,null)}}function xa(a){if(e(Le)!==null){pa(a);return}const d=Ze(a.sourceId,a.targetId),h=e(L).find(T=>Ze(T.payload.sourceId,T.payload.targetId)===d);h?k(h.queueEntryId,"relationship",x(a)):y({id:p(),kind:"relationship",payload:x(a)}),nt(a)}function _a(a){const d=e(I)[a];d&&qt(d.queueEntryId,d.payload.name)}function ya(a){const d=e(C)[a];d&&qt(d.queueEntryId,d.payload.name)}function ha(a){const d=e(L)[a];d&&(M(d.queueEntryId),Qe(Ze(d.payload.sourceId,d.payload.targetId)))}function qt(a,d){const h=e(L).filter(R=>R.payload.sourceId===d||R.payload.targetId===d).map(R=>R.queueEntryId),T=new Set([a,...h]);r(f,e(f).filter(R=>!T.has(R.id)),!0),Ce(R=>{if(R.size===0)return R;const O=new Set(R);for(const pe of Array.from(O))(pe.startsWith(`${d}->`)||pe.endsWith(`->${d}`))&&O.delete(pe);return O})}function wa(a){const d=e(V)[a];if(!d)return;const h=new Set(t.data.existingReferences.map(R=>R.id));for(let R=0;R<a;R++){const O=yt(e(V)[R].bibtex,h);h.add(O)}const T=yt(d.bibtex,h);r(f,e(f).map(R=>{if(R.kind==="language:new"||R.kind==="language:edit"){if(!R.payload.descriptionRefs.includes(T))return R;const O=b(R.payload);return O.descriptionRefs=O.descriptionRefs.filter(pe=>pe!==T),{...R,payload:O}}if(R.kind==="relationship"){if(!R.payload.refs.includes(T)&&!R.payload.separatingFunctions?.some(pe=>pe.refs.includes(T)))return R;const O=x(R.payload);return O.refs=O.refs.filter(pe=>pe!==T),O.separatingFunctions&&(O.separatingFunctions=O.separatingFunctions.map(pe=>({...pe,refs:pe.refs.filter(ee=>ee!==T)}))),{...R,payload:O}}if(R.kind==="separator"){if(!R.payload.refs.includes(T))return R;const O=E(R.payload);return O.refs=O.refs.filter(pe=>pe!==T),{...R,payload:O}}return R}),!0),M(d.queueEntryId),r($,e($).map(R=>({...R,refs:R.refs.filter(O=>O!==T)})),!0)}function Ea(a){const d=e(we)[a];if(!d)return;const h=d.payload.shortName;M(d.queueEntryId),r(f,e(f).map(T=>{if(T.kind!=="relationship"||!T.payload.separatingFunctionIds||!T.payload.separatingFunctionIds.includes(h))return T;const R=x(T.payload);return R.separatingFunctionIds=(R.separatingFunctionIds||[]).filter(O=>O!==h),{...T,payload:R}}),!0)}function ka(a){try{const d=a.payload;r(f,c(d),!0),r($,d.customTags.map(ie),!0),r(K,new Set(d.modifiedRelations),!0),r(W,d.contributor.email,!0),r(z,d.contributor.github,!0),r(S,d.contributor.note,!0),r(ve,d.submissionId,!0),r(ke,v(),!0),r(ne,Ct(),!0),r(De,!1),r(_e,null),r(Fe,null),r(Oe,null),r(Le,null),r(G,null),r(J,null),r(re,null),r(ce,null)}catch(d){console.error("Failed to load submission from history",d),alert("Unable to load this submission. It was saved before ordered queues were supported.")}}function Ra(a){a.preventDefault(),window.location.href="/"}var Ut=ci();sr(a=>{dr.title="Contribute - Knowledge Compilation Map"});var wt=Ke(Ut),Pt=i(wt),Bt=o(i(Pt),2),Qt=o(i(Bt),2),Et=i(Qt),kt=i(Et),Rt=o(i(kt),2),St=i(Rt),zt=o(i(St),2);Ye(zt),n(St);var Kt=o(St,2),Vt=o(i(Kt),2);Ye(Vt),n(Kt),n(Rt);var Ht=o(Rt,2),Xt=o(i(Ht),2);bt(Xt),at(2),n(Ht),n(kt);var It=o(kt,2),Gt=i(It);{var Sa=a=>{var d=Yn(),h=o(i(d),2);h.__click=[Jn,ve],n(d),_(a,d)};B(Gt,a=>{e(ve)&&a(Sa)})}var Ft=o(Gt,2);Ft.__click=[fa,De,ne];var Ia=o(i(Ft),2);n(Ft),n(It);var Wt=o(It,2);{var Fa=a=>{var d=ni(),h=i(d),T=o(i(h),2);T.__click=[fa,De,ne],n(h);var R=o(h,2);{var O=ee=>{var fe=Zn();_(ee,fe)},pe=ee=>{var fe=ri();de(fe,21,()=>e(ne),ue,(mt,We)=>{const ct=j(()=>Q(e(We))),tt=j(()=>ae(e(We).createdAt));var gt=ai(),vt=i(gt),Tt=i(vt),Dt=i(Tt),Na=i(Dt,!0);n(Dt);var At=o(Dt,2),La=i(At,!0);n(At);var Ma=o(At,2);{var Oa=it=>{var pt=$n();_(it,pt)},ja=it=>{var pt=Ve(),qa=Ke(pt);{var Ua=Nt=>{var Pa=ei();_(Nt,Pa)};B(qa,Nt=>{e(We).payload.submissionId===e(ve)&&Nt(Ua)},!0)}_(it,pt)};B(Ma,it=>{e(We).supersededBySubmissionId?it(Oa):it(ja,!1)})}n(Tt);var Ca=o(Tt,2);Ca.__click=[ti,ka,We],n(vt),n(gt),q(()=>{A(Na,e(tt)),A(La,e(ct))}),_(mt,gt)}),n(fe),_(ee,fe)};B(R,ee=>{e(ne).length===0?ee(O):ee(pe,!1)})}n(d),_(a,d)};B(Wt,a=>{e(De)&&a(Fa)})}var Jt=o(Wt,2);zn(Jt,{get languagesToAdd(){return e(le)},get languagesToEdit(){return e(Ee)},get newReferences(){return e(P)},get newSeparatingFunctions(){return e(U)},get relationships(){return e(Te)},get modifiedRelations(){return e(K)},get expandedLanguageToAddIndex(){return e(G)},get expandedLanguageToEditIndex(){return e(J)},get expandedReferenceIndex(){return e(ce)},get expandedSeparatingFunctionIndex(){return e(ge)},get expandedRelationshipIndex(){return e(re)},onToggleExpandLanguageToAdd:a=>r(G,e(G)===a?null:a,!0),onToggleExpandLanguageToEdit:a=>r(J,e(J)===a?null:a,!0),onToggleExpandReference:a=>r(ce,e(ce)===a?null:a,!0),onToggleExpandSeparatingFunction:a=>r(ge,e(ge)===a?null:a,!0),onToggleExpandRelationship:a=>r(re,e(re)===a?null:a,!0),onEditLanguageToAdd:qe,onEditLanguageToEdit:dt,onDeleteLanguageToAdd:_a,onDeleteLanguageToEdit:ya,onEditReference:Ae,onDeleteReference:wa,onEditSeparatingFunction:lt,onDeleteSeparatingFunction:Ea,onEditRelationship:ma,onDeleteRelationship:a=>ha(a)});var Yt=o(Jt,2);Vn(Yt,{onAddLanguage:()=>r(xe,!0),onEditLanguage:()=>r(he,!0),onManageRelationships:()=>r(me,!0),onAddReference:()=>r(Y,!0),onAddSeparatingFunction:()=>r(se,!0)});var Ta=o(Yt,2);{let a=j(()=>!e(Re));Xn(Ta,{get disabled(){return e(a)}})}n(Et),n(Qt),n(Bt),n(Pt),n(wt);var Zt=o(wt,2);{let a=j(()=>e(Fe)!==null?Se:$e),d=j(()=>e(Fe)!==null),h=j(()=>e(Fe)!==null?e(I)[e(Fe)]?.payload:void 0),T=j(()=>Object.values(t.data.queries).map(fe=>({code:fe.code,name:fe.label}))),R=j(()=>Object.values(t.data.transformations).map(fe=>({code:fe.code,name:fe.label}))),O=j(()=>N.map(fe=>({value:fe.code,label:fe.label,description:fe.description||""}))),pe=j(()=>[...t.data.existingTags,...e($)].map(fe=>({label:fe.label,color:fe.color||"#6366f1",description:"",refs:[]}))),ee=j(()=>_t(t.data.existingReferences,e(P)));da(Zt,{onClose:()=>{r(xe,!1),r(Fe,null)},get onAdd(){return e(a)},get isEdit(){return e(d)},get initialData(){return e(h)},get queries(){return e(T)},get transformations(){return e(R)},get polytimeOptions(){return e(O)},get existingTags(){return e(pe)},get availableRefs(){return e(ee)},get isOpen(){return e(xe)},set isOpen(fe){r(xe,fe,!0)}})}var $t=o(Zt,2);{let a=j(()=>e(Oe)!==null?ut:et),d=j(()=>e(Oe)!==null?e(C)[e(Oe)]?.payload:e(oe)?cn(t.data.languages.find(ee=>ee.name===e(oe))):void 0),h=j(()=>Object.values(t.data.queries).map(ee=>({code:ee.code,name:ee.label}))),T=j(()=>Object.values(t.data.transformations).map(ee=>({code:ee.code,name:ee.label}))),R=j(()=>N.map(ee=>({value:ee.code,label:ee.label,description:ee.description||""}))),O=j(()=>[...t.data.existingTags,...e($)].map(ee=>({label:ee.label,color:ee.color||"#6366f1",description:"",refs:[]}))),pe=j(()=>_t(t.data.existingReferences,e(P)));da($t,{onClose:()=>{r(te,!1),r(oe,""),r(Oe,null)},get onAdd(){return e(a)},isEdit:!0,get initialData(){return e(d)},get queries(){return e(h)},get transformations(){return e(T)},get polytimeOptions(){return e(R)},get existingTags(){return e(O)},get availableRefs(){return e(pe)},get isOpen(){return e(te)},set isOpen(ee){r(te,ee,!0)}})}var ea=o($t,2);{var Da=a=>{var d=ui();d.__click=[ii,he];var h=i(d);h.__click=[oi];var T=o(i(h),2),R=o(i(T),2),O=i(R);O.value=O.__value="";var pe=o(O);de(pe,17,()=>t.data.languages,ue,(We,ct)=>{var tt=si(),gt=i(tt,!0);n(tt);var vt={};q(()=>{A(gt,e(ct).name),vt!==(vt=e(ct).name)&&(tt.value=(tt.__value=e(ct).name)??"")}),_(We,tt)}),n(R);var ee=o(R,2),fe=i(ee);fe.__click=[li,oe,he];var mt=o(fe,2);mt.__click=[di,oe,he,te],n(ee),n(T),n(h),n(d),q(()=>mt.disabled=!e(oe)),ot(R,()=>e(oe),We=>r(oe,We)),_(a,d)};B(ea,a=>{e(he)&&a(Da)})}var ta=o(ea,2);{let a=j(()=>e(_e)!==null?Ne:Ge),d=j(()=>e(_e)!==null?e(V)[e(_e)]?.bibtex??"":""),h=j(()=>e(_e)!==null);qr(ta,{onClose:()=>{r(Y,!1),r(_e,null)},get onAdd(){return e(a)},get initialValue(){return e(d)},get isEditMode(){return e(h)},get isOpen(){return e(Y)},set isOpen(T){r(Y,T,!0)}})}var aa=o(ta,2);{let a=j(()=>e(Me)!==null?ye:st),d=j(()=>e(Me)!==null?e(we)[e(Me)]?.payload:void 0),h=j(()=>_t(t.data.existingReferences,e(P))),T=j(()=>e(Me)!==null);Vr(aa,{onClose:()=>{r(se,!1),r(Me,null)},get onAdd(){return e(a)},get initialValue(){return e(d)},get availableRefs(){return e(h)},get isEditMode(){return e(T)},get isOpen(){return e(se)},set isOpen(R){r(se,R,!0)}})}var Aa=o(aa,2);{let a=j(()=>e(Le)!==null?e(L)[e(Le)]?.payload:void 0),d=j(()=>un(t.data.languages,e(le),e(Ee))),h=j(()=>_t(t.data.existingReferences,e(P))),T=j(()=>gn(t.data.existingSeparatingFunctions,e(U)));sn(Aa,{onClose:()=>{r(me,!1),r(Le,null)},onSave:xa,get initialData(){return e(a)},get languages(){return e(d)},get statusOptions(){return X},get availableRefs(){return e(h)},get availableSeparatingFunctions(){return e(T)},get baselineRelations(){return H},get isOpen(){return e(me)},set isOpen(R){r(me,R,!0)}})}q(()=>Be(Ia,0,`h-3 w-3 transition-transform ${e(De)?"rotate-180":""}`)),lr("submit",Et,Ra),Ue(zt,()=>e(W),a=>r(W,a)),Ue(Vt,()=>e(z),a=>r(z,a)),Ue(Xt,()=>e(S),a=>r(S,a)),_(s,Ut),Xe()}rt(["click"]);export{_i as component,xi as universal};
