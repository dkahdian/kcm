import{d as za,a as Lt,b as Ka,r as Va,c as Ha,P as Xa,T as Ga,Q as Wa,e as ue,i as ce,M as Je,f as Ja,v as Ya,p as Za,g as Mt,h as na,C as ia,s as oa,j as sa,k as la,l as qt,m as $a}from"../chunks/CiKJp3X3.js";import"../chunks/DsnmJJEf.js";import{s as N,o as er}from"../chunks/D4xMwpl8.js";import{a$ as tr,aT as ar,u as rr,r as nr,h as ir,k as ft,be as or,ba as rt,K as He,X as T,y as Fe,a4 as Pe,z as r,v as e,Z as Ve,_ as Ke,Q as _,R as Xe,M as k,V as i,Y as n,al as at,T as o,bf as mt,O as C,aW as j,aX as sr,a0 as lr,bg as da,N as dr,bh as ur,$ as cr}from"../chunks/CuxRnwIY.js";import{p as pe,i as B}from"../chunks/CTb7Me_4.js";import{r as Ye,s as ze,b as ot,a as Be,c as gr}from"../chunks/BQmAUj6M.js";function Ue(s,t,l=t){var u=new WeakSet;tr(s,"input",async g=>{var f=g?s.defaultValue:s.value;if(f=Ot(s)?jt(f):f,l(f),ft!==null&&u.add(ft),await ar(),f!==(f=t())){var b=s.selectionStart,p=s.selectionEnd;s.value=f??"",p!==null&&(s.selectionStart=b,s.selectionEnd=Math.min(p,s.value.length))}}),(ir&&s.defaultValue!==s.value||rr(t)==null&&s.value)&&(l(Ot(s)?jt(s.value):s.value),ft!==null&&u.add(ft)),nr(()=>{var g=t();if(s===document.activeElement){var f=or??ft;if(u.has(f))return}Ot(s)&&g===jt(s.value)||s.type==="date"&&!g&&!s.value||g!==s.value&&(s.value=g??"")})}function Ot(s){var t=s.type;return t==="number"||t==="range"}function jt(s){return s===""?null:+s}const pa={},vr=za.separatingFunctions;for(const s of vr)pa[s.shortName]=s;const fr=Object.values(pa),br=()=>{const s=Lt.map(f=>f.name),t=Ka.map(f=>({id:f.id,title:f.title})),l=new Map;for(const f of Lt)if(f.tags)for(const b of f.tags)l.has(b.label)||l.set(b.label,{label:b.label,color:b.color});const u=Array.from(l.values()),g=fr.map(f=>({shortName:f.shortName,name:f.name,description:f.description}));return{existingLanguageIds:s,existingReferences:t,existingSeparatingFunctions:g,existingTags:u,languages:Lt,queries:Wa,transformations:Ga,polytimeOptions:Xa,adjacencyMatrix:Ha,relationTypes:Va}},mr=!1,yi=Object.freeze(Object.defineProperty({__proto__:null,load:br,prerender:mr},Symbol.toStringTag,{value:"Module"}));async function pr(s,t,l,u,g,f,b,p,x,S,I,c){if(!e(t).trim()||!e(l).trim()||!e(u).trim()){r(g,"Please fill out all required fields.");return}try{const m=await f.onAdd({name:e(t).trim(),fullName:e(l).trim(),description:e(u).trim(),descriptionRefs:e(b),queries:e(p),transformations:e(x),tags:e(S),existingReferences:e(I)}),y=m&&typeof m=="object"&&"success"in m?m:void 0;if(y&&!y.success){r(g,y.error??"Unable to add language. Please review your input.",!0);return}r(g,null),c(),f.onClose?.()}catch(m){r(g,m instanceof Error?m.message:"Unexpected error while adding the language.",!0)}}function ua(s,t,l){t(),l.onClose()}var xr=s=>s.stopPropagation(),_r=k('<div class="p-3 bg-red-50 border border-red-200 rounded-lg text-sm text-red-700"> </div>'),yr=(s,t,l)=>t(e(l)),hr=k('<button type="button"> </button>'),wr=k('<fieldset><legend class="block text-sm font-medium text-gray-700 mb-2">Description References</legend> <div class="flex flex-wrap gap-2"></div></fieldset>'),Er=k("<option> </option>"),kr=(s,t,l,u)=>t(e(l).code,e(u)),Rr=k('<button type="button"> </button>'),Sr=k('<div class="mt-2 flex flex-wrap gap-1"></div>'),Ir=k('<div class="p-3 bg-gray-50 rounded-lg border border-gray-200"><div class="grid grid-cols-1 md:grid-cols-2 gap-3"><div><label class="block text-xs font-medium text-gray-700 mb-1"> </label> <select class="w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-green-500"></select></div> <div><label class="block text-xs font-medium text-gray-700 mb-1">Note</label> <input type="text" placeholder="Optional note..." class="w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-green-500"/></div></div> <!></div>'),Fr=k("<option> </option>"),Tr=(s,t,l,u)=>t(e(l).code,e(u)),Dr=k('<button type="button"> </button>'),Ar=k('<div class="mt-2 flex flex-wrap gap-1"></div>'),Nr=k('<div class="p-3 bg-gray-50 rounded-lg border border-gray-200"><div class="grid grid-cols-1 md:grid-cols-2 gap-3"><div><label class="block text-xs font-medium text-gray-700 mb-1"> </label> <select class="w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-green-500"></select></div> <div><label class="block text-xs font-medium text-gray-700 mb-1">Note</label> <input type="text" placeholder="Optional note..." class="w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-green-500"/></div></div> <!></div>'),Lr=(s,t,l)=>t(e(l)),Mr=k('<button type="button"> </button>'),Or=k('<div class="space-y-4 border-t pt-6"><h3 class="text-lg font-bold text-gray-900">Tags</h3> <div class="flex flex-wrap gap-2"></div></div>'),jr=k(`<div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"><div class="bg-white rounded-xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto"><div class="bg-gradient-to-r from-green-600 to-green-700 px-6 py-4 sticky top-0 z-10"><h2 class="text-2xl font-bold text-white"> </h2> <p class="text-green-100 mt-1">Define a knowledge compilation language</p></div> <div class="p-6 space-y-6"><!> <div class="space-y-4"><h3 class="text-lg font-bold text-gray-900">Basic Information</h3> <div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div><label for="lang-name" class="block text-sm font-medium text-gray-700 mb-1">Short Name <span class="text-red-500">*</span></label> <input type="text" id="lang-name" placeholder="e.g., 'OBDD', 'd-DNNF'" class="w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"/></div> <div><label for="lang-fullname" class="block text-sm font-medium text-gray-700 mb-1">Full Name <span class="text-red-500">*</span></label> <input type="text" id="lang-fullname" placeholder="e.g., 'Ordered Binary Decision Diagrams'" class="w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"/></div></div> <div><label for="lang-description" class="block text-sm font-medium text-gray-700 mb-1">Description <span class="text-red-500">*</span></label> <textarea id="lang-description" placeholder="Brief description of this language..." rows="3" class="w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"></textarea></div> <!></div> <div class="space-y-4 border-t pt-6"><h3 class="text-lg font-bold text-gray-900">Query Support</h3> <div class="space-y-3"></div></div> <div class="space-y-4 border-t pt-6"><h3 class="text-lg font-bold text-gray-900">Transformation Support</h3> <div class="space-y-3"></div></div> <!> <div class="flex gap-3 justify-end pt-6 border-t sticky bottom-0 bg-white"><button type="button" class="px-4 py-2 border-2 border-gray-300 text-gray-700 font-medium rounded-lg hover:bg-gray-50 transition-colors">Cancel</button> <button type="button" class="px-4 py-2 bg-green-600 text-white font-medium rounded-lg hover:bg-green-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors"> </button></div></div></div></div>`);function ca(s,t){He(t,!0);let l=pe(t,"isOpen",11,!1),u=pe(t,"availableRefs",19,()=>[]),g=pe(t,"isEdit",3,!1),f=T(""),b=T(""),p=T(""),x=T(Fe([])),S=T(Fe({})),I=T(Fe({})),c=T(Fe([])),m=T(Fe([])),y=T(null);Pe(()=>{g()&&t.initialData&&(r(f,t.initialData.name,!0),r(b,t.initialData.fullName,!0),r(p,t.initialData.description,!0),r(x,[...t.initialData.descriptionRefs],!0),r(S,{...t.initialData.queries},!0),r(I,{...t.initialData.transformations},!0),r(c,[...t.initialData.tags],!0),r(m,[...t.initialData.existingReferences],!0),r(y,null))});function h(){r(f,""),r(b,""),r(p,""),r(x,[],!0),r(S,{},!0),r(I,{},!0),r(c,[],!0),r(m,[],!0),r(L,!1),r(H,!1),r(y,null)}function M(E){e(x).includes(E)?r(x,e(x).filter(v=>v!==E),!0):r(x,[...e(x),E],!0)}function te(E){e(c).some(v=>v.label===E.label)?r(c,e(c).filter(v=>v.label!==E.label),!0):r(c,[...e(c),E],!0)}function ae(E,v){if(!e(S)[E])return;const R=e(S)[E].refs;R.includes(v)?e(S)[E].refs=R.filter(U=>U!==v):e(S)[E].refs=[...R,v],r(S,{...e(S)},!0)}function Q(E,v){if(!e(I)[E])return;const R=e(I)[E].refs;R.includes(v)?e(I)[E].refs=R.filter(U=>U!==v):e(I)[E].refs=[...R,v],r(I,{...e(I)},!0)}let L=T(!1),H=T(!1);Pe(()=>{if(t.queries.length>0&&!e(L)){const E={};t.queries.forEach(v=>{if(g()&&t.initialData&&t.initialData.queries[v.code]){const R=t.initialData.queries[v.code];E[v.code]={polytime:R.polytime,note:R.note||"",refs:[...R.refs]}}else E[v.code]={polytime:"unknown",note:"",refs:[]}}),r(S,E,!0),r(L,!0)}}),Pe(()=>{if(t.transformations.length>0&&!e(H)){const E={};t.transformations.forEach(v=>{if(g()&&t.initialData){let R=t.initialData.transformations[v.code];if(!R){const U=Object.keys(t.initialData.transformations).find(O=>t.initialData.transformations[O]!==void 0&&(O===v.code||v.code==="∧C"&&O==="AND_C"||v.code==="∧BC"&&O==="AND_BC"||v.code==="∨C"&&O==="OR_C"||v.code==="∨BC"&&O==="OR_BC"||v.code==="¬C"&&O==="NOT_C"));U&&(R=t.initialData.transformations[U])}E[v.code]=R?{polytime:R.polytime,note:R.note||"",refs:[...R.refs]}:{polytime:"unknown",note:"",refs:[]}}else E[v.code]={polytime:"unknown",note:"",refs:[]}}),r(I,E,!0),r(H,!0)}});var $=Ve(),re=Ke($);{var G=E=>{var v=jr();v.__click=[ua,h,t];var R=i(v);R.__click=[xr];var U=i(R),O=i(U),W=i(O);n(O),at(2),n(U);var z=o(U,2),ne=i(z);{var oe=P=>{var q=_r(),De=i(q,!0);n(q),C(()=>N(De,e(y))),_(P,q)};B(ne,P=>{e(y)&&P(oe)})}var xe=o(ne,2),be=o(i(xe),2),ee=i(be),_e=o(i(ee),2);Ye(_e),n(ee);var ge=o(ee,2),J=o(i(ge),2);Ye(J),n(ge),n(be);var se=o(be,2),ve=o(i(se),2);mt(ve),n(se);var le=o(se,2);{var Te=P=>{var q=wr(),De=o(i(q),2);ue(De,21,u,ce,(Re,fe)=>{var ie=hr();ie.__click=[yr,M,fe];var Ae=i(ie,!0);n(ie),C(Se=>{Be(ie,1,Se),N(Ae,e(fe))},[()=>`px-3 py-1 text-sm rounded-lg border-2 transition-colors ${e(x).includes(e(fe))?"bg-green-600 text-white border-green-600":"bg-white text-gray-700 border-gray-300 hover:border-green-300"}`]),_(Re,ie)}),n(De),n(q),_(P,q)};B(le,P=>{u().length>0&&P(Te)})}n(xe);var Ee=o(xe,2),Oe=o(i(Ee),2);ue(Oe,21,()=>t.queries,ce,(P,q)=>{var De=Ve(),Re=Ke(De);{var fe=ie=>{var Ae=Ir(),Se=i(Ae),je=i(Se),Ce=i(je),nt=i(Ce,!0);n(Ce);var Qe=o(Ce,2);ue(Qe,21,()=>t.polytimeOptions,ce,(he,Ne)=>{var Le=Er(),qe=i(Le,!0);n(Le);var Ie={};C(()=>{N(qe,e(Ne).label),Ie!==(Ie=e(Ne).value)&&(Le.value=(Le.__value=e(Ne).value)??"")}),_(he,Le)}),n(Qe),n(je);var $e=o(je,2),et=i($e),Ge=o(et,2);Ye(Ge),n($e),n(Se);var st=o(Se,2);{var lt=he=>{var Ne=Sr();ue(Ne,21,u,ce,(Le,qe)=>{var Ie=Rr();Ie.__click=[kr,ae,q,qe];var dt=i(Ie,!0);n(Ie),C(ut=>{Be(Ie,1,ut),N(dt,e(qe))},[()=>`px-2 py-0.5 text-xs rounded ${e(S)[e(q).code].refs.includes(e(qe))?"bg-green-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`]),_(Le,Ie)}),n(Ne),_(he,Ne)};B(st,he=>{u().length>0&&he(lt)})}n(Ae),C(()=>{ze(Ce,"for",`query-${e(q).code??""}-polytime`),N(nt,e(q).name),ze(Qe,"id",`query-${e(q).code??""}-polytime`),ze(et,"for",`query-${e(q).code??""}-note`),ze(Ge,"id",`query-${e(q).code??""}-note`)}),ot(Qe,()=>e(S)[e(q).code].polytime,he=>e(S)[e(q).code].polytime=he),Ue(Ge,()=>e(S)[e(q).code].note,he=>e(S)[e(q).code].note=he),_(ie,Ae)};B(Re,ie=>{e(S)[e(q).code]&&ie(fe)})}_(P,De)}),n(Oe),n(Ee);var Me=o(Ee,2),K=o(i(Me),2);ue(K,21,()=>t.transformations,ce,(P,q)=>{var De=Ve(),Re=Ke(De);{var fe=ie=>{var Ae=Nr(),Se=i(Ae),je=i(Se),Ce=i(je),nt=i(Ce,!0);n(Ce);var Qe=o(Ce,2);ue(Qe,21,()=>t.polytimeOptions,ce,(he,Ne)=>{var Le=Fr(),qe=i(Le,!0);n(Le);var Ie={};C(()=>{N(qe,e(Ne).label),Ie!==(Ie=e(Ne).value)&&(Le.value=(Le.__value=e(Ne).value)??"")}),_(he,Le)}),n(Qe),n(je);var $e=o(je,2),et=i($e),Ge=o(et,2);Ye(Ge),n($e),n(Se);var st=o(Se,2);{var lt=he=>{var Ne=Ar();ue(Ne,21,u,ce,(Le,qe)=>{var Ie=Dr();Ie.__click=[Tr,Q,q,qe];var dt=i(Ie,!0);n(Ie),C(ut=>{Be(Ie,1,ut),N(dt,e(qe))},[()=>`px-2 py-0.5 text-xs rounded ${e(I)[e(q).code].refs.includes(e(qe))?"bg-green-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`]),_(Le,Ie)}),n(Ne),_(he,Ne)};B(st,he=>{u().length>0&&he(lt)})}n(Ae),C(()=>{ze(Ce,"for",`transform-${e(q).code??""}-polytime`),N(nt,e(q).name),ze(Qe,"id",`transform-${e(q).code??""}-polytime`),ze(et,"for",`transform-${e(q).code??""}-note`),ze(Ge,"id",`transform-${e(q).code??""}-note`)}),ot(Qe,()=>e(I)[e(q).code].polytime,he=>e(I)[e(q).code].polytime=he),Ue(Ge,()=>e(I)[e(q).code].note,he=>e(I)[e(q).code].note=he),_(ie,Ae)};B(Re,ie=>{e(I)[e(q).code]&&ie(fe)})}_(P,De)}),n(K),n(Me);var Y=o(Me,2);{var V=P=>{var q=Or(),De=o(i(q),2);ue(De,21,()=>t.existingTags,ce,(Re,fe)=>{var ie=Mr();ie.__click=[Lr,te,fe];var Ae=i(ie,!0);n(ie),C((Se,je)=>{Be(ie,1,Se),gr(ie,`background-color: ${e(fe).color??""}; color: white; ${je??""}`),N(Ae,e(fe).label)},[()=>`px-3 py-1 rounded-full text-sm font-medium transition-all ${e(c).some(Se=>Se.label===e(fe).label)?"ring-2 ring-offset-2":"opacity-60 hover:opacity-100"}`,()=>e(c).some(Se=>Se.label===e(fe).label)?`ring-color: ${e(fe).color};`:""]),_(Re,ie)}),n(De),n(q),_(P,q)};B(Y,P=>{t.existingTags.length>0&&P(V)})}var we=o(Y,2),Z=i(we);Z.__click=[ua,h,t];var de=o(Z,2);de.__click=[pr,f,b,p,y,t,x,S,I,c,m,h];var ke=i(de);n(de),n(we),n(z),n(R),n(v),C(P=>{N(W,`${g()?"Edit":"Add New"} Language`),de.disabled=P,N(ke,`${g()?"Update":"Add"} Language`)},[()=>!e(f).trim()||!e(b).trim()||!e(p).trim()]),Ue(_e,()=>e(f),P=>r(f,P)),Ue(J,()=>e(b),P=>r(b,P)),Ue(ve,()=>e(p),P=>r(p,P)),_(E,v)};B(re,E=>{l()&&E(G)})}_(s,$),Xe()}rt(["click"]);function Cr(s,t,l,u){e(t).trim()&&(l.onAdd(e(t).trim()),r(t,""),u(!1))}function ga(s,t,l,u){t()||r(l,""),u.onClose()}var qr=s=>s.stopPropagation(),Ur=k('<div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"><div class="bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto"><div class="bg-gradient-to-r from-purple-600 to-purple-700 px-6 py-4"><h2 class="text-2xl font-bold text-white"> </h2> <p class="text-purple-100 mt-1"> </p></div> <div class="p-6 space-y-4"><div><label for="bibtex-input" class="block text-sm font-medium text-gray-700 mb-2">BibTeX Entry <span class="text-red-500">*</span></label> <textarea id="bibtex-input" rows="8" class="w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 font-mono text-sm"></textarea> <p class="text-xs text-gray-500 mt-1">Paste a complete BibTeX entry.</p></div> <div class="flex gap-3 justify-end pt-4"><button type="button" class="px-4 py-2 border-2 border-gray-300 text-gray-700 font-medium rounded-lg hover:bg-gray-50 transition-colors">Cancel</button> <button type="button" class="px-4 py-2 bg-purple-600 text-white font-medium rounded-lg hover:bg-purple-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors"> </button></div></div></div></div>');function Pr(s,t){He(t,!0);let l=pe(t,"isOpen",15,!1),u=pe(t,"initialValue",3,""),g=pe(t,"isEditMode",3,!1),f=T(Fe(u()));Pe(()=>{l()&&u()&&r(f,u())});const b=`@article{Darwiche_2002,
  title={A Knowledge Compilation Map},
  author={Darwiche, Adnan and Marquis, Pierre},
  journal={Journal of AI Research},
  year={2002}
}`;var p=Ve(),x=Ke(p);{var S=I=>{var c=Ur();c.__click=[ga,g,f,t];var m=i(c);m.__click=[qr];var y=i(m),h=i(y),M=i(h,!0);n(h);var te=o(h,2),ae=i(te,!0);n(te),n(y);var Q=o(y,2),L=i(Q),H=o(i(L),2);mt(H),ze(H,"placeholder",b),at(2),n(L);var $=o(L,2),re=i($);re.__click=[ga,g,f,t];var G=o(re,2);G.__click=[Cr,f,t,l];var E=i(G,!0);n(G),n($),n(Q),n(m),n(c),C(v=>{N(M,g()?"Edit Reference":"Add New Reference"),N(ae,g()?"Update BibTeX citation":"Paste BibTeX citation"),G.disabled=v,N(E,g()?"Update Reference":"Add Reference")},[()=>!e(f).trim()]),Ue(H,()=>e(f),v=>r(f,v)),_(I,c)};B(x,I=>{l()&&I(S)})}_(s,p),Xe()}rt(["click"]);function Br(s,t,l,u,g,f,b,p,x){!e(t).trim()||!e(l).trim()||(u.onAdd({shortName:e(t).trim(),name:e(l).trim(),description:e(g).trim(),refs:e(f)}),b()||p(),x(!1))}function va(s,t,l,u){t()||l(),u.onClose()}var Qr=s=>s.stopPropagation(),zr=(s,t,l)=>t(e(l)),Kr=k('<button type="button"> </button>'),Vr=k('<fieldset><legend class="block text-sm font-medium text-gray-700 mb-2">References</legend> <div class="flex flex-wrap gap-2"></div></fieldset>'),Hr=k('<div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"><div class="bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto"><div class="bg-gradient-to-r from-orange-600 to-orange-700 px-6 py-4"><h2 class="text-2xl font-bold text-white"> </h2> <p class="text-orange-100 mt-1"> </p></div> <div class="p-6 space-y-4"><div><label for="sf-shortName" class="block text-sm font-medium text-gray-700 mb-2">Short Name <span class="text-red-500">*</span></label> <input id="sf-shortName" type="text" placeholder="e.g., Clique" class="w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"/> <p class="text-xs text-gray-500 mt-1">Brief label displayed on edges (e.g., "Clique", "PI")</p></div> <div><label for="sf-name" class="block text-sm font-medium text-gray-700 mb-2">Full Name <span class="text-red-500">*</span></label> <input id="sf-name" type="text" placeholder="e.g., Clique Detection Instances" class="w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"/> <p class="text-xs text-gray-500 mt-1">Full human-readable name</p></div> <div><label for="sf-description" class="block text-sm font-medium text-gray-700 mb-2">Description</label> <textarea id="sf-description" rows="3" placeholder="Describe what this function separates..." class="w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 resize-y"></textarea></div> <!> <div class="flex gap-3 justify-end pt-4"><button type="button" class="px-4 py-2 border-2 border-gray-300 text-gray-700 font-medium rounded-lg hover:bg-gray-50 transition-colors">Cancel</button> <button type="button" class="px-4 py-2 bg-orange-600 text-white font-medium rounded-lg hover:bg-orange-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors"> </button></div></div></div></div>');function Xr(s,t){He(t,!0);let l=pe(t,"isOpen",15,!1),u=pe(t,"availableRefs",19,()=>[]),g=pe(t,"isEditMode",3,!1),f=T(""),b=T(""),p=T(""),x=T(Fe([]));Pe(()=>{l()&&t.initialValue&&(r(f,t.initialValue.shortName,!0),r(b,t.initialValue.name,!0),r(p,t.initialValue.description,!0),r(x,[...t.initialValue.refs],!0))});function S(){r(f,""),r(b,""),r(p,""),r(x,[],!0)}function I(h){e(x).includes(h)?r(x,e(x).filter(M=>M!==h),!0):r(x,[...e(x),h],!0)}var c=Ve(),m=Ke(c);{var y=h=>{var M=Hr();M.__click=[va,g,S,t];var te=i(M);te.__click=[Qr];var ae=i(te),Q=i(ae),L=i(Q,!0);n(Q);var H=o(Q,2),$=i(H,!0);n(H),n(ae);var re=o(ae,2),G=i(re),E=o(i(G),2);Ye(E),at(2),n(G);var v=o(G,2),R=o(i(v),2);Ye(R),at(2),n(v);var U=o(v,2),O=o(i(U),2);mt(O),n(U);var W=o(U,2);{var z=ee=>{var _e=Vr(),ge=o(i(_e),2);ue(ge,21,u,ce,(J,se)=>{var ve=Kr();ve.__click=[zr,I,se];var le=i(ve,!0);n(ve),C(Te=>{Be(ve,1,Te),N(le,e(se))},[()=>`px-3 py-1 text-sm rounded-lg border-2 transition-colors ${e(x).includes(e(se))?"bg-orange-600 text-white border-orange-600":"bg-white text-gray-700 border-gray-300 hover:border-orange-300"}`]),_(J,ve)}),n(ge),n(_e),_(ee,_e)};B(W,ee=>{u().length>0&&ee(z)})}var ne=o(W,2),oe=i(ne);oe.__click=[va,g,S,t];var xe=o(oe,2);xe.__click=[Br,f,b,t,p,x,g,S,l];var be=i(xe,!0);n(xe),n(ne),n(re),n(te),n(M),C(ee=>{N(L,g()?"Edit Separating Function":"Add New Separating Function"),N($,g()?"Update separating function details":"Define a new separating function"),xe.disabled=ee,N(be,g()?"Update Function":"Add Function")},[()=>!e(f).trim()||!e(b).trim()]),Ue(E,()=>e(f),ee=>r(f,ee)),Ue(R,()=>e(b),ee=>r(b,ee)),Ue(O,()=>e(p),ee=>r(p,ee)),_(h,M)};B(m,h=>{l()&&h(y)})}_(s,c),Xe()}rt(["click"]);function Gr(s,t,l,u,g,f,b,p,x,S){!e(t)||!e(l)||!e(u)||e(t)===e(l)||(g.onSave({sourceId:e(t),targetId:e(l),status:e(u),description:e(f)||void 0,refs:e(b),separatingFunctionIds:e(p).length>0?e(p):void 0}),x(),S(!1))}function fa(s,t,l){t(),l.onClose()}var Wr=s=>s.stopPropagation(),Jr=k("<option> </option>"),Yr=k("<option> </option>"),Zr=k("<option> </option>"),$r=k('<p class="text-xs text-gray-500 mt-1"> </p>'),en=(s,t,l)=>t(e(l)),tn=k('<button type="button"> </button>'),an=k('<fieldset><legend class="block text-sm font-medium text-gray-700 mb-2">References</legend> <div class="flex flex-wrap gap-2"></div></fieldset>'),rn=(s,t,l)=>t(e(l).shortName),nn=k('<button type="button"> </button>'),on=k('<p class="text-xs text-gray-500 mt-2"> </p>'),sn=k('<fieldset class="border-t pt-4"><legend class="block text-sm font-medium text-gray-700 mb-2">Separating Functions (optional)</legend> <div class="flex flex-wrap gap-2"></div> <!></fieldset>'),ln=k('<div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"><div class="bg-white rounded-xl shadow-2xl max-w-3xl w-full max-h-[90vh] overflow-y-auto"><div class="bg-gradient-to-r from-blue-600 to-blue-700 px-6 py-4 sticky top-0 z-10"><h2 class="text-2xl font-bold text-white">Manage Relationship</h2> <p class="text-blue-100 mt-1">Add or update transformation relationships</p></div> <div class="p-6 space-y-4"><div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div><label for="rel-source" class="block text-sm font-medium text-gray-700 mb-1">Source Language <span class="text-red-500">*</span></label> <select id="rel-source" class="w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"><option>Select source...</option><!></select></div> <div><label for="rel-target" class="block text-sm font-medium text-gray-700 mb-1">Target Language <span class="text-red-500">*</span></label> <select id="rel-target" class="w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"><option>Select target...</option><!></select></div></div> <div><label for="rel-status" class="block text-sm font-medium text-gray-700 mb-1">Classification <span class="text-red-500">*</span></label> <select id="rel-status" class="w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"><option>Select classification...</option><!></select> <!></div> <div><label for="rel-description" class="block text-sm font-medium text-gray-700 mb-1">Description</label> <textarea id="rel-description" rows="3" class="w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-y" placeholder="Describe this transformation relationship (optional)..."></textarea></div> <!> <!> <div class="flex gap-3 justify-end pt-4 border-t"><button type="button" class="px-4 py-2 border-2 border-gray-300 text-gray-700 font-medium rounded-lg hover:bg-gray-50 transition-colors">Cancel</button> <button type="button" class="px-4 py-2 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors">Save Relationship</button></div></div></div></div>');function dn(s,t){He(t,!0);let l=pe(t,"isOpen",15,!1),u=pe(t,"availableRefs",19,()=>[]),g=pe(t,"availableSeparatingFunctions",19,()=>[]),f=pe(t,"baselineRelations",19,()=>new Map),b=T(""),p=T(""),x=T(""),S=T(""),I=T(Fe([])),c=T(Fe([]));Pe(()=>{l()&&t.initialData&&(r(b,t.initialData.sourceId,!0),r(p,t.initialData.targetId,!0),r(x,t.initialData.status,!0),r(S,t.initialData.description||"",!0),r(I,[...t.initialData.refs],!0),t.initialData.separatingFunctionIds?r(c,[...t.initialData.separatingFunctionIds],!0):t.initialData.separatingFunctions?r(c,t.initialData.separatingFunctions.map(Q=>Q.shortName),!0):r(c,[],!0))}),Pe(()=>{if(e(b)&&e(p)&&e(b)!==e(p)){const Q=`${e(b)}->${e(p)}`,L=f().get(Q);L&&(r(x,L.status,!0),r(I,[...L.refs],!0),L.separatingFunctionIds?r(c,[...L.separatingFunctionIds],!0):L.separatingFunctions?r(c,L.separatingFunctions.map(H=>H.shortName),!0):r(c,[],!0))}});function m(){r(b,""),r(p,""),r(x,""),r(S,""),r(I,[],!0),r(c,[],!0)}function y(Q){e(I).includes(Q)?r(I,e(I).filter(L=>L!==Q),!0):r(I,[...e(I),Q],!0)}function h(Q){e(c).includes(Q)?r(c,e(c).filter(L=>L!==Q),!0):r(c,[...e(c),Q],!0)}var M=Ve(),te=Ke(M);{var ae=Q=>{var L=ln();L.__click=[fa,m,t];var H=i(L);H.__click=[Wr];var $=o(i(H),2),re=i($),G=i(re),E=o(i(G),2),v=i(E);v.value=v.__value="";var R=o(v);ue(R,17,()=>t.languages,ce,(K,Y)=>{var V=Jr(),we=i(V,!0);n(V);var Z={};C(()=>{N(we,e(Y).name),Z!==(Z=e(Y).id)&&(V.value=(V.__value=e(Y).id)??"")}),_(K,V)}),n(E),n(G);var U=o(G,2),O=o(i(U),2),W=i(O);W.value=W.__value="";var z=o(W);ue(z,17,()=>t.languages,ce,(K,Y)=>{var V=Yr(),we=i(V,!0);n(V);var Z={};C(()=>{V.disabled=e(Y).id===e(b),N(we,e(Y).name),Z!==(Z=e(Y).id)&&(V.value=(V.__value=e(Y).id)??"")}),_(K,V)}),n(O),n(U),n(re);var ne=o(re,2),oe=o(i(ne),2),xe=i(oe);xe.value=xe.__value="";var be=o(xe);ue(be,17,()=>t.statusOptions,ce,(K,Y)=>{var V=Zr(),we=i(V,!0);n(V);var Z={};C(()=>{N(we,e(Y).label),Z!==(Z=e(Y).value)&&(V.value=(V.__value=e(Y).value)??"")}),_(K,V)}),n(oe);var ee=o(oe,2);{var _e=K=>{const Y=j(()=>t.statusOptions.find(de=>de.value===e(x)));var V=Ve(),we=Ke(V);{var Z=de=>{var ke=$r(),P=i(ke,!0);n(ke),C(()=>N(P,e(Y).description)),_(de,ke)};B(we,de=>{e(Y)&&de(Z)})}_(K,V)};B(ee,K=>{e(x)&&K(_e)})}n(ne);var ge=o(ne,2),J=o(i(ge),2);mt(J),n(ge);var se=o(ge,2);{var ve=K=>{var Y=an(),V=o(i(Y),2);ue(V,21,u,ce,(we,Z)=>{var de=tn();de.__click=[en,y,Z];var ke=i(de,!0);n(de),C(P=>{Be(de,1,P),N(ke,e(Z))},[()=>`px-3 py-1 text-sm rounded-lg border-2 transition-colors ${e(I).includes(e(Z))?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-300 hover:border-blue-300"}`]),_(we,de)}),n(V),n(Y),_(K,Y)};B(se,K=>{u().length>0&&K(ve)})}var le=o(se,2);{var Te=K=>{var Y=sn(),V=o(i(Y),2);ue(V,21,g,ce,(de,ke)=>{var P=nn();P.__click=[rn,h,ke];var q=i(P,!0);n(P),C(De=>{Be(P,1,De),ze(P,"title",e(ke).name),N(q,e(ke).shortName)},[()=>`px-3 py-1 text-sm rounded-lg border-2 transition-colors ${e(c).includes(e(ke).shortName)?"bg-orange-600 text-white border-orange-600":"bg-white text-gray-700 border-gray-300 hover:border-orange-300"}`]),_(de,P)}),n(V);var we=o(V,2);{var Z=de=>{var ke=on(),P=i(ke);n(ke),C(q=>N(P,`Selected: ${q??""}`),[()=>e(c).join(", ")]),_(de,ke)};B(we,de=>{e(c).length>0&&de(Z)})}n(Y),_(K,Y)};B(le,K=>{g().length>0&&K(Te)})}var Ee=o(le,2),Oe=i(Ee);Oe.__click=[fa,m,t];var Me=o(Oe,2);Me.__click=[Gr,b,p,x,t,S,I,c,m,l],n(Ee),n($),n(H),n(L),C(()=>Me.disabled=!e(b)||!e(p)||!e(x)||e(b)===e(p)),ot(E,()=>e(b),K=>r(b,K)),ot(O,()=>e(p),K=>r(p,K)),ot(oe,()=>e(x),K=>r(x,K)),Ue(J,()=>e(S),K=>r(S,K)),_(Q,L)};B(te,Q=>{l()&&Q(ae)})}_(s,M),Xe()}rt(["click"]);function un(s){const t=s.match(/author\s*=\s*[{"']([^}"']+)[}"']/i);let l="Unknown";if(t){const b=t[1].split(/\s+and\s+/i)[0].trim();if(b.includes(","))l=b.split(",")[0].trim();else{const p=b.trim().split(/\s+/);l=p[p.length-1]}l=l.replace(/[{}]/g,"").trim()}const u=s.match(/year\s*=\s*[{"']?(\d{4})[}"']?/i),g=u?u[1]:"XXXX";return{author:l,year:g}}function yt(s,t){const l=un(s);if(!l){let b="Reference_Unknown",p=1;for(;t.has(b);)b=`Reference_Unknown_${p}`,p++;return b}const u=`${l.author}_${l.year}`;if(!t.has(u))return u;const g="abcdefghijklmnopqrstuvwxyz".split("");for(const b of g){const p=`${u}_${b}`;if(!t.has(p))return p}let f=1;for(;t.has(`${u}_${f}`);)f++;return`${u}_${f}`}function bt(s){let t=2166136261;for(let u=0;u<s.length;u++)t^=s.charCodeAt(u),t=Math.imul(t,16777619);return`lang_${(t>>>0).toString(16).padStart(8,"0")}`}function Ze(s,t){return`${s}->${t}`}function cn(s){const t=new Map,{languageIds:l,matrix:u}=s;for(let g=0;g<l.length;g++)for(let f=0;f<l.length;f++){const b=u[g][f];if(b){const p=l[g],x=l[f];let S,I=[];b.separatingFunctionIds&&Array.isArray(b.separatingFunctionIds)?S=[...b.separatingFunctionIds]:b.separatingFunctions&&Array.isArray(b.separatingFunctions)&&(I=b.separatingFunctions.map(c=>({shortName:c.shortName,name:c.name,description:c.description,refs:[...c.refs]}))),t.set(Ze(p,x),{status:b.status,refs:b.refs?[...b.refs]:[],separatingFunctionIds:S,separatingFunctions:I})}}return t}function _t(s,t){const l=s.map(f=>f.id),u=new Set(l),g=t.map(f=>{const b=yt(f,u);return u.add(b),b});return[...l,...g]}function gn(s,t,l){const u=s.map(b=>({id:b.id,name:b.name})),g=t.map(b=>({id:bt(b.name),name:b.name})),f=l.map(b=>({id:bt(b.name),name:b.name}));return[...u,...g,...f]}function vn(s){return{name:s.name,fullName:s.fullName||"",description:s.description||"",descriptionRefs:s.descriptionRefs||[],queries:s.properties?.queries||{},transformations:s.properties?.transformations||{},tags:(s.tags||[]).map(t=>({...t,color:t.color||"#6366f1"})),existingReferences:s.references?.map(t=>t.id)||[]}}function fn(s,t){const l=s.map(g=>({shortName:g.shortName,name:g.name,description:g.description})),u=t.map(g=>({shortName:g.shortName,name:g.name,description:g.description}));return[...l,...u]}var bn=k('<span class="text-sm font-bold text-gray-900"> </span>'),mn=k('<span class="text-sm text-gray-600">( <!> )</span>'),pn=(s,t)=>t.onToggleExpand(t.index),xn=(s,t)=>t.onEdit(t.index),_n=(s,t)=>t.onDelete(t.index),yn=k("<div><!></div>"),hn=k('<div><div class="flex items-center justify-between"><div class="flex items-center gap-2"><span> </span> <!> <!></div> <div class="flex items-center gap-2"><button type="button"> </button> <button type="button" class="px-2 py-1 text-xs bg-blue-100 hover:bg-blue-200 text-blue-800 rounded border border-blue-300" aria-label="Edit">Edit</button> <button type="button" class="px-2 py-1 text-xs bg-red-100 hover:bg-red-200 text-red-800 rounded border border-red-300" aria-label="Delete">Delete</button></div></div> <!></div>');function ht(s,t){He(t,!0);let l=pe(t,"colorScheme",3,"purple"),u=pe(t,"isExpanded",3,!1),g=pe(t,"renderMathTitle",3,!0),f=pe(t,"renderMathSubtitle",3,!0);const p={purple:{border:"border-purple-300",bg:"bg-purple-50",text:"text-purple-800",button:"bg-purple-100 hover:bg-purple-200 text-purple-800 border-purple-300",divider:"border-purple-200"},orange:{border:"border-orange-300",bg:"bg-orange-50",text:"text-orange-800",button:"bg-orange-100 hover:bg-orange-200 text-orange-800 border-orange-300",divider:"border-orange-200"},green:{border:"border-green-300",bg:"bg-green-50",text:"text-green-800",button:"bg-green-100 hover:bg-green-200 text-green-800 border-green-300",divider:"border-green-200"},yellow:{border:"border-yellow-300",bg:"bg-yellow-50",text:"text-yellow-800",button:"bg-yellow-100 hover:bg-yellow-200 text-yellow-800 border-yellow-300",divider:"border-yellow-200"},blue:{border:"border-blue-300",bg:"bg-blue-50",text:"text-blue-800",button:"bg-blue-100 hover:bg-blue-200 text-blue-800 border-blue-300",divider:"border-blue-200"}}[l()];var x=hn(),S=i(x),I=i(S),c=i(I),m=i(c);n(c);var y=o(c,2);{var h=v=>{Je(v,{get text(){return t.title},className:"text-sm font-bold text-gray-900"})},M=v=>{var R=bn(),U=i(R,!0);n(R),C(()=>N(U,t.title)),_(v,R)};B(y,v=>{g()?v(h):v(M,!1)})}var te=o(y,2);{var ae=v=>{var R=mn(),U=o(i(R));{var O=z=>{Je(z,{get text(){return t.subtitle},className:"inline"})},W=z=>{var ne=sr();C(()=>N(ne,t.subtitle)),_(z,ne)};B(U,z=>{f()?z(O):z(W,!1)})}at(),n(R),_(v,R)};B(te,v=>{t.subtitle&&v(ae)})}n(I);var Q=o(I,2),L=i(Q);L.__click=[pn,t];var H=i(L,!0);n(L);var $=o(L,2);$.__click=[xn,t];var re=o($,2);re.__click=[_n,t],n(Q),n(S);var G=o(S,2);{var E=v=>{var R=yn(),U=i(R);{var O=W=>{var z=Ve(),ne=Ke(z);lr(ne,()=>t.children),_(W,z)};B(U,W=>{t.children&&W(O)})}n(R),C(()=>Be(R,1,`mt-4 pt-4 border-t ${p.divider??""}`)),_(v,R)};B(G,v=>{u()&&v(E)})}n(x),C(()=>{Be(x,1,`border-2 ${p.border??""} ${p.bg??""} rounded-lg p-3`),Be(c,1,`text-sm font-semibold ${p.text??""}`),N(m,`${t.type??""}:`),Be(L,1,`px-2 py-1 text-xs ${p.button??""} rounded border`),ze(L,"aria-label",u()?"Collapse":"Expand"),N(H,u()?"Collapse":"Expand")}),_(s,x),Xe()}rt(["click"]);var wn=k('<div class="text-gray-500 text-xs"> </div>'),En=k('<div class="bg-white p-2 rounded border"><div class="font-medium"> </div> <div class="text-gray-600"> </div> <!> <!></div>'),kn=k('<div><div class="font-semibold text-gray-700 mb-1"> </div> <div class="grid grid-cols-2 gap-2"></div></div>'),Rn=k('<div class="text-gray-500 text-xs"> </div>'),Sn=k('<div class="bg-white p-2 rounded border"><div class="font-medium"> </div> <div class="text-gray-600"> </div> <!> <!></div>'),In=k('<div><div class="font-semibold text-gray-700 mb-1"> </div> <div class="grid grid-cols-2 gap-2"></div></div>'),Fn=k('<div class="bg-white p-2 rounded border"><div class="font-medium"> </div> <div class="text-gray-600"> </div></div>'),Tn=k('<div><div class="font-semibold text-gray-700 mb-1"> </div> <div class="space-y-2"></div></div>'),Dn=k('<div class="space-y-3 text-xs"><div><div class="font-semibold text-gray-700 mb-1">Full Name:</div> <!></div> <div><div class="font-semibold text-gray-700 mb-1">Description:</div> <!></div> <!> <!> <!></div>');function ba(s,t){He(t,!0);let l=pe(t,"isExpanded",3,!1),u=pe(t,"isEdit",3,!1);const g=u()?"yellow":"green";{const f=p=>{var x=Dn(),S=i(x),I=o(i(S),2);Je(I,{get text(){return t.language.fullName},className:"text-gray-900 block"}),n(S);var c=o(S,2),m=o(i(c),2);Je(m,{get text(){return t.language.description},className:"text-gray-900 block"}),n(c);var y=o(c,2);{var h=L=>{var H=kn(),$=i(H),re=i($);n($);var G=o($,2);ue(G,21,()=>Object.entries(t.language.queries),ce,(E,v)=>{var R=j(()=>da(e(v),2));let U=()=>e(R)[0],O=()=>e(R)[1];var W=En(),z=i(W),ne=i(z,!0);n(z);var oe=o(z,2),xe=i(oe,!0);n(oe);var be=o(oe,2);{var ee=J=>{Je(J,{get text(){return O().note},className:"text-gray-500 italic text-xs block"})};B(be,J=>{O().note&&J(ee)})}var _e=o(be,2);{var ge=J=>{var se=wn(),ve=i(se);n(se),C(le=>N(ve,`Refs: [${le??""}]`),[()=>O().refs.join(", ")]),_(J,se)};B(_e,J=>{O().refs.length>0&&J(ge)})}n(W),C(()=>{N(ne,U()),N(xe,O().polytime)}),_(E,W)}),n(G),n(H),C(E=>N(re,`Query Support (${E??""}):`),[()=>Object.keys(t.language.queries).length]),_(L,H)};B(y,L=>{t.language.queries&&Object.keys(t.language.queries).length>0&&L(h)})}var M=o(y,2);{var te=L=>{var H=In(),$=i(H),re=i($);n($);var G=o($,2);ue(G,21,()=>Object.entries(t.language.transformations),ce,(E,v)=>{var R=j(()=>da(e(v),2));let U=()=>e(R)[0],O=()=>e(R)[1];var W=Sn(),z=i(W),ne=i(z,!0);n(z);var oe=o(z,2),xe=i(oe,!0);n(oe);var be=o(oe,2);{var ee=J=>{Je(J,{get text(){return O().note},className:"text-gray-500 italic text-xs block"})};B(be,J=>{O().note&&J(ee)})}var _e=o(be,2);{var ge=J=>{var se=Rn(),ve=i(se);n(se),C(le=>N(ve,`Refs: [${le??""}]`),[()=>O().refs.join(", ")]),_(J,se)};B(_e,J=>{O().refs.length>0&&J(ge)})}n(W),C(()=>{N(ne,U()),N(xe,O().polytime)}),_(E,W)}),n(G),n(H),C(E=>N(re,`Transformation Support (${E??""}):`),[()=>Object.keys(t.language.transformations).length]),_(L,H)};B(M,L=>{t.language.transformations&&Object.keys(t.language.transformations).length>0&&L(te)})}var ae=o(M,2);{var Q=L=>{var H=Tn(),$=i(H),re=i($);n($);var G=o($,2);ue(G,21,()=>t.language.tags,ce,(E,v)=>{var R=Fn(),U=i(R),O=i(U,!0);n(U);var W=o(U,2),z=i(W,!0);n(W),n(R),C(()=>{N(O,e(v).label),N(z,e(v).description||"No description")}),_(E,R)}),n(G),n(H),C(()=>N(re,`Tags (${t.language.tags.length??""}):`)),_(L,H)};B(ae,L=>{t.language.tags.length>0&&L(Q)})}n(x),_(p,x)};let b=j(()=>u()?"Edit Language":"New Language");ht(s,{get type(){return e(b)},get title(){return t.language.name},get subtitle(){return t.language.description},get colorScheme(){return g},get index(){return t.index},get isExpanded(){return l()},get onToggleExpand(){return t.onToggleExpand},get onEdit(){return t.onEdit},get onDelete(){return t.onDelete},children:f,$$slots:{default:!0}})}Xe()}var An=k('<pre class="text-xs bg-white p-2 rounded border border-purple-200 overflow-x-auto"> </pre>');function Nn(s,t){let l=pe(t,"isExpanded",3,!1);ht(s,{type:"Reference",get title(){return`new-${t.index??""}`},renderMathTitle:!1,renderMathSubtitle:!1,colorScheme:"purple",get index(){return t.index},get isExpanded(){return l()},get onToggleExpand(){return t.onToggleExpand},get onEdit(){return t.onEdit},get onDelete(){return t.onDelete},children:g=>{var f=An(),b=i(f,!0);n(f),C(()=>N(b,t.reference)),_(g,f)},$$slots:{default:!0}})}var Ln=k('<div><span class="text-xs font-semibold text-gray-700">Description:</span> <!></div>'),Mn=k('<div><span class="text-xs font-semibold text-gray-700">References:</span> <span class="text-xs text-gray-600 ml-2"> </span></div>'),On=k('<div class="space-y-2"><div><span class="text-xs font-semibold text-gray-700">Short Name:</span> <!></div> <div><span class="text-xs font-semibold text-gray-700">Full Name:</span> <!></div> <!> <!></div>');function jn(s,t){He(t,!0),ht(s,{type:"SF",get title(){return t.separatingFunction.shortName},get subtitle(){return t.separatingFunction.name},colorScheme:"orange",get index(){return t.index},get isExpanded(){return t.isExpanded},get onToggleExpand(){return t.onToggleExpand},get onEdit(){return t.onEdit},get onDelete(){return t.onDelete},children:u=>{var g=On(),f=i(g),b=o(i(f),2);Je(b,{get text(){return t.separatingFunction.shortName},className:"text-xs text-gray-900 ml-2 inline"}),n(f);var p=o(f,2),x=o(i(p),2);Je(x,{get text(){return t.separatingFunction.name},className:"text-xs text-gray-900 ml-2 inline"}),n(p);var S=o(p,2);{var I=y=>{var h=Ln(),M=o(i(h),2);Je(M,{get text(){return t.separatingFunction.description},className:"text-xs text-gray-700 mt-1 block"}),n(h),_(y,h)};B(S,y=>{t.separatingFunction.description&&y(I)})}var c=o(S,2);{var m=y=>{var h=Mn(),M=o(i(h),2),te=i(M,!0);n(M),n(h),C(ae=>N(te,ae),[()=>t.separatingFunction.refs.join(", ")]),_(y,h)};B(c,y=>{t.separatingFunction.refs&&t.separatingFunction.refs.length>0&&y(m)})}n(g),_(u,g)},$$slots:{default:!0}}),Xe()}var Cn=k('<div class="text-gray-500 text-xs mt-1"> </div>'),qn=k('<div class="bg-white p-2 rounded border"><div class="font-medium"> </div> <div class="text-gray-600 text-xs"> </div> <div class="text-gray-500 italic text-xs"> </div> <!></div>'),Un=k('<div><div class="font-semibold text-gray-700 mb-1"> </div> <div class="space-y-2"></div></div>'),Pn=k('<div><div class="font-semibold text-gray-700 mb-1">References:</div> <div class="text-gray-600"> </div></div>'),Bn=k('<div class="space-y-3 text-xs"><div><div class="font-semibold text-gray-700 mb-1">Transformation Status:</div> <div class="bg-white p-2 rounded border"><span class="font-mono text-gray-900"> </span></div></div> <!> <!></div>');function Qn(s,t){He(t,!0);let l=pe(t,"isExpanded",3,!1),u=pe(t,"isModified",3,!1);const g=new Map(t.languages.map(m=>[m.id,m.name])),f=Ze(t.relationship.sourceId,t.relationship.targetId),b=g.get(t.relationship.sourceId)??t.relationship.sourceId,p=g.get(t.relationship.targetId)??t.relationship.targetId,x=`${b} → ${p}`;var S=Ve(),I=Ke(S);{var c=m=>{ht(m,{type:"Relationship",get title(){return x},get subtitle(){return t.relationship.status},colorScheme:"blue",get index(){return t.index},get isExpanded(){return l()},get onToggleExpand(){return t.onToggleExpand},onEdit:()=>t.onEdit(t.index),onDelete:()=>t.onDelete(t.index,f),children:h=>{var M=Bn(),te=i(M),ae=o(i(te),2),Q=i(ae),L=i(Q,!0);n(Q),n(ae),n(te);var H=o(te,2);{var $=E=>{var v=Un(),R=i(v),U=i(R);n(R);var O=o(R,2);ue(O,21,()=>t.relationship.separatingFunctions,ce,(W,z)=>{var ne=qn(),oe=i(ne),xe=i(oe,!0);n(oe);var be=o(oe,2),ee=i(be);n(be);var _e=o(be,2),ge=i(_e,!0);n(_e);var J=o(_e,2);{var se=ve=>{var le=Cn(),Te=i(le);n(le),C(Ee=>N(Te,`Refs: [${Ee??""}]`),[()=>e(z).refs.join(", ")]),_(ve,le)};B(J,ve=>{e(z).refs&&e(z).refs.length>0&&ve(se)})}n(ne),C(()=>{N(xe,e(z).name),N(ee,`Short: ${e(z).shortName??""}`),N(ge,e(z).description)}),_(W,ne)}),n(O),n(v),C(()=>N(U,`Separating Functions (${t.relationship.separatingFunctions.length??""}):`)),_(E,v)};B(H,E=>{t.relationship.separatingFunctions&&t.relationship.separatingFunctions.length>0&&E($)})}var re=o(H,2);{var G=E=>{var v=Pn(),R=o(i(v),2),U=i(R,!0);n(R),n(v),C(O=>N(U,O),[()=>t.relationship.refs.join(", ")]),_(E,v)};B(re,E=>{t.relationship.refs&&t.relationship.refs.length>0&&E(G)})}n(M),C(()=>N(L,t.relationship.status)),_(h,M)},$$slots:{default:!0}})};B(I,m=>{u()&&m(c)})}_(s,S),Xe()}var zn=k('<div class="text-center py-8 text-gray-500 italic">No changes queued yet. Use the buttons below to add items.</div>'),Kn=k(`<div class="space-y-3"><h2 class="text-lg font-bold text-gray-900">Queued Changes</h2> <p class="text-sm text-gray-600">Items you've added will appear here.</p> <div class="space-y-2"><!> <!> <!> <!> <!> <!></div></div>`);function Vn(s,t){He(t,!0);const l=j(()=>t.languagesToAdd.length>0||t.languagesToEdit.length>0||t.newReferences.length>0||t.newSeparatingFunctions.length>0||t.relationships.filter(m=>t.modifiedRelations.has(Ze(m.sourceId,m.targetId))).length>0);var u=Kn(),g=o(i(u),4),f=i(g);ue(f,17,()=>t.newReferences,ce,(m,y,h)=>{{let M=j(()=>t.expandedReferenceIndex===h);Nn(m,{get reference(){return e(y)},index:h,get isExpanded(){return e(M)},get onToggleExpand(){return t.onToggleExpandReference},get onEdit(){return t.onEditReference},get onDelete(){return t.onDeleteReference}})}});var b=o(f,2);ue(b,17,()=>t.newSeparatingFunctions,ce,(m,y,h)=>{{let M=j(()=>t.expandedSeparatingFunctionIndex===h);jn(m,{get separatingFunction(){return e(y)},index:h,get isExpanded(){return e(M)},get onToggleExpand(){return t.onToggleExpandSeparatingFunction},get onEdit(){return t.onEditSeparatingFunction},get onDelete(){return t.onDeleteSeparatingFunction}})}});var p=o(b,2);ue(p,17,()=>t.languagesToAdd,ce,(m,y,h)=>{{let M=j(()=>t.expandedLanguageToAddIndex===h);ba(m,{get language(){return e(y)},index:h,get isExpanded(){return e(M)},isEdit:!1,get onToggleExpand(){return t.onToggleExpandLanguageToAdd},get onEdit(){return t.onEditLanguageToAdd},get onDelete(){return t.onDeleteLanguageToAdd}})}});var x=o(p,2);ue(x,17,()=>t.languagesToEdit,ce,(m,y,h)=>{{let M=j(()=>t.expandedLanguageToEditIndex===h);ba(m,{get language(){return e(y)},index:h,get isExpanded(){return e(M)},isEdit:!0,get onToggleExpand(){return t.onToggleExpandLanguageToEdit},get onEdit(){return t.onEditLanguageToEdit},get onDelete(){return t.onDeleteLanguageToEdit}})}});var S=o(x,2);ue(S,17,()=>t.relationships,ce,(m,y,h)=>{const M=j(()=>t.modifiedRelations.has(Ze(e(y).sourceId,e(y).targetId)));{let te=j(()=>t.expandedRelationshipIndex===h);Qn(m,{get languages(){return t.languages},get relationship(){return e(y)},index:h,get isModified(){return e(M)},get isExpanded(){return e(te)},get onToggleExpand(){return t.onToggleExpandRelationship},get onEdit(){return t.onEditRelationship},get onDelete(){return t.onDeleteRelationship}})}});var I=o(S,2);{var c=m=>{var y=zn();_(m,y)};B(I,m=>{e(l)||m(c)})}n(g),n(u),_(s,u),Xe()}var Hn=k('<div class="grid grid-cols-2 md:grid-cols-5 gap-3"><button type="button" class="px-3 py-3 bg-green-600 hover:bg-green-700 text-white font-medium rounded-lg transition-colors">New Language</button> <button type="button" class="px-3 py-3 bg-yellow-600 hover:bg-yellow-700 text-white font-medium rounded-lg transition-colors">Edit Language</button> <button type="button" class="px-3 py-3 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors">Relationship</button> <button type="button" class="px-3 py-3 bg-purple-600 hover:bg-purple-700 text-white font-medium rounded-lg transition-colors">Reference</button> <button type="button" class="px-3 py-3 bg-orange-600 hover:bg-orange-700 text-white font-medium rounded-lg transition-colors">Separator</button></div>');function Xn(s,t){var l=Hn(),u=i(l);u.__click=function(...x){t.onAddLanguage?.apply(this,x)};var g=o(u,2);g.__click=function(...x){t.onEditLanguage?.apply(this,x)};var f=o(g,2);f.__click=function(...x){t.onManageRelationships?.apply(this,x)};var b=o(f,2);b.__click=function(...x){t.onAddReference?.apply(this,x)};var p=o(b,2);p.__click=function(...x){t.onAddSeparatingFunction?.apply(this,x)},n(l),_(s,l)}rt(["click"]);var Gn=k('<div class="pt-6"><button type="submit" class="group relative w-full px-8 py-4 bg-gradient-to-r from-indigo-600 to-purple-700 text-white font-bold text-lg rounded-xl hover:from-indigo-700 hover:to-purple-800 disabled:from-gray-400 disabled:to-gray-500 disabled:cursor-not-allowed transition-all duration-300 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 active:translate-y-0"><span class="flex items-center justify-center"><svg class="w-5 h-5 mr-2 transition-transform group-hover:scale-110" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path></svg> Preview Changes</span></button> <p class="text-center text-sm text-gray-500 mt-4">Preview your changes on the graph before submitting</p></div>');function Wn(s,t){let l=pe(t,"disabled",3,!1);var u=Gn(),g=i(u);at(2),n(u),C(()=>g.disabled=l()),_(s,u)}function Jn(s){const t=s.match(/@\w+\{([^,\s]+)/);return t?t[1]:null}function Ct(s,t){const l=[];for(const u of s.descriptionRefs){const g=t.get(u);g&&l.push(g)}return{id:bt(s.name),name:s.name,fullName:s.fullName,description:s.description,descriptionRefs:[...s.descriptionRefs],properties:{queries:s.queries,transformations:s.transformations},tags:s.tags,references:l}}function Yn(s,t){const l=Ja(s),u=c=>{const{adjacencyMatrix:m}=l;if(c in m.indexByLanguage)return;const y=m.languageIds.length;m.languageIds.push(c),m.indexByLanguage[c]=y;for(const h of m.matrix)h.push(null);m.matrix.push(new Array(y+1).fill(null))},g=new Map;if(l.references)for(const c of l.references)g.set(c.id,c);const f=new Set(g.keys()),b=new Map;if(l.separatingFunctions)for(const c of l.separatingFunctions)b.set(c.shortName,c);const p=new Set(t.modifiedRelations??[]),x=c=>{const m={shortName:c.shortName,name:c.name,description:c.description,refs:[...c.refs]};b.set(m.shortName,m),l.separatingFunctions=[...l.separatingFunctions??[],m]},S=c=>{u(c.sourceId),u(c.targetId);const m=l.adjacencyMatrix.indexByLanguage[c.sourceId],y=l.adjacencyMatrix.indexByLanguage[c.targetId];if(m===void 0||y===void 0)return;const h=`${c.sourceId}->${c.targetId}`;if(p.size>0&&!p.has(h)&&l.adjacencyMatrix.matrix[m]?.[y])return;const M=[];if(c.separatingFunctionIds&&c.separatingFunctionIds.length>0)for(const ae of c.separatingFunctionIds){const Q=b.get(ae);Q&&M.push({shortName:Q.shortName,name:Q.name,description:Q.description,refs:[...Q.refs]})}else if(c.separatingFunctions)for(const ae of c.separatingFunctions)M.push({shortName:ae.shortName,name:ae.name,description:ae.description,refs:[...ae.refs]});const te={status:c.status,description:c.description,refs:[...c.refs],separatingFunctions:M};l.adjacencyMatrix.matrix[m][y]=te};for(const c of t.entries)switch(c.kind){case"reference":{const m=c.payload,y=yt(m,f);f.add(y);const h=Jn(m),M={id:y,title:h||y,href:"",bibtex:m};g.set(y,M),l.references=[...l.references??[],M];break}case"separator":{x(c.payload);break}case"language:new":{const m=Ct(c.payload,g);l.languages.push(m),u(m.id);break}case"language:edit":{const m=bt(c.payload.name),y=l.languages.findIndex(h=>h.id===m);if(y===-1){const h=Ct(c.payload,g);l.languages.push(h),u(h.id)}else l.languages[y]=Ct(c.payload,g);break}case"relationship":{S(c.payload);break}}const I=Ya(l);if(!I.ok){const c=I.errors?.join("; ")??"unknown structural error";throw new Error(`Contribution queue produced an invalid dataset: ${c}`)}return Za(l)}function ma(s,t,l){const u=!e(t);r(t,u),u&&r(l,qt(),!0)}function Zn(s,t){r(t,null)}var $n=k('<div class="mr-auto mb-3 flex items-center gap-3 rounded-lg border border-amber-300 bg-amber-50 px-4 py-2 text-sm text-amber-800 shadow-sm"><span class="font-medium">Editing prior submission</span> <button type="button" class="rounded-md border border-amber-400 px-2 py-1 text-xs font-semibold text-amber-700 transition-colors hover:bg-amber-100">Stop</button></div>'),ei=k('<p class="text-sm text-gray-500">No saved submissions yet. Submit once to keep a snapshot.</p>'),ti=k('<div class="text-xs font-medium text-amber-600">Superseded</div>'),ai=k('<div class="text-xs font-medium text-emerald-600">Currently editing clone</div>'),ri=(s,t,l)=>t(e(l)),ni=k('<li class="rounded-md border border-gray-200 bg-white px-3 py-2 shadow-sm"><div class="flex items-start justify-between gap-3"><div class="space-y-1"><div class="text-sm font-medium text-gray-800"> </div> <div class="text-xs text-gray-600"> </div> <!></div> <button type="button" class="rounded-md border border-blue-500 px-3 py-1 text-xs font-semibold text-blue-600 transition-colors hover:bg-blue-50">Load</button></div></li>'),ii=k('<ul class="space-y-3 max-h-64 overflow-y-auto pr-1"></ul>'),oi=k('<div class="mb-6 rounded-lg border border-gray-200 bg-gradient-to-br from-gray-50 to-white p-4 shadow-sm"><div class="mb-3 flex items-center justify-between"><h3 class="text-sm font-semibold text-gray-800">Previous submissions</h3> <button type="button" class="rounded-md px-2 py-1 text-xs font-medium text-gray-500 hover:bg-gray-200/70 hover:text-gray-700">Close</button></div> <!></div>'),si=(s,t)=>r(t,!1),li=s=>s.stopPropagation(),di=k("<option> </option>"),ui=(s,t,l)=>{r(t,""),r(l,!1)},ci=(s,t,l,u)=>{e(t)&&(r(l,!1),r(u,!0))},gi=k('<div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"><div class="bg-white rounded-xl shadow-2xl max-w-md w-full"><div class="bg-gradient-to-r from-yellow-600 to-yellow-700 px-6 py-4"><h2 class="text-2xl font-bold text-white">Select Language to Edit</h2> <p class="text-yellow-100 mt-1">Choose an existing language</p></div> <div class="p-6"><label for="language-selector" class="block text-sm font-medium text-gray-700 mb-2">Language <span class="text-red-500">*</span></label> <select id="language-selector" class="w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-yellow-500"><option>Choose a language...</option><!></select> <div class="flex gap-3 justify-end pt-4 mt-4 border-t"><button type="button" class="px-4 py-2 border-2 border-gray-300 text-gray-700 font-medium rounded-lg hover:bg-gray-50 transition-colors">Cancel</button> <button type="button" class="px-4 py-2 bg-yellow-600 text-white font-medium rounded-lg hover:bg-yellow-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors">Edit</button></div></div></div></div>'),vi=k('<div class="min-h-screen bg-gradient-to-br from-blue-50 via-white to-emerald-50 py-12 px-4 sm:px-6 lg:px-8"><div class="max-w-4xl mx-auto"><div class="text-center mb-12"><h1 class="text-5xl font-extrabold text-gray-900 mb-4 tracking-tight">Contribute to the KC Map</h1> <p class="text-xl text-gray-600 max-w-2xl mx-auto leading-relaxed">Help improve the Knowledge Compilation Map by adding new languages or updating existing ones.</p> <p class="mt-4"><a href="https://github.com/dkahdian/kcm" target="_blank" rel="noopener noreferrer" class="inline-flex items-center gap-2 text-blue-600 hover:text-blue-800 font-medium"><svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"></path></svg> View on GitHub</a></p></div> <div class="bg-white rounded-2xl shadow-2xl overflow-hidden border border-gray-100"><div class="bg-gradient-to-r from-blue-600 to-blue-700 px-8 py-6"><h2 class="text-2xl font-bold text-white">Submission Form</h2> <p class="text-blue-100 mt-1">Fill out the details below to contribute</p></div> <div class="p-8 sm:p-10"><form class="space-y-8"><div class="bg-gradient-to-r from-blue-50 to-indigo-50 p-6 rounded-xl border border-blue-200"><h2 class="text-lg font-bold text-gray-900 mb-4">Contributor Information</h2> <div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div><label for="contributor-email" class="block text-sm font-medium text-gray-700 mb-1">Email Address <span class="text-red-500">*</span></label> <input type="email" id="contributor-email" required class="w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="your.email@example.com"/></div> <div><label for="contributor-github" class="block text-sm font-medium text-gray-700 mb-1">GitHub Username (optional)</label> <input type="text" id="contributor-github" class="w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="@username"/></div></div> <div class="mt-4"><label for="contributor-note" class="block text-sm font-medium text-gray-700 mb-1">Note (optional)</label> <textarea id="contributor-note" rows="3" class="w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-y" placeholder="Add any clarifications or additional context for your contribution..."></textarea> <p class="mt-1 text-xs text-gray-500">This note will be included in the pull request description.</p></div></div> <div class="flex justify-end"><!> <button type="button" class="mb-3 inline-flex items-center gap-2 rounded-full border border-gray-300 px-3 py-1 text-sm font-medium text-gray-700 shadow-sm transition-colors hover:border-blue-400 hover:text-blue-600"><span aria-hidden="true">🗂️</span> Submission history <svg viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M2 4l4 4 4-4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg></button></div> <!> <!>  <!> <!></form></div></div></div></div> <!> <!> <!> <!> <!> <!>',1);function hi(s,t){He(t,!0);const l=a=>typeof a=="string",u=a=>Array.isArray(a)?a.filter(l):[],g=()=>typeof crypto<"u"&&typeof crypto.randomUUID=="function"?crypto.randomUUID():la(),f=a=>typeof a=="string"&&a.trim().length>0?a:null;function b(a){if(!Array.isArray(a))return[];const d=[];for(const w of a){if(!w||typeof w!="object")continue;const F=w;l(F.label)&&d.push({label:F.label,color:l(F.color)?F.color:"#6366f1",description:l(F.description)?F.description:void 0,refs:u(F.refs)})}return d}const p=a=>({...a,descriptionRefs:[...a.descriptionRefs],queries:Object.fromEntries(Object.entries(a.queries).map(([d,w])=>[d,{...w,refs:[...w.refs]}])),transformations:Object.fromEntries(Object.entries(a.transformations).map(([d,w])=>[d,{...w,refs:[...w.refs]}])),tags:a.tags.map(d=>({...d,refs:[...d.refs]})),existingReferences:[...a.existingReferences]}),x=a=>({...a,description:a.description,refs:[...a.refs],separatingFunctionIds:a.separatingFunctionIds?[...a.separatingFunctionIds]:void 0,separatingFunctions:a.separatingFunctions?a.separatingFunctions.map(d=>({...d,refs:[...d.refs]})):void 0}),S=a=>({shortName:a.shortName,name:a.name,description:a.description,refs:[...a.refs]}),I=a=>{switch(a.kind){case"language:new":case"language:edit":return{...a,payload:p(a.payload)};case"relationship":return{...a,payload:x(a.payload)};case"separator":return{...a,payload:S(a.payload)};case"reference":default:return{...a,payload:a.payload}}};function c(a){if(!Array.isArray(a.queueEntries)||a.queueEntries.length===0)throw new Error("Submission history entry is missing queueEntries.");return a.queueEntries.map(I)}const m=()=>typeof crypto<"u"&&typeof crypto.randomUUID=="function"?crypto.randomUUID():la();function y(a){r(v,[...e(v),a],!0)}function h(a,d,w){r(v,e(v).map(F=>F.id===a&&F.kind===d?{...F,payload:w}:F),!0)}function M(a){r(v,e(v).filter(d=>d.id!==a),!0)}const te=a=>({...a,refs:[...a.refs]}),ae=a=>{try{return new Intl.DateTimeFormat(void 0,{dateStyle:"medium",timeStyle:"short"}).format(new Date(a))}catch{return a}},Q=a=>{const d=[];return a.summary.languagesToAdd&&d.push(`${a.summary.languagesToAdd} new ${a.summary.languagesToAdd===1?"language":"languages"}`),a.summary.languagesToEdit&&d.push(`${a.summary.languagesToEdit} edit${a.summary.languagesToEdit===1?"":"s"}`),a.summary.relationships&&d.push(`${a.summary.relationships} relation${a.summary.relationships===1?"":"s"}`),a.summary.newReferences&&d.push(`${a.summary.newReferences} reference${a.summary.newReferences===1?"":"s"}`),d.length>0?d.join(" · "):"No changes"},L=Object.values(t.data.polytimeOptions),H=t.data.relationTypes.map(a=>({value:a.id,label:a.name,description:a.description??""})),$=cn(t.data.adjacencyMatrix);let re=T(""),G=T(""),E=T(""),v=T(Fe([])),R=T(Fe([])),U=T(Fe([])),O=T(Fe([])),W=T(null),z=T(null),ne=T(null),oe=T(null),xe=T(null),be=T(!1),ee=T(!1),_e=T(!1),ge=T(""),J=T(!1),se=T(!1),ve=T(!1),le=T(null),Te=T(null),Ee=T(null),Oe=T(null),Me=T(null),K=T(Fe(new Set)),Y=T(!1),V=T(Fe([])),we=T(Fe([])),Z=T(Fe([]));const de=j(()=>e(R).map(a=>a.payload)),ke=j(()=>e(U).map(a=>a.payload)),P=j(()=>e(V).map(a=>a.bibtex)),q=j(()=>e(we).map(a=>a.payload)),De=j(()=>e(O).map(a=>a.payload));let Re=T(""),fe=T(null),ie=T(Fe([])),Ae=T(!1);const Se=j(()=>e(v).length>0||e(Z).length>0||e(K).size>0);let je=!1;Pe(()=>{const a=e(Se);a&&!je&&!e(Re)&&r(Re,g(),!0),!a&&je&&(r(Re,g(),!0),r(fe,null)),je=a}),er(()=>{r(ie,qt(),!0);try{const a=$a();a&&(r(v,a.entries.map(I),!0),r(Z,b(a.customTags),!0),r(K,new Set(u(a.modifiedRelations)),!0),r(Re,f(a.submissionId)??"",!0),r(fe,f(a.supersedesSubmissionId),!0));const d=localStorage.getItem(ia);if(d){const w=JSON.parse(d);l(w?.email)&&r(re,w.email,!0),l(w?.github)&&r(G,w.github,!0),l(w?.note)&&r(E,w.note,!0)}}catch(a){console.warn("Failed to restore queued changes from storage",a)}finally{r(Y,!0)}e(Re)||r(Re,g(),!0)});function Ce(a){const d=a(e(K));r(K,new Set(d),!0)}function nt(a){const d=Ze(a.sourceId,a.targetId);Ce(w=>{const F=new Set(w);return F.add(d),F})}function Qe(a){Ce(d=>{if(!d.has(a))return d;const w=new Set(d);return w.delete(a),w})}Pe(()=>{const a=[],d=[],w=[],F=[],A=[];for(const D of e(v))switch(D.kind){case"language:new":a.push({queueEntryId:D.id,payload:p(D.payload)});break;case"language:edit":d.push({queueEntryId:D.id,payload:p(D.payload)});break;case"relationship":w.push({queueEntryId:D.id,payload:x(D.payload)});break;case"reference":F.push({queueEntryId:D.id,bibtex:D.payload});break;case"separator":A.push({queueEntryId:D.id,payload:S(D.payload)});break}r(R,a,!0),r(U,d,!0),r(O,w,!0),r(V,F,!0),r(we,A,!0)}),Pe(()=>{if(!e(Y)||!Mt)return;if(e(Re)||r(Re,g(),!0),e(v).length===0&&e(Z).length===0&&e(K).size===0){try{localStorage.removeItem(na)}catch(w){console.warn("Failed to clear queued changes from storage",w)}r(fe,null);return}const d={entries:e(v).map(I),customTags:e(Z).map(te),modifiedRelations:Array.from(e(K)),submissionId:e(Re),supersedesSubmissionId:e(fe)??null};try{localStorage.setItem(na,JSON.stringify(d))}catch(w){console.warn("Failed to persist queued changes",w)}}),Pe(()=>{if(!e(Y)||!Mt)return;const a={email:e(re),github:e(G),note:e(E)};try{localStorage.setItem(ia,JSON.stringify(a))}catch(d){console.warn("Failed to persist contributor info",d)}}),Pe(()=>{if(!e(Y)||!Mt)return;if(!e(Se)){oa(null);return}const a={entries:e(v).map(I),customTags:e(Z).map(te),modifiedRelations:Array.from(e(K)),submissionId:e(Re),supersedesSubmissionId:e(fe)??null};try{const d=Yn(sa,a);oa(d)}catch(d){console.error("Failed to build preview dataset:",d)}});function $e(a){return y({id:m(),kind:"language:new",payload:p(a)}),{success:!0}}function et(a){const d=e(U).find(w=>w.payload.name===a.name);return d?h(d.queueEntryId,"language:edit",p(a)):y({id:m(),kind:"language:edit",payload:p(a)}),{success:!0}}function Ge(a){y({id:m(),kind:"reference",payload:a})}function st(a){y({id:m(),kind:"separator",payload:S(a)})}function lt(a){r(Te,a,!0),r(se,!0)}function he(a){if(e(Te)!==null){const d=e(we)[e(Te)];d&&h(d.queueEntryId,"separator",S(a)),r(Te,null)}}function Ne(a){r(le,a,!0),r(J,!0)}function Le(a){if(e(le)!==null){const d=e(V)[e(le)];d&&h(d.queueEntryId,"reference",a),r(le,null)}}function qe(a){r(Ee,a,!0),r(be,!0)}function Ie(a){if(e(Ee)!==null){const d=e(R)[e(Ee)];d&&h(d.queueEntryId,"language:new",p(a)),r(Ee,null)}return{success:!0}}function dt(a){r(Oe,a,!0),r(ee,!0)}function ut(a){if(e(Oe)!==null){const d=e(U)[e(Oe)];d&&h(d.queueEntryId,"language:edit",p(a)),r(Oe,null)}return{success:!0}}function xa(a){r(Me,a,!0),r(ve,!0)}function _a(a){if(e(Me)!==null){const d=e(O)[e(Me)];d&&(h(d.queueEntryId,"relationship",x(a)),nt(a)),r(Me,null)}}function ya(a){if(e(Me)!==null){_a(a);return}const d=Ze(a.sourceId,a.targetId),w=e(O).find(F=>Ze(F.payload.sourceId,F.payload.targetId)===d);w?h(w.queueEntryId,"relationship",x(a)):y({id:m(),kind:"relationship",payload:x(a)}),nt(a)}function ha(a){const d=e(R)[a];d&&Ut(d.queueEntryId,d.payload.name)}function wa(a){const d=e(U)[a];d&&Ut(d.queueEntryId,d.payload.name)}function Ea(a){const d=e(O)[a];d&&(M(d.queueEntryId),Qe(Ze(d.payload.sourceId,d.payload.targetId)))}function Ut(a,d){const w=bt(d),F=e(O).filter(D=>D.payload.sourceId===w||D.payload.targetId===w).map(D=>D.queueEntryId),A=new Set([a,...F]);r(v,e(v).filter(D=>!A.has(D.id)),!0),Ce(D=>{if(D.size===0)return D;const ye=new Set(D);for(const X of Array.from(ye))(X.startsWith(`${d}->`)||X.endsWith(`->${d}`))&&ye.delete(X);return ye})}function ka(a){const d=e(V)[a];if(!d)return;const w=new Set(t.data.existingReferences.map(A=>A.id));for(let A=0;A<a;A++){const D=yt(e(V)[A].bibtex,w);w.add(D)}const F=yt(d.bibtex,w);r(v,e(v).map(A=>{if(A.kind==="language:new"||A.kind==="language:edit"){if(!A.payload.descriptionRefs.includes(F))return A;const D=p(A.payload);return D.descriptionRefs=D.descriptionRefs.filter(ye=>ye!==F),{...A,payload:D}}if(A.kind==="relationship"){if(!A.payload.refs.includes(F)&&!A.payload.separatingFunctions?.some(ye=>ye.refs.includes(F)))return A;const D=x(A.payload);return D.refs=D.refs.filter(ye=>ye!==F),D.separatingFunctions&&(D.separatingFunctions=D.separatingFunctions.map(ye=>({...ye,refs:ye.refs.filter(X=>X!==F)}))),{...A,payload:D}}if(A.kind==="separator"){if(!A.payload.refs.includes(F))return A;const D=S(A.payload);return D.refs=D.refs.filter(ye=>ye!==F),{...A,payload:D}}return A}),!0),M(d.queueEntryId),r(Z,e(Z).map(A=>({...A,refs:A.refs.filter(D=>D!==F)})),!0)}function Ra(a){const d=e(we)[a];if(!d)return;const w=d.payload.shortName;M(d.queueEntryId),r(v,e(v).map(F=>{if(F.kind!=="relationship"||!F.payload.separatingFunctionIds||!F.payload.separatingFunctionIds.includes(w))return F;const A=x(F.payload);return A.separatingFunctionIds=(A.separatingFunctionIds||[]).filter(D=>D!==w),{...F,payload:A}}),!0)}function Sa(a){try{const d=a.payload;r(v,c(d),!0),r(Z,d.customTags.map(te),!0),r(K,new Set(d.modifiedRelations),!0),r(re,d.contributor.email,!0),r(G,d.contributor.github,!0),r(E,d.contributor.note,!0),r(fe,d.submissionId,!0),r(Re,g(),!0),r(ie,qt(),!0),r(Ae,!1),r(le,null),r(Ee,null),r(Oe,null),r(Me,null),r(W,null),r(z,null),r(ne,null),r(oe,null)}catch(d){console.error("Failed to load submission from history",d),alert("Unable to load this submission. It was saved before ordered queues were supported.")}}function Ia(a){a.preventDefault(),window.location.href="/"}var Pt=vi();dr(a=>{cr.title="Contribute - Knowledge Compilation Map"});var wt=Ke(Pt),Bt=i(wt),Qt=o(i(Bt),2),zt=o(i(Qt),2),Et=i(zt),kt=i(Et),Rt=o(i(kt),2),St=i(Rt),Kt=o(i(St),2);Ye(Kt),n(St);var Vt=o(St,2),Ht=o(i(Vt),2);Ye(Ht),n(Vt),n(Rt);var Xt=o(Rt,2),Gt=o(i(Xt),2);mt(Gt),at(2),n(Xt),n(kt);var It=o(kt,2),Wt=i(It);{var Fa=a=>{var d=$n(),w=o(i(d),2);w.__click=[Zn,fe],n(d),_(a,d)};B(Wt,a=>{e(fe)&&a(Fa)})}var Ft=o(Wt,2);Ft.__click=[ma,Ae,ie];var Ta=o(i(Ft),2);n(Ft),n(It);var Jt=o(It,2);{var Da=a=>{var d=oi(),w=i(d),F=o(i(w),2);F.__click=[ma,Ae,ie],n(w);var A=o(w,2);{var D=X=>{var me=ei();_(X,me)},ye=X=>{var me=ii();ue(me,21,()=>e(ie),ce,(pt,We)=>{const ct=j(()=>Q(e(We))),tt=j(()=>ae(e(We).createdAt));var gt=ni(),vt=i(gt),Tt=i(vt),Dt=i(Tt),Ma=i(Dt,!0);n(Dt);var At=o(Dt,2),Oa=i(At,!0);n(At);var ja=o(At,2);{var Ca=it=>{var xt=ti();_(it,xt)},qa=it=>{var xt=Ve(),Pa=Ke(xt);{var Ba=Nt=>{var Qa=ai();_(Nt,Qa)};B(Pa,Nt=>{e(We).payload.submissionId===e(fe)&&Nt(Ba)},!0)}_(it,xt)};B(ja,it=>{e(We).supersededBySubmissionId?it(Ca):it(qa,!1)})}n(Tt);var Ua=o(Tt,2);Ua.__click=[ri,Sa,We],n(vt),n(gt),C(()=>{N(Ma,e(tt)),N(Oa,e(ct))}),_(pt,gt)}),n(me),_(X,me)};B(A,X=>{e(ie).length===0?X(D):X(ye,!1)})}n(d),_(a,d)};B(Jt,a=>{e(Ae)&&a(Da)})}var Yt=o(Jt,2);Vn(Yt,{get languages(){return sa.languages},get languagesToAdd(){return e(de)},get languagesToEdit(){return e(ke)},get newReferences(){return e(P)},get newSeparatingFunctions(){return e(q)},get relationships(){return e(De)},get modifiedRelations(){return e(K)},get expandedLanguageToAddIndex(){return e(W)},get expandedLanguageToEditIndex(){return e(z)},get expandedReferenceIndex(){return e(oe)},get expandedSeparatingFunctionIndex(){return e(xe)},get expandedRelationshipIndex(){return e(ne)},onToggleExpandLanguageToAdd:a=>r(W,e(W)===a?null:a,!0),onToggleExpandLanguageToEdit:a=>r(z,e(z)===a?null:a,!0),onToggleExpandReference:a=>r(oe,e(oe)===a?null:a,!0),onToggleExpandSeparatingFunction:a=>r(xe,e(xe)===a?null:a,!0),onToggleExpandRelationship:a=>r(ne,e(ne)===a?null:a,!0),onEditLanguageToAdd:qe,onEditLanguageToEdit:dt,onDeleteLanguageToAdd:ha,onDeleteLanguageToEdit:wa,onEditReference:Ne,onDeleteReference:ka,onEditSeparatingFunction:lt,onDeleteSeparatingFunction:Ra,onEditRelationship:xa,onDeleteRelationship:a=>Ea(a)});var Zt=o(Yt,2);Xn(Zt,{onAddLanguage:()=>r(be,!0),onEditLanguage:()=>r(_e,!0),onManageRelationships:()=>r(ve,!0),onAddReference:()=>r(J,!0),onAddSeparatingFunction:()=>r(se,!0)});var Aa=o(Zt,2);{let a=j(()=>!e(Se));Wn(Aa,{get disabled(){return e(a)}})}n(Et),n(zt),n(Qt),n(Bt),n(wt);var $t=o(wt,2);{let a=j(()=>e(Ee)!==null?Ie:$e),d=j(()=>e(Ee)!==null),w=j(()=>e(Ee)!==null?e(R)[e(Ee)]?.payload:void 0),F=j(()=>Object.values(t.data.queries).map(me=>({code:me.code,name:me.label}))),A=j(()=>Object.values(t.data.transformations).map(me=>({code:me.code,name:me.label}))),D=j(()=>L.map(me=>({value:me.code,label:me.label,description:me.description||""}))),ye=j(()=>[...t.data.existingTags,...e(Z)].map(me=>({label:me.label,color:me.color||"#6366f1",description:"",refs:[]}))),X=j(()=>_t(t.data.existingReferences,e(P)));ca($t,{onClose:()=>{r(be,!1),r(Ee,null)},get onAdd(){return e(a)},get isEdit(){return e(d)},get initialData(){return e(w)},get queries(){return e(F)},get transformations(){return e(A)},get polytimeOptions(){return e(D)},get existingTags(){return e(ye)},get availableRefs(){return e(X)},get isOpen(){return e(be)},set isOpen(me){r(be,me,!0)}})}var ea=o($t,2);{let a=j(()=>e(Oe)!==null?ut:et),d=j(()=>e(Oe)!==null?e(U)[e(Oe)]?.payload:e(ge)?vn(t.data.languages.find(X=>X.name===e(ge))):void 0),w=j(()=>Object.values(t.data.queries).map(X=>({code:X.code,name:X.label}))),F=j(()=>Object.values(t.data.transformations).map(X=>({code:X.code,name:X.label}))),A=j(()=>L.map(X=>({value:X.code,label:X.label,description:X.description||""}))),D=j(()=>[...t.data.existingTags,...e(Z)].map(X=>({label:X.label,color:X.color||"#6366f1",description:"",refs:[]}))),ye=j(()=>_t(t.data.existingReferences,e(P)));ca(ea,{onClose:()=>{r(ee,!1),r(ge,""),r(Oe,null)},get onAdd(){return e(a)},isEdit:!0,get initialData(){return e(d)},get queries(){return e(w)},get transformations(){return e(F)},get polytimeOptions(){return e(A)},get existingTags(){return e(D)},get availableRefs(){return e(ye)},get isOpen(){return e(ee)},set isOpen(X){r(ee,X,!0)}})}var ta=o(ea,2);{var Na=a=>{var d=gi();d.__click=[si,_e];var w=i(d);w.__click=[li];var F=o(i(w),2),A=o(i(F),2),D=i(A);D.value=D.__value="";var ye=o(D);ue(ye,17,()=>t.data.languages,ce,(We,ct)=>{var tt=di(),gt=i(tt,!0);n(tt);var vt={};C(()=>{N(gt,e(ct).name),vt!==(vt=e(ct).name)&&(tt.value=(tt.__value=e(ct).name)??"")}),_(We,tt)}),n(A);var X=o(A,2),me=i(X);me.__click=[ui,ge,_e];var pt=o(me,2);pt.__click=[ci,ge,_e,ee],n(X),n(F),n(w),n(d),C(()=>pt.disabled=!e(ge)),ot(A,()=>e(ge),We=>r(ge,We)),_(a,d)};B(ta,a=>{e(_e)&&a(Na)})}var aa=o(ta,2);{let a=j(()=>e(le)!==null?Le:Ge),d=j(()=>e(le)!==null?e(V)[e(le)]?.bibtex??"":""),w=j(()=>e(le)!==null);Pr(aa,{onClose:()=>{r(J,!1),r(le,null)},get onAdd(){return e(a)},get initialValue(){return e(d)},get isEditMode(){return e(w)},get isOpen(){return e(J)},set isOpen(F){r(J,F,!0)}})}var ra=o(aa,2);{let a=j(()=>e(Te)!==null?he:st),d=j(()=>e(Te)!==null?e(we)[e(Te)]?.payload:void 0),w=j(()=>_t(t.data.existingReferences,e(P))),F=j(()=>e(Te)!==null);Xr(ra,{onClose:()=>{r(se,!1),r(Te,null)},get onAdd(){return e(a)},get initialValue(){return e(d)},get availableRefs(){return e(w)},get isEditMode(){return e(F)},get isOpen(){return e(se)},set isOpen(A){r(se,A,!0)}})}var La=o(ra,2);{let a=j(()=>e(Me)!==null?e(O)[e(Me)]?.payload:void 0),d=j(()=>gn(t.data.languages,e(de),e(ke))),w=j(()=>_t(t.data.existingReferences,e(P))),F=j(()=>fn(t.data.existingSeparatingFunctions,e(q)));dn(La,{onClose:()=>{r(ve,!1),r(Me,null)},onSave:ya,get initialData(){return e(a)},get languages(){return e(d)},get statusOptions(){return H},get availableRefs(){return e(w)},get availableSeparatingFunctions(){return e(F)},get baselineRelations(){return $},get isOpen(){return e(ve)},set isOpen(A){r(ve,A,!0)}})}C(()=>Be(Ta,0,`h-3 w-3 transition-transform ${e(Ae)?"rotate-180":""}`)),ur("submit",Et,Ia),Ue(Kt,()=>e(re),a=>r(re,a)),Ue(Ht,()=>e(G),a=>r(G,a)),Ue(Gt,()=>e(E),a=>r(E,a)),_(s,Pt),Xe()}rt(["click"]);export{hi as component,yi as universal};
